2020-11-09 16:25:48.076037 (MainThread): Running with dbt=0.18.0-rc1
2020-11-09 16:25:48.084307 (MainThread): Profile not loaded due to error: Runtime Error
  Could not find profile named 'jaffle_shop'
2020-11-09 16:25:48.084408 (MainThread): No profile "jaffle_shop" found, continuing with no target
2020-11-09 16:25:48.163393 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2020-11-09 16:25:48.164288 (MainThread): Tracking: do not track
2020-11-09 16:25:48.178278 (MainThread): Warning: No packages were found in packages.yml
2020-11-09 16:25:48.179042 (MainThread): Flushing usage events
2020-11-09 16:27:28.377013 (MainThread): Running with dbt=0.18.1
2020-11-09 16:27:28.380131 (MainThread): Profile not loaded due to error: Runtime Error
  Could not find profile named 'jaffle_shop'
2020-11-09 16:27:28.380166 (MainThread): No profile "jaffle_shop" found, continuing with no target
2020-11-09 16:27:28.413669 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2020-11-09 16:27:28.414561 (MainThread): Tracking: do not track
2020-11-09 16:27:28.424168 (MainThread): Warning: No packages were found in packages.yml
2020-11-09 16:27:28.424540 (MainThread): Flushing usage events
2020-11-09 16:28:18.052273 (MainThread): Running with dbt=0.18.1
2020-11-09 16:28:18.129813 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-09 16:28:18.130476 (MainThread): Tracking: tracking
2020-11-09 16:28:18.140613 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1d9760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1eccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1fa4c0>]}
2020-11-09 16:28:18.162539 (MainThread): Partial parsing not enabled
2020-11-09 16:28:18.163547 (MainThread): Parsing macros/catalog.sql
2020-11-09 16:28:18.167929 (MainThread): Parsing macros/relations.sql
2020-11-09 16:28:18.169606 (MainThread): Parsing macros/adapters.sql
2020-11-09 16:28:18.193265 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-11-09 16:28:18.197043 (MainThread): Parsing macros/core.sql
2020-11-09 16:28:18.202018 (MainThread): Parsing macros/materializations/helpers.sql
2020-11-09 16:28:18.214037 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-11-09 16:28:18.216482 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-11-09 16:28:18.239022 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-11-09 16:28:18.273339 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-11-09 16:28:18.300672 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-11-09 16:28:18.303011 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-11-09 16:28:18.310591 (MainThread): Parsing macros/materializations/common/merge.sql
2020-11-09 16:28:18.326567 (MainThread): Parsing macros/materializations/table/table.sql
2020-11-09 16:28:18.334307 (MainThread): Parsing macros/materializations/view/view.sql
2020-11-09 16:28:18.341386 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-11-09 16:28:18.346960 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-11-09 16:28:18.348114 (MainThread): Parsing macros/etc/query.sql
2020-11-09 16:28:18.349344 (MainThread): Parsing macros/etc/is_incremental.sql
2020-11-09 16:28:18.351086 (MainThread): Parsing macros/etc/datetime.sql
2020-11-09 16:28:18.360476 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-11-09 16:28:18.362601 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-11-09 16:28:18.364401 (MainThread): Parsing macros/adapters/common.sql
2020-11-09 16:28:18.422969 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-11-09 16:28:18.425521 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-11-09 16:28:18.428806 (MainThread): Parsing macros/schema_tests/unique.sql
2020-11-09 16:28:18.430803 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-11-09 16:28:18.439544 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2020-11-09 16:28:18.439722 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '264267a6-e110-4b73-aa2f-9eb89339538b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a24de50>]}
2020-11-09 16:28:18.440225 (MainThread): Partial parsing not enabled
2020-11-09 16:28:18.478138 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 16:28:18.495915 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 16:28:18.509356 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:28:18.522113 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 16:28:18.531665 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 16:28:18.540182 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2020-11-09 16:28:18.549497 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 16:28:18.557408 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 16:28:19.072069 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 3 seed files, 0 sources
2020-11-09 16:28:19.074217 (MainThread): 
2020-11-09 16:28:19.074617 (MainThread): Acquiring new postgres connection "master".
2020-11-09 16:28:19.084495 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dbttest1".
2020-11-09 16:28:19.094778 (ThreadPoolExecutor-0_0): Using postgres connection "list_dbttest1".
2020-11-09 16:28:19.095021 (ThreadPoolExecutor-0_0): On list_dbttest1: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1"} */

    select distinct nspname from pg_namespace
  
2020-11-09 16:28:19.095154 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-09 16:28:19.114361 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.02 seconds
2020-11-09 16:28:19.116673 (ThreadPoolExecutor-0_0): On list_dbttest1: Close
2020-11-09 16:28:19.154257 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dbttest1_public".
2020-11-09 16:28:19.159890 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2020-11-09 16:28:19.160005 (ThreadPoolExecutor-1_0): On list_dbttest1_public: BEGIN
2020-11-09 16:28:19.160082 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2020-11-09 16:28:19.170007 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2020-11-09 16:28:19.170156 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2020-11-09 16:28:19.170236 (ThreadPoolExecutor-1_0): On list_dbttest1_public: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1_public"} */
select
      'dbttest1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbttest1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-11-09 16:28:19.185164 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.01 seconds
2020-11-09 16:28:19.185475 (ThreadPoolExecutor-1_0): On list_dbttest1_public: ROLLBACK
2020-11-09 16:28:19.186815 (ThreadPoolExecutor-1_0): On list_dbttest1_public: Close
2020-11-09 16:28:19.227812 (MainThread): Using postgres connection "master".
2020-11-09 16:28:19.227941 (MainThread): On master: BEGIN
2020-11-09 16:28:19.228023 (MainThread): Opening a new connection, currently in state init
2020-11-09 16:28:19.235405 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-11-09 16:28:19.235629 (MainThread): Using postgres connection "master".
2020-11-09 16:28:19.235728 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-11-09 16:28:19.245694 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2020-11-09 16:28:19.245993 (MainThread): On master: ROLLBACK
2020-11-09 16:28:19.247143 (MainThread): Using postgres connection "master".
2020-11-09 16:28:19.247250 (MainThread): On master: BEGIN
2020-11-09 16:28:19.249186 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-11-09 16:28:19.249323 (MainThread): On master: COMMIT
2020-11-09 16:28:19.249411 (MainThread): Using postgres connection "master".
2020-11-09 16:28:19.249548 (MainThread): On master: COMMIT
2020-11-09 16:28:19.250529 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-11-09 16:28:19.250652 (MainThread): On master: Close
2020-11-09 16:28:19.251025 (MainThread): 11:28:19 | Concurrency: 1 threads (target='dev')
2020-11-09 16:28:19.251220 (MainThread): 11:28:19 | 
2020-11-09 16:28:19.254582 (Thread-1): Began running node model.jaffle_shop.stg_orders
2020-11-09 16:28:19.255635 (Thread-1): 11:28:19 | 1 of 8 START view model public.stg_orders............................ [RUN]
2020-11-09 16:28:19.255905 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:28:19.256014 (Thread-1): Compiling model.jaffle_shop.stg_orders
2020-11-09 16:28:19.276344 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2020-11-09 16:28:19.276987 (Thread-1): finished collecting timing info
2020-11-09 16:28:19.311360 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:28:19.311503 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbttest1"."public"."stg_orders__dbt_tmp" cascade
2020-11-09 16:28:19.311627 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 16:28:19.324224 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-11-09 16:28:19.327041 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:28:19.327177 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbttest1"."public"."stg_orders__dbt_backup" cascade
2020-11-09 16:28:19.328429 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-11-09 16:28:19.335066 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2020-11-09 16:28:19.336023 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:28:19.336140 (Thread-1): On model.jaffle_shop.stg_orders: BEGIN
2020-11-09 16:28:19.339124 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 16:28:19.339281 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:28:19.339481 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "dbttest1"."public"."stg_orders__dbt_tmp" as (
    with source as (
    select * from "dbttest1"."public"."raw_orders"

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from renamed
  );

2020-11-09 16:28:19.342773 (Thread-1): Postgres error: relation "public.raw_orders" does not exist
LINE 5:     select * from "dbttest1"."public"."raw_orders"
                          ^

2020-11-09 16:28:19.342967 (Thread-1): On model.jaffle_shop.stg_orders: ROLLBACK
2020-11-09 16:28:19.344347 (Thread-1): finished collecting timing info
2020-11-09 16:28:19.344747 (Thread-1): On model.jaffle_shop.stg_orders: Close
2020-11-09 16:28:19.345182 (Thread-1): Database Error in model stg_orders (models/staging/stg_orders.sql)
  relation "public.raw_orders" does not exist
  LINE 5:     select * from "dbttest1"."public"."raw_orders"
                            ^
  compiled SQL at target/run/jaffle_shop/models/staging/stg_orders.sql
Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "public.raw_orders" does not exist
LINE 5:     select * from "dbttest1"."public"."raw_orders"
                          ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/Users/naveen/.pyenv/versions/3.8.2/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 57, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model stg_orders (models/staging/stg_orders.sql)
  relation "public.raw_orders" does not exist
  LINE 5:     select * from "dbttest1"."public"."raw_orders"
                            ^
  compiled SQL at target/run/jaffle_shop/models/staging/stg_orders.sql
2020-11-09 16:28:19.349834 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '264267a6-e110-4b73-aa2f-9eb89339538b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4ef970>]}
2020-11-09 16:28:19.350969 (Thread-1): 11:28:19 | 1 of 8 ERROR creating view model public.stg_orders................... [ERROR in 0.09s]
2020-11-09 16:28:19.351104 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2020-11-09 16:28:19.351224 (Thread-1): Began running node model.jaffle_shop.stg_payments
2020-11-09 16:28:19.352445 (Thread-1): 11:28:19 | 2 of 8 START view model public.stg_payments.......................... [RUN]
2020-11-09 16:28:19.352788 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 16:28:19.352904 (Thread-1): Compiling model.jaffle_shop.stg_payments
2020-11-09 16:28:19.361241 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2020-11-09 16:28:19.361669 (Thread-1): finished collecting timing info
2020-11-09 16:28:19.369845 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 16:28:19.369986 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbttest1"."public"."stg_payments__dbt_tmp" cascade
2020-11-09 16:28:19.370070 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 16:28:19.381462 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-11-09 16:28:19.384555 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 16:28:19.384692 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbttest1"."public"."stg_payments__dbt_backup" cascade
2020-11-09 16:28:19.386101 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-11-09 16:28:19.387256 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2020-11-09 16:28:19.387727 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 16:28:19.387825 (Thread-1): On model.jaffle_shop.stg_payments: BEGIN
2020-11-09 16:28:19.389316 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 16:28:19.389489 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 16:28:19.389578 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "dbttest1"."public"."stg_payments__dbt_tmp" as (
    with source as (
    select * from "dbttest1"."public"."raw_payments"

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        --`amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed
  );

2020-11-09 16:28:19.392638 (Thread-1): Postgres error: relation "public.raw_payments" does not exist
LINE 5:     select * from "dbttest1"."public"."raw_payments"
                          ^

2020-11-09 16:28:19.392781 (Thread-1): On model.jaffle_shop.stg_payments: ROLLBACK
2020-11-09 16:28:19.394006 (Thread-1): finished collecting timing info
2020-11-09 16:28:19.394287 (Thread-1): On model.jaffle_shop.stg_payments: Close
2020-11-09 16:28:19.394630 (Thread-1): Database Error in model stg_payments (models/staging/stg_payments.sql)
  relation "public.raw_payments" does not exist
  LINE 5:     select * from "dbttest1"."public"."raw_payments"
                            ^
  compiled SQL at target/run/jaffle_shop/models/staging/stg_payments.sql
Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "public.raw_payments" does not exist
LINE 5:     select * from "dbttest1"."public"."raw_payments"
                          ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/Users/naveen/.pyenv/versions/3.8.2/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 57, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model stg_payments (models/staging/stg_payments.sql)
  relation "public.raw_payments" does not exist
  LINE 5:     select * from "dbttest1"."public"."raw_payments"
                            ^
  compiled SQL at target/run/jaffle_shop/models/staging/stg_payments.sql
2020-11-09 16:28:19.395205 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '264267a6-e110-4b73-aa2f-9eb89339538b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3103d0>]}
2020-11-09 16:28:19.396235 (Thread-1): 11:28:19 | 2 of 8 ERROR creating view model public.stg_payments................. [ERROR in 0.04s]
2020-11-09 16:28:19.396426 (Thread-1): Finished running node model.jaffle_shop.stg_payments
2020-11-09 16:28:19.396584 (Thread-1): Began running node model.jaffle_shop.stg_customers
2020-11-09 16:28:19.397969 (Thread-1): 11:28:19 | 3 of 8 START view model public.stg_customers......................... [RUN]
2020-11-09 16:28:19.398633 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 16:28:19.398833 (Thread-1): Compiling model.jaffle_shop.stg_customers
2020-11-09 16:28:19.406733 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2020-11-09 16:28:19.407121 (Thread-1): finished collecting timing info
2020-11-09 16:28:19.413261 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 16:28:19.413384 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbttest1"."public"."stg_customers__dbt_tmp" cascade
2020-11-09 16:28:19.413465 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 16:28:19.421926 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-11-09 16:28:19.424234 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 16:28:19.424349 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbttest1"."public"."stg_customers__dbt_backup" cascade
2020-11-09 16:28:19.425561 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-11-09 16:28:19.426693 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2020-11-09 16:28:19.427086 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 16:28:19.427170 (Thread-1): On model.jaffle_shop.stg_customers: BEGIN
2020-11-09 16:28:19.429176 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 16:28:19.429440 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 16:28:19.429589 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "dbttest1"."public"."stg_customers__dbt_tmp" as (
    with source as (
    select * from "dbttest1"."public"."raw_customers"

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name,
        email

    from source

)

select * from renamed
  );

2020-11-09 16:28:19.431128 (Thread-1): Postgres error: relation "public.raw_customers" does not exist
LINE 5:     select * from "dbttest1"."public"."raw_customers"
                          ^

2020-11-09 16:28:19.431295 (Thread-1): On model.jaffle_shop.stg_customers: ROLLBACK
2020-11-09 16:28:19.437886 (Thread-1): finished collecting timing info
2020-11-09 16:28:19.438388 (Thread-1): On model.jaffle_shop.stg_customers: Close
2020-11-09 16:28:19.438721 (Thread-1): Database Error in model stg_customers (models/staging/stg_customers.sql)
  relation "public.raw_customers" does not exist
  LINE 5:     select * from "dbttest1"."public"."raw_customers"
                            ^
  compiled SQL at target/run/jaffle_shop/models/staging/stg_customers.sql
Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "public.raw_customers" does not exist
LINE 5:     select * from "dbttest1"."public"."raw_customers"
                          ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/Users/naveen/.pyenv/versions/3.8.2/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 57, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model stg_customers (models/staging/stg_customers.sql)
  relation "public.raw_customers" does not exist
  LINE 5:     select * from "dbttest1"."public"."raw_customers"
                            ^
  compiled SQL at target/run/jaffle_shop/models/staging/stg_customers.sql
2020-11-09 16:28:19.439334 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '264267a6-e110-4b73-aa2f-9eb89339538b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a556b80>]}
2020-11-09 16:28:19.440365 (Thread-1): 11:28:19 | 3 of 8 ERROR creating view model public.stg_customers................ [ERROR in 0.04s]
2020-11-09 16:28:19.440517 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2020-11-09 16:28:19.440687 (Thread-1): Began running node model.jaffle_shop.customer_orders
2020-11-09 16:28:19.441077 (Thread-1): 11:28:19 | 4 of 8 SKIP relation public.customer_orders.......................... [SKIP]
2020-11-09 16:28:19.441312 (Thread-1): Finished running node model.jaffle_shop.customer_orders
2020-11-09 16:28:19.441509 (Thread-1): Began running node model.jaffle_shop.customer_payments
2020-11-09 16:28:19.441729 (Thread-1): 11:28:19 | 5 of 8 SKIP relation public.customer_payments........................ [SKIP]
2020-11-09 16:28:19.441863 (Thread-1): Finished running node model.jaffle_shop.customer_payments
2020-11-09 16:28:19.442033 (Thread-1): Began running node model.jaffle_shop.order_payments
2020-11-09 16:28:19.442388 (Thread-1): 11:28:19 | 6 of 8 SKIP relation public.order_payments........................... [SKIP]
2020-11-09 16:28:19.442545 (Thread-1): Finished running node model.jaffle_shop.order_payments
2020-11-09 16:28:19.442664 (Thread-1): Began running node model.jaffle_shop.dim_customers
2020-11-09 16:28:19.442930 (Thread-1): 11:28:19 | 7 of 8 SKIP relation public.dim_customers............................ [SKIP]
2020-11-09 16:28:19.443202 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2020-11-09 16:28:19.443617 (Thread-1): Began running node model.jaffle_shop.fct_orders
2020-11-09 16:28:19.443755 (Thread-1): 11:28:19 | 8 of 8 SKIP relation public.fct_orders............................... [SKIP]
2020-11-09 16:28:19.443888 (Thread-1): Finished running node model.jaffle_shop.fct_orders
2020-11-09 16:28:19.444831 (MainThread): Acquiring new postgres connection "master".
2020-11-09 16:28:19.444974 (MainThread): Using postgres connection "master".
2020-11-09 16:28:19.445050 (MainThread): On master: BEGIN
2020-11-09 16:28:19.445121 (MainThread): Opening a new connection, currently in state closed
2020-11-09 16:28:19.454046 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-11-09 16:28:19.454212 (MainThread): On master: COMMIT
2020-11-09 16:28:19.454307 (MainThread): Using postgres connection "master".
2020-11-09 16:28:19.454382 (MainThread): On master: COMMIT
2020-11-09 16:28:19.455357 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-11-09 16:28:19.455516 (MainThread): On master: Close
2020-11-09 16:28:19.456087 (MainThread): 11:28:19 | 
2020-11-09 16:28:19.456245 (MainThread): 11:28:19 | Finished running 3 view models, 5 table models in 0.38s.
2020-11-09 16:28:19.456413 (MainThread): Connection 'master' was properly closed.
2020-11-09 16:28:19.456549 (MainThread): Connection 'model.jaffle_shop.stg_customers' was properly closed.
2020-11-09 16:28:19.478606 (MainThread): 
2020-11-09 16:28:19.478896 (MainThread): Completed with 3 errors and 0 warnings:
2020-11-09 16:28:19.479031 (MainThread): 
2020-11-09 16:28:19.479175 (MainThread): Database Error in model stg_orders (models/staging/stg_orders.sql)
2020-11-09 16:28:19.479397 (MainThread):   relation "public.raw_orders" does not exist
2020-11-09 16:28:19.479683 (MainThread):   LINE 5:     select * from "dbttest1"."public"."raw_orders"
2020-11-09 16:28:19.479846 (MainThread):                             ^
2020-11-09 16:28:19.479934 (MainThread):   compiled SQL at target/run/jaffle_shop/models/staging/stg_orders.sql
2020-11-09 16:28:19.480022 (MainThread): 
2020-11-09 16:28:19.480116 (MainThread): Database Error in model stg_payments (models/staging/stg_payments.sql)
2020-11-09 16:28:19.480204 (MainThread):   relation "public.raw_payments" does not exist
2020-11-09 16:28:19.480285 (MainThread):   LINE 5:     select * from "dbttest1"."public"."raw_payments"
2020-11-09 16:28:19.480360 (MainThread):                             ^
2020-11-09 16:28:19.480444 (MainThread):   compiled SQL at target/run/jaffle_shop/models/staging/stg_payments.sql
2020-11-09 16:28:19.480550 (MainThread): 
2020-11-09 16:28:19.480687 (MainThread): Database Error in model stg_customers (models/staging/stg_customers.sql)
2020-11-09 16:28:19.480878 (MainThread):   relation "public.raw_customers" does not exist
2020-11-09 16:28:19.481061 (MainThread):   LINE 5:     select * from "dbttest1"."public"."raw_customers"
2020-11-09 16:28:19.481171 (MainThread):                             ^
2020-11-09 16:28:19.481258 (MainThread):   compiled SQL at target/run/jaffle_shop/models/staging/stg_customers.sql
2020-11-09 16:28:19.481353 (MainThread): 
Done. PASS=0 WARN=0 ERROR=3 SKIP=5 TOTAL=8
2020-11-09 16:28:19.481513 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a218850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3eef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4bbf70>]}
2020-11-09 16:28:19.481760 (MainThread): Flushing usage events
2020-11-09 16:28:25.013526 (MainThread): Running with dbt=0.18.1
2020-11-09 16:28:25.093376 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', selector_name=None, show=False, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2020-11-09 16:28:25.094247 (MainThread): Tracking: tracking
2020-11-09 16:28:25.104595 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090d9760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090ebcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090f94c0>]}
2020-11-09 16:28:25.125773 (MainThread): Partial parsing not enabled
2020-11-09 16:28:25.126784 (MainThread): Parsing macros/catalog.sql
2020-11-09 16:28:25.130109 (MainThread): Parsing macros/relations.sql
2020-11-09 16:28:25.131634 (MainThread): Parsing macros/adapters.sql
2020-11-09 16:28:25.154789 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-11-09 16:28:25.158208 (MainThread): Parsing macros/core.sql
2020-11-09 16:28:25.162176 (MainThread): Parsing macros/materializations/helpers.sql
2020-11-09 16:28:25.171827 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-11-09 16:28:25.173887 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-11-09 16:28:25.191599 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-11-09 16:28:25.224101 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-11-09 16:28:25.246797 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-11-09 16:28:25.248785 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-11-09 16:28:25.255362 (MainThread): Parsing macros/materializations/common/merge.sql
2020-11-09 16:28:25.270757 (MainThread): Parsing macros/materializations/table/table.sql
2020-11-09 16:28:25.279004 (MainThread): Parsing macros/materializations/view/view.sql
2020-11-09 16:28:25.286225 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-11-09 16:28:25.291544 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-11-09 16:28:25.292789 (MainThread): Parsing macros/etc/query.sql
2020-11-09 16:28:25.293979 (MainThread): Parsing macros/etc/is_incremental.sql
2020-11-09 16:28:25.295796 (MainThread): Parsing macros/etc/datetime.sql
2020-11-09 16:28:25.305299 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-11-09 16:28:25.307638 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-11-09 16:28:25.309664 (MainThread): Parsing macros/adapters/common.sql
2020-11-09 16:28:25.358132 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-11-09 16:28:25.360197 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-11-09 16:28:25.361872 (MainThread): Parsing macros/schema_tests/unique.sql
2020-11-09 16:28:25.363666 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-11-09 16:28:25.371709 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2020-11-09 16:28:25.371874 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5a60d1a8-bc84-4ef4-bb1b-cc190107e877', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10915d310>]}
2020-11-09 16:28:25.372357 (MainThread): Partial parsing not enabled
2020-11-09 16:28:25.410742 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 16:28:25.428256 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 16:28:25.434808 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:28:25.441284 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 16:28:25.450263 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 16:28:25.458657 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2020-11-09 16:28:25.465947 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 16:28:25.473143 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 16:28:25.946301 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 3 seed files, 0 sources
2020-11-09 16:28:25.948435 (MainThread): 
2020-11-09 16:28:25.948764 (MainThread): Acquiring new postgres connection "master".
2020-11-09 16:28:25.952957 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dbttest1".
2020-11-09 16:28:25.962808 (ThreadPoolExecutor-0_0): Using postgres connection "list_dbttest1".
2020-11-09 16:28:25.962937 (ThreadPoolExecutor-0_0): On list_dbttest1: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1"} */

    select distinct nspname from pg_namespace
  
2020-11-09 16:28:25.963036 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-09 16:28:25.973651 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2020-11-09 16:28:25.975920 (ThreadPoolExecutor-0_0): On list_dbttest1: Close
2020-11-09 16:28:26.017496 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dbttest1_public".
2020-11-09 16:28:26.028690 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2020-11-09 16:28:26.028879 (ThreadPoolExecutor-1_0): On list_dbttest1_public: BEGIN
2020-11-09 16:28:26.029061 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2020-11-09 16:28:26.039577 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2020-11-09 16:28:26.039786 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2020-11-09 16:28:26.039924 (ThreadPoolExecutor-1_0): On list_dbttest1_public: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1_public"} */
select
      'dbttest1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbttest1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-11-09 16:28:26.043672 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.00 seconds
2020-11-09 16:28:26.043967 (ThreadPoolExecutor-1_0): On list_dbttest1_public: ROLLBACK
2020-11-09 16:28:26.045487 (ThreadPoolExecutor-1_0): On list_dbttest1_public: Close
2020-11-09 16:28:26.083358 (MainThread): Using postgres connection "master".
2020-11-09 16:28:26.083486 (MainThread): On master: BEGIN
2020-11-09 16:28:26.083570 (MainThread): Opening a new connection, currently in state init
2020-11-09 16:28:26.093119 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-11-09 16:28:26.093297 (MainThread): Using postgres connection "master".
2020-11-09 16:28:26.093434 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-11-09 16:28:26.100366 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2020-11-09 16:28:26.100674 (MainThread): On master: ROLLBACK
2020-11-09 16:28:26.101856 (MainThread): Using postgres connection "master".
2020-11-09 16:28:26.101966 (MainThread): On master: BEGIN
2020-11-09 16:28:26.103707 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-11-09 16:28:26.103848 (MainThread): On master: COMMIT
2020-11-09 16:28:26.103937 (MainThread): Using postgres connection "master".
2020-11-09 16:28:26.104010 (MainThread): On master: COMMIT
2020-11-09 16:28:26.104884 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-11-09 16:28:26.104997 (MainThread): On master: Close
2020-11-09 16:28:26.105273 (MainThread): 11:28:26 | Concurrency: 1 threads (target='dev')
2020-11-09 16:28:26.105400 (MainThread): 11:28:26 | 
2020-11-09 16:28:26.108472 (Thread-1): Began running node seed.jaffle_shop.raw_customers
2020-11-09 16:28:26.109534 (Thread-1): 11:28:26 | 1 of 3 START seed file public.raw_customers.......................... [RUN]
2020-11-09 16:28:26.109811 (Thread-1): Acquiring new postgres connection "seed.jaffle_shop.raw_customers".
2020-11-09 16:28:26.109927 (Thread-1): finished collecting timing info
2020-11-09 16:28:26.142943 (Thread-1): * Deprecation Warning: The quote_columns parameter was not set for seeds, so the
default value of False was chosen. The default will change to True in a future
release.

For more information, see:
https://docs.getdbt.com/v0.15/docs/seeds#section-specify-column-quoting
2020-11-09 16:28:26.143119 (Thread-1): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5a60d1a8-bc84-4ef4-bb1b-cc190107e877', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094f00a0>]}
2020-11-09 16:28:26.143611 (Thread-1): Using postgres connection "seed.jaffle_shop.raw_customers".
2020-11-09 16:28:26.143708 (Thread-1): On seed.jaffle_shop.raw_customers: BEGIN
2020-11-09 16:28:26.143789 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 16:28:26.152543 (Thread-1): SQL status: BEGIN in 0.01 seconds
2020-11-09 16:28:26.152715 (Thread-1): Using postgres connection "seed.jaffle_shop.raw_customers".
2020-11-09 16:28:26.152794 (Thread-1): On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */

    create table "dbttest1"."public"."raw_customers" (id integer,first_name text,last_name text,email text)
  
2020-11-09 16:28:26.166683 (Thread-1): SQL status: CREATE TABLE in 0.01 seconds
2020-11-09 16:28:26.185775 (Thread-1): Using postgres connection "seed.jaffle_shop.raw_customers".
2020-11-09 16:28:26.186006 (Thread-1): On seed.jaffle_shop.raw_customers: 
            insert into "dbttest1"."public"."raw_customers" (id, first_name, last_name, email) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%...
2020-11-09 16:28:26.188715 (Thread-1): SQL status: INSERT 0 100 in 0.00 seconds
2020-11-09 16:28:26.192745 (Thread-1): Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
2020-11-09 16:28:26.204584 (Thread-1): On seed.jaffle_shop.raw_customers: COMMIT
2020-11-09 16:28:26.204807 (Thread-1): Using postgres connection "seed.jaffle_shop.raw_customers".
2020-11-09 16:28:26.204945 (Thread-1): On seed.jaffle_shop.raw_customers: COMMIT
2020-11-09 16:28:26.224608 (Thread-1): SQL status: COMMIT in 0.02 seconds
2020-11-09 16:28:26.227943 (Thread-1): finished collecting timing info
2020-11-09 16:28:26.228214 (Thread-1): On seed.jaffle_shop.raw_customers: Close
2020-11-09 16:28:26.229139 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a60d1a8-bc84-4ef4-bb1b-cc190107e877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092b8f40>]}
2020-11-09 16:28:26.229588 (Thread-1): 11:28:26 | 1 of 3 OK loaded seed file public.raw_customers...................... [INSERT 100 in 0.12s]
2020-11-09 16:28:26.229754 (Thread-1): Finished running node seed.jaffle_shop.raw_customers
2020-11-09 16:28:26.229960 (Thread-1): Began running node seed.jaffle_shop.raw_orders
2020-11-09 16:28:26.232279 (Thread-1): 11:28:26 | 2 of 3 START seed file public.raw_orders............................. [RUN]
2020-11-09 16:28:26.232672 (Thread-1): Acquiring new postgres connection "seed.jaffle_shop.raw_orders".
2020-11-09 16:28:26.232804 (Thread-1): finished collecting timing info
2020-11-09 16:28:26.247640 (Thread-1): Using postgres connection "seed.jaffle_shop.raw_orders".
2020-11-09 16:28:26.247824 (Thread-1): On seed.jaffle_shop.raw_orders: BEGIN
2020-11-09 16:28:26.247976 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 16:28:26.257213 (Thread-1): SQL status: BEGIN in 0.01 seconds
2020-11-09 16:28:26.257367 (Thread-1): Using postgres connection "seed.jaffle_shop.raw_orders".
2020-11-09 16:28:26.257453 (Thread-1): On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */

    create table "dbttest1"."public"."raw_orders" (id integer,user_id integer,order_date date,status text)
  
2020-11-09 16:28:26.262426 (Thread-1): SQL status: CREATE TABLE in 0.00 seconds
2020-11-09 16:28:26.266104 (Thread-1): Using postgres connection "seed.jaffle_shop.raw_orders".
2020-11-09 16:28:26.266226 (Thread-1): On seed.jaffle_shop.raw_orders: 
            insert into "dbttest1"."public"."raw_orders" (id, user_id, order_date, status) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s...
2020-11-09 16:28:26.269228 (Thread-1): SQL status: INSERT 0 99 in 0.00 seconds
2020-11-09 16:28:26.269583 (Thread-1): Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
2020-11-09 16:28:26.272058 (Thread-1): On seed.jaffle_shop.raw_orders: COMMIT
2020-11-09 16:28:26.272170 (Thread-1): Using postgres connection "seed.jaffle_shop.raw_orders".
2020-11-09 16:28:26.272245 (Thread-1): On seed.jaffle_shop.raw_orders: COMMIT
2020-11-09 16:28:26.274104 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 16:28:26.275728 (Thread-1): finished collecting timing info
2020-11-09 16:28:26.275964 (Thread-1): On seed.jaffle_shop.raw_orders: Close
2020-11-09 16:28:26.276475 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a60d1a8-bc84-4ef4-bb1b-cc190107e877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092b8bb0>]}
2020-11-09 16:28:26.276735 (Thread-1): 11:28:26 | 2 of 3 OK loaded seed file public.raw_orders......................... [INSERT 99 in 0.04s]
2020-11-09 16:28:26.276855 (Thread-1): Finished running node seed.jaffle_shop.raw_orders
2020-11-09 16:28:26.276972 (Thread-1): Began running node seed.jaffle_shop.raw_payments
2020-11-09 16:28:26.278113 (Thread-1): 11:28:26 | 3 of 3 START seed file public.raw_payments........................... [RUN]
2020-11-09 16:28:26.278437 (Thread-1): Acquiring new postgres connection "seed.jaffle_shop.raw_payments".
2020-11-09 16:28:26.278586 (Thread-1): finished collecting timing info
2020-11-09 16:28:26.288958 (Thread-1): Using postgres connection "seed.jaffle_shop.raw_payments".
2020-11-09 16:28:26.289092 (Thread-1): On seed.jaffle_shop.raw_payments: BEGIN
2020-11-09 16:28:26.289176 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 16:28:26.300506 (Thread-1): SQL status: BEGIN in 0.01 seconds
2020-11-09 16:28:26.300854 (Thread-1): Using postgres connection "seed.jaffle_shop.raw_payments".
2020-11-09 16:28:26.300970 (Thread-1): On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */

    create table "dbttest1"."public"."raw_payments" (id integer,order_id integer,payment_method text,amount integer)
  
2020-11-09 16:28:26.305813 (Thread-1): SQL status: CREATE TABLE in 0.00 seconds
2020-11-09 16:28:26.309316 (Thread-1): Using postgres connection "seed.jaffle_shop.raw_payments".
2020-11-09 16:28:26.309419 (Thread-1): On seed.jaffle_shop.raw_payments: 
            insert into "dbttest1"."public"."raw_payments" (id, order_id, payment_method, amount) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%...
2020-11-09 16:28:26.313009 (Thread-1): SQL status: INSERT 0 113 in 0.00 seconds
2020-11-09 16:28:26.313351 (Thread-1): Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
2020-11-09 16:28:26.315822 (Thread-1): On seed.jaffle_shop.raw_payments: COMMIT
2020-11-09 16:28:26.315942 (Thread-1): Using postgres connection "seed.jaffle_shop.raw_payments".
2020-11-09 16:28:26.316021 (Thread-1): On seed.jaffle_shop.raw_payments: COMMIT
2020-11-09 16:28:26.317910 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 16:28:26.319448 (Thread-1): finished collecting timing info
2020-11-09 16:28:26.319674 (Thread-1): On seed.jaffle_shop.raw_payments: Close
2020-11-09 16:28:26.320155 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a60d1a8-bc84-4ef4-bb1b-cc190107e877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092a7a60>]}
2020-11-09 16:28:26.320373 (Thread-1): 11:28:26 | 3 of 3 OK loaded seed file public.raw_payments....................... [INSERT 113 in 0.04s]
2020-11-09 16:28:26.320491 (Thread-1): Finished running node seed.jaffle_shop.raw_payments
2020-11-09 16:28:26.321370 (MainThread): Acquiring new postgres connection "master".
2020-11-09 16:28:26.321511 (MainThread): Using postgres connection "master".
2020-11-09 16:28:26.321590 (MainThread): On master: BEGIN
2020-11-09 16:28:26.321686 (MainThread): Opening a new connection, currently in state closed
2020-11-09 16:28:26.331565 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-11-09 16:28:26.331725 (MainThread): On master: COMMIT
2020-11-09 16:28:26.331808 (MainThread): Using postgres connection "master".
2020-11-09 16:28:26.331879 (MainThread): On master: COMMIT
2020-11-09 16:28:26.332983 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-11-09 16:28:26.333136 (MainThread): On master: Close
2020-11-09 16:28:26.333613 (MainThread): 11:28:26 | 
2020-11-09 16:28:26.333927 (MainThread): 11:28:26 | Finished running 3 seeds in 0.38s.
2020-11-09 16:28:26.334258 (MainThread): Connection 'master' was properly closed.
2020-11-09 16:28:26.334513 (MainThread): Connection 'seed.jaffle_shop.raw_payments' was properly closed.
2020-11-09 16:28:26.344023 (MainThread): 
2020-11-09 16:28:26.344170 (MainThread): Completed successfully
2020-11-09 16:28:26.344273 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2020-11-09 16:28:26.344531 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092a8070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109454310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109454fd0>]}
2020-11-09 16:28:26.344796 (MainThread): Flushing usage events
2020-11-09 16:28:29.486672 (MainThread): Running with dbt=0.18.1
2020-11-09 16:28:29.568548 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-09 16:28:29.569214 (MainThread): Tracking: tracking
2020-11-09 16:28:29.579823 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059ed370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059ffd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a0c580>]}
2020-11-09 16:28:29.601928 (MainThread): Partial parsing not enabled
2020-11-09 16:28:29.602927 (MainThread): Parsing macros/catalog.sql
2020-11-09 16:28:29.606790 (MainThread): Parsing macros/relations.sql
2020-11-09 16:28:29.609059 (MainThread): Parsing macros/adapters.sql
2020-11-09 16:28:29.632594 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-11-09 16:28:29.635686 (MainThread): Parsing macros/core.sql
2020-11-09 16:28:29.639725 (MainThread): Parsing macros/materializations/helpers.sql
2020-11-09 16:28:29.649224 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-11-09 16:28:29.651112 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-11-09 16:28:29.669085 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-11-09 16:28:29.701748 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-11-09 16:28:29.724905 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-11-09 16:28:29.727369 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-11-09 16:28:29.734360 (MainThread): Parsing macros/materializations/common/merge.sql
2020-11-09 16:28:29.750891 (MainThread): Parsing macros/materializations/table/table.sql
2020-11-09 16:28:29.758189 (MainThread): Parsing macros/materializations/view/view.sql
2020-11-09 16:28:29.764929 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-11-09 16:28:29.770328 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-11-09 16:28:29.771365 (MainThread): Parsing macros/etc/query.sql
2020-11-09 16:28:29.772716 (MainThread): Parsing macros/etc/is_incremental.sql
2020-11-09 16:28:29.774614 (MainThread): Parsing macros/etc/datetime.sql
2020-11-09 16:28:29.784197 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-11-09 16:28:29.786330 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-11-09 16:28:29.788135 (MainThread): Parsing macros/adapters/common.sql
2020-11-09 16:28:29.835553 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-11-09 16:28:29.837591 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-11-09 16:28:29.839312 (MainThread): Parsing macros/schema_tests/unique.sql
2020-11-09 16:28:29.841130 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-11-09 16:28:29.849115 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2020-11-09 16:28:29.849287 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '15bd9474-dbce-4e44-9c8e-c4c1bc005f5e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059edbe0>]}
2020-11-09 16:28:29.849785 (MainThread): Partial parsing not enabled
2020-11-09 16:28:29.887665 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 16:28:29.903955 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 16:28:29.910455 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:28:29.916706 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 16:28:29.925696 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 16:28:29.933799 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2020-11-09 16:28:29.941163 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 16:28:29.948320 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 16:28:30.515194 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 3 seed files, 0 sources
2020-11-09 16:28:30.517556 (MainThread): 
2020-11-09 16:28:30.517964 (MainThread): Acquiring new postgres connection "master".
2020-11-09 16:28:30.540011 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dbttest1".
2020-11-09 16:28:30.551375 (ThreadPoolExecutor-0_0): Using postgres connection "list_dbttest1".
2020-11-09 16:28:30.551711 (ThreadPoolExecutor-0_0): On list_dbttest1: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1"} */

    select distinct nspname from pg_namespace
  
2020-11-09 16:28:30.551878 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-09 16:28:30.562405 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2020-11-09 16:28:30.564665 (ThreadPoolExecutor-0_0): On list_dbttest1: Close
2020-11-09 16:28:30.604252 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dbttest1_public".
2020-11-09 16:28:30.609930 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2020-11-09 16:28:30.610059 (ThreadPoolExecutor-1_0): On list_dbttest1_public: BEGIN
2020-11-09 16:28:30.610139 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2020-11-09 16:28:30.619378 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2020-11-09 16:28:30.619541 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2020-11-09 16:28:30.619629 (ThreadPoolExecutor-1_0): On list_dbttest1_public: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1_public"} */
select
      'dbttest1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbttest1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-11-09 16:28:30.622997 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.00 seconds
2020-11-09 16:28:30.625544 (ThreadPoolExecutor-1_0): On list_dbttest1_public: ROLLBACK
2020-11-09 16:28:30.626474 (ThreadPoolExecutor-1_0): On list_dbttest1_public: Close
2020-11-09 16:28:30.666539 (MainThread): Using postgres connection "master".
2020-11-09 16:28:30.666667 (MainThread): On master: BEGIN
2020-11-09 16:28:30.666748 (MainThread): Opening a new connection, currently in state init
2020-11-09 16:28:30.674156 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-11-09 16:28:30.674323 (MainThread): Using postgres connection "master".
2020-11-09 16:28:30.674447 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-11-09 16:28:30.680269 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2020-11-09 16:28:30.680574 (MainThread): On master: ROLLBACK
2020-11-09 16:28:30.681527 (MainThread): Using postgres connection "master".
2020-11-09 16:28:30.681623 (MainThread): On master: BEGIN
2020-11-09 16:28:30.683386 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-11-09 16:28:30.683551 (MainThread): On master: COMMIT
2020-11-09 16:28:30.683647 (MainThread): Using postgres connection "master".
2020-11-09 16:28:30.683719 (MainThread): On master: COMMIT
2020-11-09 16:28:30.685000 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-11-09 16:28:30.685150 (MainThread): On master: Close
2020-11-09 16:28:30.685518 (MainThread): 11:28:30 | Concurrency: 1 threads (target='dev')
2020-11-09 16:28:30.685641 (MainThread): 11:28:30 | 
2020-11-09 16:28:30.688317 (Thread-1): Began running node model.jaffle_shop.stg_orders
2020-11-09 16:28:30.689305 (Thread-1): 11:28:30 | 1 of 8 START view model public.stg_orders............................ [RUN]
2020-11-09 16:28:30.689788 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:28:30.689904 (Thread-1): Compiling model.jaffle_shop.stg_orders
2020-11-09 16:28:30.709663 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2020-11-09 16:28:30.710247 (Thread-1): finished collecting timing info
2020-11-09 16:28:30.737169 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:28:30.737311 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbttest1"."public"."stg_orders__dbt_tmp" cascade
2020-11-09 16:28:30.737399 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 16:28:30.746374 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-11-09 16:28:30.748996 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:28:30.749121 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbttest1"."public"."stg_orders__dbt_backup" cascade
2020-11-09 16:28:30.750349 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-11-09 16:28:30.754829 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2020-11-09 16:28:30.755284 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:28:30.755378 (Thread-1): On model.jaffle_shop.stg_orders: BEGIN
2020-11-09 16:28:30.756827 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 16:28:30.756964 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:28:30.757043 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "dbttest1"."public"."stg_orders__dbt_tmp" as (
    with source as (
    select * from "dbttest1"."public"."raw_orders"

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from renamed
  );

2020-11-09 16:28:30.763299 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-11-09 16:28:30.769463 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:28:30.769587 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbttest1"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
2020-11-09 16:28:30.772403 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 16:28:30.780320 (Thread-1): On model.jaffle_shop.stg_orders: COMMIT
2020-11-09 16:28:30.780455 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:28:30.780532 (Thread-1): On model.jaffle_shop.stg_orders: COMMIT
2020-11-09 16:28:30.781831 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 16:28:30.785509 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:28:30.785639 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbttest1"."public"."stg_orders__dbt_backup" cascade
2020-11-09 16:28:30.786960 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-11-09 16:28:30.789397 (Thread-1): finished collecting timing info
2020-11-09 16:28:30.789660 (Thread-1): On model.jaffle_shop.stg_orders: Close
2020-11-09 16:28:30.790222 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15bd9474-dbce-4e44-9c8e-c4c1bc005f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dfa640>]}
2020-11-09 16:28:30.791354 (Thread-1): 11:28:30 | 1 of 8 OK created view model public.stg_orders....................... [CREATE VIEW in 0.10s]
2020-11-09 16:28:30.791497 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2020-11-09 16:28:30.791636 (Thread-1): Began running node model.jaffle_shop.stg_payments
2020-11-09 16:28:30.792926 (Thread-1): 11:28:30 | 2 of 8 START view model public.stg_payments.......................... [RUN]
2020-11-09 16:28:30.793475 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 16:28:30.793628 (Thread-1): Compiling model.jaffle_shop.stg_payments
2020-11-09 16:28:30.802580 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2020-11-09 16:28:30.802991 (Thread-1): finished collecting timing info
2020-11-09 16:28:30.809052 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 16:28:30.809171 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbttest1"."public"."stg_payments__dbt_tmp" cascade
2020-11-09 16:28:30.809253 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 16:28:30.818322 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-11-09 16:28:30.821138 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 16:28:30.821324 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbttest1"."public"."stg_payments__dbt_backup" cascade
2020-11-09 16:28:30.822474 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-11-09 16:28:30.823551 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2020-11-09 16:28:30.823963 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 16:28:30.824047 (Thread-1): On model.jaffle_shop.stg_payments: BEGIN
2020-11-09 16:28:30.825088 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 16:28:30.825214 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 16:28:30.825296 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "dbttest1"."public"."stg_payments__dbt_tmp" as (
    with source as (
    select * from "dbttest1"."public"."raw_payments"

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        --`amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed
  );

2020-11-09 16:28:30.828740 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-11-09 16:28:30.830975 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 16:28:30.831076 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbttest1"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
2020-11-09 16:28:30.832574 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 16:28:30.833759 (Thread-1): On model.jaffle_shop.stg_payments: COMMIT
2020-11-09 16:28:30.833879 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 16:28:30.833963 (Thread-1): On model.jaffle_shop.stg_payments: COMMIT
2020-11-09 16:28:30.836040 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 16:28:30.837710 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 16:28:30.837817 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbttest1"."public"."stg_payments__dbt_backup" cascade
2020-11-09 16:28:30.839078 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-11-09 16:28:30.841215 (Thread-1): finished collecting timing info
2020-11-09 16:28:30.841448 (Thread-1): On model.jaffle_shop.stg_payments: Close
2020-11-09 16:28:30.841949 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15bd9474-dbce-4e44-9c8e-c4c1bc005f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dfa0a0>]}
2020-11-09 16:28:30.843060 (Thread-1): 11:28:30 | 2 of 8 OK created view model public.stg_payments..................... [CREATE VIEW in 0.05s]
2020-11-09 16:28:30.843208 (Thread-1): Finished running node model.jaffle_shop.stg_payments
2020-11-09 16:28:30.843333 (Thread-1): Began running node model.jaffle_shop.stg_customers
2020-11-09 16:28:30.844443 (Thread-1): 11:28:30 | 3 of 8 START view model public.stg_customers......................... [RUN]
2020-11-09 16:28:30.845010 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 16:28:30.845172 (Thread-1): Compiling model.jaffle_shop.stg_customers
2020-11-09 16:28:30.853132 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2020-11-09 16:28:30.853519 (Thread-1): finished collecting timing info
2020-11-09 16:28:30.860309 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 16:28:30.860434 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbttest1"."public"."stg_customers__dbt_tmp" cascade
2020-11-09 16:28:30.860516 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 16:28:30.871777 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-11-09 16:28:30.874713 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 16:28:30.874850 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbttest1"."public"."stg_customers__dbt_backup" cascade
2020-11-09 16:28:30.876069 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-11-09 16:28:30.877268 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2020-11-09 16:28:30.877678 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 16:28:30.877765 (Thread-1): On model.jaffle_shop.stg_customers: BEGIN
2020-11-09 16:28:30.878872 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 16:28:30.878983 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 16:28:30.879057 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "dbttest1"."public"."stg_customers__dbt_tmp" as (
    with source as (
    select * from "dbttest1"."public"."raw_customers"

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name,
        email

    from source

)

select * from renamed
  );

2020-11-09 16:28:30.884359 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-11-09 16:28:30.887239 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 16:28:30.887378 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbttest1"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
2020-11-09 16:28:30.889233 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 16:28:30.890255 (Thread-1): On model.jaffle_shop.stg_customers: COMMIT
2020-11-09 16:28:30.890355 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 16:28:30.890426 (Thread-1): On model.jaffle_shop.stg_customers: COMMIT
2020-11-09 16:28:30.891791 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 16:28:30.893508 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 16:28:30.893607 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbttest1"."public"."stg_customers__dbt_backup" cascade
2020-11-09 16:28:30.894671 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-11-09 16:28:30.896929 (Thread-1): finished collecting timing info
2020-11-09 16:28:30.897190 (Thread-1): On model.jaffle_shop.stg_customers: Close
2020-11-09 16:28:30.897696 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15bd9474-dbce-4e44-9c8e-c4c1bc005f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e3e790>]}
2020-11-09 16:28:30.898644 (Thread-1): 11:28:30 | 3 of 8 OK created view model public.stg_customers.................... [CREATE VIEW in 0.05s]
2020-11-09 16:28:30.898772 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2020-11-09 16:28:30.898893 (Thread-1): Began running node model.jaffle_shop.customer_orders
2020-11-09 16:28:30.899884 (Thread-1): 11:28:30 | 4 of 8 START table model public.customer_orders...................... [RUN]
2020-11-09 16:28:30.900361 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 16:28:30.900613 (Thread-1): Compiling model.jaffle_shop.customer_orders
2020-11-09 16:28:30.907291 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customer_orders"
2020-11-09 16:28:30.907857 (Thread-1): finished collecting timing info
2020-11-09 16:28:30.927526 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 16:28:30.927661 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
drop table if exists "dbttest1"."public"."customer_orders__dbt_tmp" cascade
2020-11-09 16:28:30.927743 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 16:28:30.937038 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-11-09 16:28:30.939611 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 16:28:30.939741 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
drop table if exists "dbttest1"."public"."customer_orders__dbt_backup" cascade
2020-11-09 16:28:30.941081 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 16:28:30.946685 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customer_orders"
2020-11-09 16:28:30.947296 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 16:28:30.947392 (Thread-1): On model.jaffle_shop.customer_orders: BEGIN
2020-11-09 16:28:30.948497 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 16:28:30.948619 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 16:28:30.948699 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */


  create  table "dbttest1"."public"."customer_orders__dbt_tmp"
  as (
    with orders as (

    select * from "dbttest1"."public"."stg_orders"

),

final as (

    select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by 1

)

select * from final
  );
2020-11-09 16:28:30.953844 (Thread-1): SQL status: SELECT 62 in 0.01 seconds
2020-11-09 16:28:30.956076 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 16:28:30.956176 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
alter table "dbttest1"."public"."customer_orders__dbt_tmp" rename to "customer_orders"
2020-11-09 16:28:30.957373 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 16:28:30.958408 (Thread-1): On model.jaffle_shop.customer_orders: COMMIT
2020-11-09 16:28:30.958510 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 16:28:30.958585 (Thread-1): On model.jaffle_shop.customer_orders: COMMIT
2020-11-09 16:28:30.959571 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 16:28:30.961286 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 16:28:30.961385 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
drop table if exists "dbttest1"."public"."customer_orders__dbt_backup" cascade
2020-11-09 16:28:30.962706 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 16:28:30.964821 (Thread-1): finished collecting timing info
2020-11-09 16:28:30.965070 (Thread-1): On model.jaffle_shop.customer_orders: Close
2020-11-09 16:28:30.965580 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15bd9474-dbce-4e44-9c8e-c4c1bc005f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c02d00>]}
2020-11-09 16:28:30.966598 (Thread-1): 11:28:30 | 4 of 8 OK created table model public.customer_orders................. [SELECT 62 in 0.07s]
2020-11-09 16:28:30.966732 (Thread-1): Finished running node model.jaffle_shop.customer_orders
2020-11-09 16:28:30.966856 (Thread-1): Began running node model.jaffle_shop.customer_payments
2020-11-09 16:28:30.967863 (Thread-1): 11:28:30 | 5 of 8 START table model public.customer_payments.................... [RUN]
2020-11-09 16:28:30.968255 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 16:28:30.968386 (Thread-1): Compiling model.jaffle_shop.customer_payments
2020-11-09 16:28:30.976129 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customer_payments"
2020-11-09 16:28:30.976543 (Thread-1): finished collecting timing info
2020-11-09 16:28:30.983934 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 16:28:30.984123 (Thread-1): On model.jaffle_shop.customer_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_payments"} */
drop table if exists "dbttest1"."public"."customer_payments__dbt_tmp" cascade
2020-11-09 16:28:30.984278 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 16:28:30.992369 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-11-09 16:28:30.994731 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 16:28:30.994849 (Thread-1): On model.jaffle_shop.customer_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_payments"} */
drop table if exists "dbttest1"."public"."customer_payments__dbt_backup" cascade
2020-11-09 16:28:30.995850 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 16:28:30.996979 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customer_payments"
2020-11-09 16:28:30.997437 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 16:28:30.997532 (Thread-1): On model.jaffle_shop.customer_payments: BEGIN
2020-11-09 16:28:30.999061 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 16:28:30.999237 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 16:28:30.999315 (Thread-1): On model.jaffle_shop.customer_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_payments"} */


  create  table "dbttest1"."public"."customer_payments__dbt_tmp"
  as (
    with payments as (

    select * from "dbttest1"."public"."stg_payments"

),

orders as (

    select * from "dbttest1"."public"."stg_orders"

),

final as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders using (order_id)

    group by 1

)

select * from final
  );
2020-11-09 16:28:31.004456 (Thread-1): SQL status: SELECT 62 in 0.01 seconds
2020-11-09 16:28:31.006851 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 16:28:31.006956 (Thread-1): On model.jaffle_shop.customer_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_payments"} */
alter table "dbttest1"."public"."customer_payments__dbt_tmp" rename to "customer_payments"
2020-11-09 16:28:31.008259 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 16:28:31.009310 (Thread-1): On model.jaffle_shop.customer_payments: COMMIT
2020-11-09 16:28:31.009412 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 16:28:31.009484 (Thread-1): On model.jaffle_shop.customer_payments: COMMIT
2020-11-09 16:28:31.010476 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 16:28:31.013200 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 16:28:31.013326 (Thread-1): On model.jaffle_shop.customer_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_payments"} */
drop table if exists "dbttest1"."public"."customer_payments__dbt_backup" cascade
2020-11-09 16:28:31.014714 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 16:28:31.016932 (Thread-1): finished collecting timing info
2020-11-09 16:28:31.017291 (Thread-1): On model.jaffle_shop.customer_payments: Close
2020-11-09 16:28:31.017965 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15bd9474-dbce-4e44-9c8e-c4c1bc005f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e87d30>]}
2020-11-09 16:28:31.019626 (Thread-1): 11:28:31 | 5 of 8 OK created table model public.customer_payments............... [SELECT 62 in 0.05s]
2020-11-09 16:28:31.019790 (Thread-1): Finished running node model.jaffle_shop.customer_payments
2020-11-09 16:28:31.020051 (Thread-1): Began running node model.jaffle_shop.order_payments
2020-11-09 16:28:31.022197 (Thread-1): 11:28:31 | 6 of 8 START table model public.order_payments....................... [RUN]
2020-11-09 16:28:31.022722 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2020-11-09 16:28:31.022927 (Thread-1): Compiling model.jaffle_shop.order_payments
2020-11-09 16:28:31.039245 (Thread-1): Writing injected SQL for node "model.jaffle_shop.order_payments"
2020-11-09 16:28:31.039871 (Thread-1): finished collecting timing info
2020-11-09 16:28:31.046548 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 16:28:31.046675 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */
drop table if exists "dbttest1"."public"."order_payments__dbt_tmp" cascade
2020-11-09 16:28:31.046755 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 16:28:31.055632 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-11-09 16:28:31.057998 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 16:28:31.058103 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */
drop table if exists "dbttest1"."public"."order_payments__dbt_backup" cascade
2020-11-09 16:28:31.059090 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 16:28:31.060242 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.order_payments"
2020-11-09 16:28:31.061029 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 16:28:31.061120 (Thread-1): On model.jaffle_shop.order_payments: BEGIN
2020-11-09 16:28:31.062205 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 16:28:31.062321 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 16:28:31.062398 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */


  create  table "dbttest1"."public"."order_payments__dbt_tmp"
  as (
    

with payments as (

    select * from "dbttest1"."public"."stg_payments"

),

final as (

    select
        order_id,

        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,
        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,
        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,
        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,
        sum(amount) as total_amount

    from payments

    group by 1

)

select * from final
  );
2020-11-09 16:28:31.066039 (Thread-1): SQL status: SELECT 99 in 0.00 seconds
2020-11-09 16:28:31.068405 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 16:28:31.068516 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */
alter table "dbttest1"."public"."order_payments__dbt_tmp" rename to "order_payments"
2020-11-09 16:28:31.069631 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 16:28:31.070610 (Thread-1): On model.jaffle_shop.order_payments: COMMIT
2020-11-09 16:28:31.070709 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 16:28:31.070782 (Thread-1): On model.jaffle_shop.order_payments: COMMIT
2020-11-09 16:28:31.071826 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 16:28:31.073480 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 16:28:31.073581 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */
drop table if exists "dbttest1"."public"."order_payments__dbt_backup" cascade
2020-11-09 16:28:31.074527 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 16:28:31.076689 (Thread-1): finished collecting timing info
2020-11-09 16:28:31.076919 (Thread-1): On model.jaffle_shop.order_payments: Close
2020-11-09 16:28:31.077409 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15bd9474-dbce-4e44-9c8e-c4c1bc005f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e89f40>]}
2020-11-09 16:28:31.078379 (Thread-1): 11:28:31 | 6 of 8 OK created table model public.order_payments.................. [SELECT 99 in 0.05s]
2020-11-09 16:28:31.078517 (Thread-1): Finished running node model.jaffle_shop.order_payments
2020-11-09 16:28:31.078636 (Thread-1): Began running node model.jaffle_shop.dim_customers
2020-11-09 16:28:31.079602 (Thread-1): 11:28:31 | 7 of 8 START table model public.dim_customers........................ [RUN]
2020-11-09 16:28:31.080079 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 16:28:31.080201 (Thread-1): Compiling model.jaffle_shop.dim_customers
2020-11-09 16:28:31.093346 (Thread-1): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2020-11-09 16:28:31.093812 (Thread-1): finished collecting timing info
2020-11-09 16:28:31.101685 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 16:28:31.101823 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "dbttest1"."public"."dim_customers__dbt_tmp" cascade
2020-11-09 16:28:31.101908 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 16:28:31.109835 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-11-09 16:28:31.112144 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 16:28:31.112267 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "dbttest1"."public"."dim_customers__dbt_backup" cascade
2020-11-09 16:28:31.113415 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 16:28:31.115455 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2020-11-09 16:28:31.116143 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 16:28:31.116288 (Thread-1): On model.jaffle_shop.dim_customers: BEGIN
2020-11-09 16:28:31.118685 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 16:28:31.118945 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 16:28:31.119073 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */


  create  table "dbttest1"."public"."dim_customers__dbt_tmp"
  as (
    with customers as (

    select * from "dbttest1"."public"."stg_customers"

),

customer_orders as (

    select * from "dbttest1"."public"."customer_orders"

),

customer_payments as (

    select * from "dbttest1"."public"."customer_payments"

),

final as (

    select
        customers.customer_id,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders using (customer_id)

    left join customer_payments using (customer_id)

)

select * from final
  );
2020-11-09 16:28:31.123389 (Thread-1): SQL status: SELECT 100 in 0.00 seconds
2020-11-09 16:28:31.127918 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 16:28:31.128134 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbttest1"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
2020-11-09 16:28:31.131804 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 16:28:31.132968 (Thread-1): On model.jaffle_shop.dim_customers: COMMIT
2020-11-09 16:28:31.133097 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 16:28:31.133211 (Thread-1): On model.jaffle_shop.dim_customers: COMMIT
2020-11-09 16:28:31.135014 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 16:28:31.137302 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 16:28:31.137438 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "dbttest1"."public"."dim_customers__dbt_backup" cascade
2020-11-09 16:28:31.138647 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 16:28:31.141036 (Thread-1): finished collecting timing info
2020-11-09 16:28:31.141309 (Thread-1): On model.jaffle_shop.dim_customers: Close
2020-11-09 16:28:31.141951 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15bd9474-dbce-4e44-9c8e-c4c1bc005f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e899a0>]}
2020-11-09 16:28:31.143617 (Thread-1): 11:28:31 | 7 of 8 OK created table model public.dim_customers................... [SELECT 100 in 0.06s]
2020-11-09 16:28:31.143794 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2020-11-09 16:28:31.144007 (Thread-1): Began running node model.jaffle_shop.fct_orders
2020-11-09 16:28:31.145623 (Thread-1): 11:28:31 | 8 of 8 START table model public.fct_orders........................... [RUN]
2020-11-09 16:28:31.145982 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 16:28:31.146097 (Thread-1): Compiling model.jaffle_shop.fct_orders
2020-11-09 16:28:31.158769 (Thread-1): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2020-11-09 16:28:31.159188 (Thread-1): finished collecting timing info
2020-11-09 16:28:31.168449 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 16:28:31.168773 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "dbttest1"."public"."fct_orders__dbt_tmp" cascade
2020-11-09 16:28:31.168982 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 16:28:31.178608 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-11-09 16:28:31.181320 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 16:28:31.181491 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "dbttest1"."public"."fct_orders__dbt_backup" cascade
2020-11-09 16:28:31.182818 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 16:28:31.184987 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.fct_orders"
2020-11-09 16:28:31.186457 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 16:28:31.186683 (Thread-1): On model.jaffle_shop.fct_orders: BEGIN
2020-11-09 16:28:31.188153 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 16:28:31.188301 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 16:28:31.188382 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */


  create  table "dbttest1"."public"."fct_orders__dbt_tmp"
  as (
    

with orders as (

    select * from "dbttest1"."public"."stg_orders"

),

order_payments as (

    select * from "dbttest1"."public"."order_payments"

),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.status,

        order_payments.credit_card_amount,

        order_payments.coupon_amount,

        order_payments.bank_transfer_amount,

        order_payments.gift_card_amount,

        order_payments.total_amount as amount

    from orders

    left join order_payments using (order_id)

)

select * from final
  );
2020-11-09 16:28:31.195372 (Thread-1): SQL status: SELECT 99 in 0.01 seconds
2020-11-09 16:28:31.197878 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 16:28:31.198007 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbttest1"."public"."fct_orders__dbt_tmp" rename to "fct_orders"
2020-11-09 16:28:31.199582 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 16:28:31.200648 (Thread-1): On model.jaffle_shop.fct_orders: COMMIT
2020-11-09 16:28:31.200773 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 16:28:31.200851 (Thread-1): On model.jaffle_shop.fct_orders: COMMIT
2020-11-09 16:28:31.202830 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 16:28:31.204945 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 16:28:31.205070 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "dbttest1"."public"."fct_orders__dbt_backup" cascade
2020-11-09 16:28:31.206289 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 16:28:31.208794 (Thread-1): finished collecting timing info
2020-11-09 16:28:31.209223 (Thread-1): On model.jaffle_shop.fct_orders: Close
2020-11-09 16:28:31.209752 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15bd9474-dbce-4e44-9c8e-c4c1bc005f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ce0e20>]}
2020-11-09 16:28:31.211130 (Thread-1): 11:28:31 | 8 of 8 OK created table model public.fct_orders...................... [SELECT 99 in 0.06s]
2020-11-09 16:28:31.211320 (Thread-1): Finished running node model.jaffle_shop.fct_orders
2020-11-09 16:28:31.212299 (MainThread): Acquiring new postgres connection "master".
2020-11-09 16:28:31.212456 (MainThread): Using postgres connection "master".
2020-11-09 16:28:31.212535 (MainThread): On master: BEGIN
2020-11-09 16:28:31.212609 (MainThread): Opening a new connection, currently in state closed
2020-11-09 16:28:31.223452 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-11-09 16:28:31.223644 (MainThread): On master: COMMIT
2020-11-09 16:28:31.223758 (MainThread): Using postgres connection "master".
2020-11-09 16:28:31.223840 (MainThread): On master: COMMIT
2020-11-09 16:28:31.224909 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-11-09 16:28:31.225055 (MainThread): On master: Close
2020-11-09 16:28:31.225400 (MainThread): 11:28:31 | 
2020-11-09 16:28:31.225549 (MainThread): 11:28:31 | Finished running 3 view models, 5 table models in 0.71s.
2020-11-09 16:28:31.225689 (MainThread): Connection 'master' was properly closed.
2020-11-09 16:28:31.225783 (MainThread): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2020-11-09 16:28:31.258537 (MainThread): 
2020-11-09 16:28:31.258715 (MainThread): Completed successfully
2020-11-09 16:28:31.258826 (MainThread): 
Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
2020-11-09 16:28:31.259031 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d68f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d682e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d68f70>]}
2020-11-09 16:28:31.259276 (MainThread): Flushing usage events
2020-11-09 16:29:20.867418 (MainThread): Running with dbt=0.18.1
2020-11-09 16:29:20.939141 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=PosixPath('/tmp'), strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-09 16:29:20.939911 (MainThread): Tracking: tracking
2020-11-09 16:29:20.949733 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2b15e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2c3dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2d05b0>]}
2020-11-09 16:29:20.971146 (MainThread): Partial parsing not enabled
2020-11-09 16:29:20.972172 (MainThread): Parsing macros/catalog.sql
2020-11-09 16:29:20.976493 (MainThread): Parsing macros/relations.sql
2020-11-09 16:29:20.978069 (MainThread): Parsing macros/adapters.sql
2020-11-09 16:29:21.002379 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-11-09 16:29:21.005716 (MainThread): Parsing macros/core.sql
2020-11-09 16:29:21.009889 (MainThread): Parsing macros/materializations/helpers.sql
2020-11-09 16:29:21.020991 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-11-09 16:29:21.023219 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-11-09 16:29:21.042001 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-11-09 16:29:21.082440 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-11-09 16:29:21.105334 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-11-09 16:29:21.107828 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-11-09 16:29:21.114572 (MainThread): Parsing macros/materializations/common/merge.sql
2020-11-09 16:29:21.130168 (MainThread): Parsing macros/materializations/table/table.sql
2020-11-09 16:29:21.138522 (MainThread): Parsing macros/materializations/view/view.sql
2020-11-09 16:29:21.145842 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-11-09 16:29:21.151164 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-11-09 16:29:21.152180 (MainThread): Parsing macros/etc/query.sql
2020-11-09 16:29:21.153287 (MainThread): Parsing macros/etc/is_incremental.sql
2020-11-09 16:29:21.155003 (MainThread): Parsing macros/etc/datetime.sql
2020-11-09 16:29:21.164647 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-11-09 16:29:21.166767 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-11-09 16:29:21.168588 (MainThread): Parsing macros/adapters/common.sql
2020-11-09 16:29:21.218337 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-11-09 16:29:21.220845 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-11-09 16:29:21.222639 (MainThread): Parsing macros/schema_tests/unique.sql
2020-11-09 16:29:21.225172 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-11-09 16:29:21.233597 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2020-11-09 16:29:21.233783 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '18537c04-fa17-44e3-8bbe-38e9d84689e1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2b1f70>]}
2020-11-09 16:29:21.234283 (MainThread): Partial parsing not enabled
2020-11-09 16:29:21.272986 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 16:29:21.289507 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 16:29:21.296048 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:29:21.302905 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 16:29:21.311820 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 16:29:21.320376 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2020-11-09 16:29:21.327602 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 16:29:21.334995 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 16:29:21.825534 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 3 seed files, 0 sources
2020-11-09 16:29:21.827743 (MainThread): 
2020-11-09 16:29:21.828108 (MainThread): Acquiring new postgres connection "master".
2020-11-09 16:29:21.838293 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dbttest1".
2020-11-09 16:29:21.848123 (ThreadPoolExecutor-0_0): Using postgres connection "list_dbttest1".
2020-11-09 16:29:21.848262 (ThreadPoolExecutor-0_0): On list_dbttest1: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1"} */

    select distinct nspname from pg_namespace
  
2020-11-09 16:29:21.848350 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-09 16:29:21.857742 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2020-11-09 16:29:21.859981 (ThreadPoolExecutor-0_0): On list_dbttest1: Close
2020-11-09 16:29:21.894573 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dbttest1_public".
2020-11-09 16:29:21.899961 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2020-11-09 16:29:21.900072 (ThreadPoolExecutor-1_0): On list_dbttest1_public: BEGIN
2020-11-09 16:29:21.900319 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2020-11-09 16:29:21.908189 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2020-11-09 16:29:21.908343 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2020-11-09 16:29:21.908458 (ThreadPoolExecutor-1_0): On list_dbttest1_public: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1_public"} */
select
      'dbttest1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbttest1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-11-09 16:29:21.911392 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2020-11-09 16:29:21.919298 (ThreadPoolExecutor-1_0): On list_dbttest1_public: ROLLBACK
2020-11-09 16:29:21.920375 (ThreadPoolExecutor-1_0): On list_dbttest1_public: Close
2020-11-09 16:29:21.961812 (MainThread): Using postgres connection "master".
2020-11-09 16:29:21.961949 (MainThread): On master: BEGIN
2020-11-09 16:29:21.962036 (MainThread): Opening a new connection, currently in state init
2020-11-09 16:29:21.969875 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-11-09 16:29:21.970029 (MainThread): Using postgres connection "master".
2020-11-09 16:29:21.970114 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-11-09 16:29:21.977091 (MainThread): SQL status: SELECT 3 in 0.01 seconds
2020-11-09 16:29:21.980759 (MainThread): On master: ROLLBACK
2020-11-09 16:29:21.982238 (MainThread): Using postgres connection "master".
2020-11-09 16:29:21.982380 (MainThread): On master: BEGIN
2020-11-09 16:29:21.984983 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-11-09 16:29:21.985144 (MainThread): On master: COMMIT
2020-11-09 16:29:21.985239 (MainThread): Using postgres connection "master".
2020-11-09 16:29:21.985315 (MainThread): On master: COMMIT
2020-11-09 16:29:21.986458 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-11-09 16:29:21.986615 (MainThread): On master: Close
2020-11-09 16:29:21.986897 (MainThread): 11:29:21 | Concurrency: 1 threads (target='dev')
2020-11-09 16:29:21.987023 (MainThread): 11:29:21 | 
2020-11-09 16:29:21.989640 (Thread-1): Began running node model.jaffle_shop.stg_orders
2020-11-09 16:29:21.990646 (Thread-1): 11:29:21 | 1 of 8 START view model public.stg_orders............................ [RUN]
2020-11-09 16:29:21.991017 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:29:21.991174 (Thread-1): Compiling model.jaffle_shop.stg_orders
2020-11-09 16:29:22.012244 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2020-11-09 16:29:22.013204 (Thread-1): finished collecting timing info
2020-11-09 16:29:22.041636 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:29:22.041787 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbttest1"."public"."stg_orders__dbt_tmp" cascade
2020-11-09 16:29:22.041879 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 16:29:22.051318 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-11-09 16:29:22.053782 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:29:22.053892 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbttest1"."public"."stg_orders__dbt_backup" cascade
2020-11-09 16:29:22.055071 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-11-09 16:29:22.059297 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2020-11-09 16:29:22.059717 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:29:22.059811 (Thread-1): On model.jaffle_shop.stg_orders: BEGIN
2020-11-09 16:29:22.061389 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 16:29:22.061546 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:29:22.061636 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "dbttest1"."public"."stg_orders__dbt_tmp" as (
    with source as (
    select * from "dbttest1"."public"."raw_orders"

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from renamed
  );

2020-11-09 16:29:22.069306 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-11-09 16:29:22.081161 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:29:22.081309 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbttest1"."public"."stg_orders" rename to "stg_orders__dbt_backup"
2020-11-09 16:29:22.083683 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 16:29:22.086642 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:29:22.086792 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbttest1"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
2020-11-09 16:29:22.088357 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 16:29:22.096982 (Thread-1): On model.jaffle_shop.stg_orders: COMMIT
2020-11-09 16:29:22.097133 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:29:22.097220 (Thread-1): On model.jaffle_shop.stg_orders: COMMIT
2020-11-09 16:29:22.098544 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 16:29:22.101770 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:29:22.101885 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbttest1"."public"."stg_orders__dbt_backup" cascade
2020-11-09 16:29:22.104501 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-11-09 16:29:22.106781 (Thread-1): finished collecting timing info
2020-11-09 16:29:22.107046 (Thread-1): On model.jaffle_shop.stg_orders: Close
2020-11-09 16:29:22.107733 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18537c04-fa17-44e3-8bbe-38e9d84689e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8ed3d0>]}
2020-11-09 16:29:22.108831 (Thread-1): 11:29:22 | 1 of 8 OK created view model public.stg_orders....................... [CREATE VIEW in 0.12s]
2020-11-09 16:29:22.108980 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2020-11-09 16:29:22.109188 (Thread-1): Began running node model.jaffle_shop.stg_payments
2020-11-09 16:29:22.110840 (Thread-1): 11:29:22 | 2 of 8 START view model public.stg_payments.......................... [RUN]
2020-11-09 16:29:22.111545 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 16:29:22.111732 (Thread-1): Compiling model.jaffle_shop.stg_payments
2020-11-09 16:29:22.121422 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2020-11-09 16:29:22.121834 (Thread-1): finished collecting timing info
2020-11-09 16:29:22.129836 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 16:29:22.130219 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbttest1"."public"."stg_payments__dbt_tmp" cascade
2020-11-09 16:29:22.130406 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 16:29:22.140970 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-11-09 16:29:22.143538 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 16:29:22.143699 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbttest1"."public"."stg_payments__dbt_backup" cascade
2020-11-09 16:29:22.144772 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-11-09 16:29:22.145972 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2020-11-09 16:29:22.146486 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 16:29:22.146582 (Thread-1): On model.jaffle_shop.stg_payments: BEGIN
2020-11-09 16:29:22.147874 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 16:29:22.148007 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 16:29:22.148093 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "dbttest1"."public"."stg_payments__dbt_tmp" as (
    with source as (
    select * from "dbttest1"."public"."raw_payments"

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        --`amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed
  );

2020-11-09 16:29:22.152357 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-11-09 16:29:22.156156 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 16:29:22.156283 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbttest1"."public"."stg_payments" rename to "stg_payments__dbt_backup"
2020-11-09 16:29:22.158391 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 16:29:22.160921 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 16:29:22.161037 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbttest1"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
2020-11-09 16:29:22.162808 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 16:29:22.163910 (Thread-1): On model.jaffle_shop.stg_payments: COMMIT
2020-11-09 16:29:22.164019 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 16:29:22.164096 (Thread-1): On model.jaffle_shop.stg_payments: COMMIT
2020-11-09 16:29:22.165661 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 16:29:22.167706 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 16:29:22.167832 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbttest1"."public"."stg_payments__dbt_backup" cascade
2020-11-09 16:29:22.169699 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-11-09 16:29:22.171913 (Thread-1): finished collecting timing info
2020-11-09 16:29:22.172145 (Thread-1): On model.jaffle_shop.stg_payments: Close
2020-11-09 16:29:22.172623 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18537c04-fa17-44e3-8bbe-38e9d84689e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba7b460>]}
2020-11-09 16:29:22.173673 (Thread-1): 11:29:22 | 2 of 8 OK created view model public.stg_payments..................... [CREATE VIEW in 0.06s]
2020-11-09 16:29:22.173811 (Thread-1): Finished running node model.jaffle_shop.stg_payments
2020-11-09 16:29:22.173934 (Thread-1): Began running node model.jaffle_shop.stg_customers
2020-11-09 16:29:22.175041 (Thread-1): 11:29:22 | 3 of 8 START view model public.stg_customers......................... [RUN]
2020-11-09 16:29:22.175579 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 16:29:22.175705 (Thread-1): Compiling model.jaffle_shop.stg_customers
2020-11-09 16:29:22.186106 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2020-11-09 16:29:22.186522 (Thread-1): finished collecting timing info
2020-11-09 16:29:22.194467 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 16:29:22.194608 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbttest1"."public"."stg_customers__dbt_tmp" cascade
2020-11-09 16:29:22.194695 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 16:29:22.206441 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-11-09 16:29:22.209605 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 16:29:22.209763 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbttest1"."public"."stg_customers__dbt_backup" cascade
2020-11-09 16:29:22.211184 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-11-09 16:29:22.219752 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2020-11-09 16:29:22.221187 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 16:29:22.229147 (Thread-1): On model.jaffle_shop.stg_customers: BEGIN
2020-11-09 16:29:22.231359 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 16:29:22.231610 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 16:29:22.231818 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "dbttest1"."public"."stg_customers__dbt_tmp" as (
    with source as (
    select * from "dbttest1"."public"."raw_customers"

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name,
        email

    from source

)

select * from renamed
  );

2020-11-09 16:29:22.239693 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-11-09 16:29:22.243936 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 16:29:22.244101 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbttest1"."public"."stg_customers" rename to "stg_customers__dbt_backup"
2020-11-09 16:29:22.245930 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 16:29:22.248317 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 16:29:22.248424 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbttest1"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
2020-11-09 16:29:22.249839 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 16:29:22.250818 (Thread-1): On model.jaffle_shop.stg_customers: COMMIT
2020-11-09 16:29:22.250914 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 16:29:22.250987 (Thread-1): On model.jaffle_shop.stg_customers: COMMIT
2020-11-09 16:29:22.252158 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 16:29:22.253868 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 16:29:22.253963 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbttest1"."public"."stg_customers__dbt_backup" cascade
2020-11-09 16:29:22.255693 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-11-09 16:29:22.257865 (Thread-1): finished collecting timing info
2020-11-09 16:29:22.258110 (Thread-1): On model.jaffle_shop.stg_customers: Close
2020-11-09 16:29:22.258638 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18537c04-fa17-44e3-8bbe-38e9d84689e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7fb1f0>]}
2020-11-09 16:29:22.259664 (Thread-1): 11:29:22 | 3 of 8 OK created view model public.stg_customers.................... [CREATE VIEW in 0.08s]
2020-11-09 16:29:22.259824 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2020-11-09 16:29:22.259948 (Thread-1): Began running node model.jaffle_shop.customer_orders
2020-11-09 16:29:22.260967 (Thread-1): 11:29:22 | 4 of 8 START table model public.customer_orders...................... [RUN]
2020-11-09 16:29:22.261269 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 16:29:22.261428 (Thread-1): Compiling model.jaffle_shop.customer_orders
2020-11-09 16:29:22.270375 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customer_orders"
2020-11-09 16:29:22.270802 (Thread-1): finished collecting timing info
2020-11-09 16:29:22.291977 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 16:29:22.292121 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
drop table if exists "dbttest1"."public"."customer_orders__dbt_tmp" cascade
2020-11-09 16:29:22.292211 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 16:29:22.300423 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-11-09 16:29:22.303238 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 16:29:22.303359 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
drop table if exists "dbttest1"."public"."customer_orders__dbt_backup" cascade
2020-11-09 16:29:22.304347 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 16:29:22.310538 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customer_orders"
2020-11-09 16:29:22.310962 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 16:29:22.311051 (Thread-1): On model.jaffle_shop.customer_orders: BEGIN
2020-11-09 16:29:22.312623 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 16:29:22.312749 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 16:29:22.312828 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */


  create  table "dbttest1"."public"."customer_orders__dbt_tmp"
  as (
    with orders as (

    select * from "dbttest1"."public"."stg_orders"

),

final as (

    select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by 1

)

select * from final
  );
2020-11-09 16:29:22.315738 (Thread-1): SQL status: SELECT 62 in 0.00 seconds
2020-11-09 16:29:22.319493 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 16:29:22.319618 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
alter table "dbttest1"."public"."customer_orders" rename to "customer_orders__dbt_backup"
2020-11-09 16:29:22.321039 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 16:29:22.323888 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 16:29:22.324009 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
alter table "dbttest1"."public"."customer_orders__dbt_tmp" rename to "customer_orders"
2020-11-09 16:29:22.325980 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 16:29:22.327026 (Thread-1): On model.jaffle_shop.customer_orders: COMMIT
2020-11-09 16:29:22.327140 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 16:29:22.327884 (Thread-1): On model.jaffle_shop.customer_orders: COMMIT
2020-11-09 16:29:22.329349 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 16:29:22.331181 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 16:29:22.331289 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
drop table if exists "dbttest1"."public"."customer_orders__dbt_backup" cascade
2020-11-09 16:29:22.335197 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 16:29:22.337430 (Thread-1): finished collecting timing info
2020-11-09 16:29:22.337695 (Thread-1): On model.jaffle_shop.customer_orders: Close
2020-11-09 16:29:22.338742 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18537c04-fa17-44e3-8bbe-38e9d84689e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba5b250>]}
2020-11-09 16:29:22.339764 (Thread-1): 11:29:22 | 4 of 8 OK created table model public.customer_orders................. [SELECT 62 in 0.08s]
2020-11-09 16:29:22.339911 (Thread-1): Finished running node model.jaffle_shop.customer_orders
2020-11-09 16:29:22.340049 (Thread-1): Began running node model.jaffle_shop.customer_payments
2020-11-09 16:29:22.341467 (Thread-1): 11:29:22 | 5 of 8 START table model public.customer_payments.................... [RUN]
2020-11-09 16:29:22.341763 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 16:29:22.341872 (Thread-1): Compiling model.jaffle_shop.customer_payments
2020-11-09 16:29:22.350526 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customer_payments"
2020-11-09 16:29:22.351028 (Thread-1): finished collecting timing info
2020-11-09 16:29:22.358776 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 16:29:22.358995 (Thread-1): On model.jaffle_shop.customer_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_payments"} */
drop table if exists "dbttest1"."public"."customer_payments__dbt_tmp" cascade
2020-11-09 16:29:22.359148 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 16:29:22.370385 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-11-09 16:29:22.373176 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 16:29:22.373316 (Thread-1): On model.jaffle_shop.customer_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_payments"} */
drop table if exists "dbttest1"."public"."customer_payments__dbt_backup" cascade
2020-11-09 16:29:22.374318 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 16:29:22.375474 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customer_payments"
2020-11-09 16:29:22.375886 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 16:29:22.375976 (Thread-1): On model.jaffle_shop.customer_payments: BEGIN
2020-11-09 16:29:22.377872 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 16:29:22.378061 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 16:29:22.378142 (Thread-1): On model.jaffle_shop.customer_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_payments"} */


  create  table "dbttest1"."public"."customer_payments__dbt_tmp"
  as (
    with payments as (

    select * from "dbttest1"."public"."stg_payments"

),

orders as (

    select * from "dbttest1"."public"."stg_orders"

),

final as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders using (order_id)

    group by 1

)

select * from final
  );
2020-11-09 16:29:22.381954 (Thread-1): SQL status: SELECT 62 in 0.00 seconds
2020-11-09 16:29:22.385483 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 16:29:22.385587 (Thread-1): On model.jaffle_shop.customer_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_payments"} */
alter table "dbttest1"."public"."customer_payments" rename to "customer_payments__dbt_backup"
2020-11-09 16:29:22.386975 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 16:29:22.389238 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 16:29:22.389363 (Thread-1): On model.jaffle_shop.customer_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_payments"} */
alter table "dbttest1"."public"."customer_payments__dbt_tmp" rename to "customer_payments"
2020-11-09 16:29:22.391260 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 16:29:22.392358 (Thread-1): On model.jaffle_shop.customer_payments: COMMIT
2020-11-09 16:29:22.392474 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 16:29:22.392550 (Thread-1): On model.jaffle_shop.customer_payments: COMMIT
2020-11-09 16:29:22.393941 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 16:29:22.395916 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 16:29:22.396047 (Thread-1): On model.jaffle_shop.customer_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_payments"} */
drop table if exists "dbttest1"."public"."customer_payments__dbt_backup" cascade
2020-11-09 16:29:22.397785 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 16:29:22.399965 (Thread-1): finished collecting timing info
2020-11-09 16:29:22.400199 (Thread-1): On model.jaffle_shop.customer_payments: Close
2020-11-09 16:29:22.400892 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18537c04-fa17-44e3-8bbe-38e9d84689e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6f8190>]}
2020-11-09 16:29:22.401837 (Thread-1): 11:29:22 | 5 of 8 OK created table model public.customer_payments............... [SELECT 62 in 0.06s]
2020-11-09 16:29:22.401972 (Thread-1): Finished running node model.jaffle_shop.customer_payments
2020-11-09 16:29:22.402178 (Thread-1): Began running node model.jaffle_shop.order_payments
2020-11-09 16:29:22.403389 (Thread-1): 11:29:22 | 6 of 8 START table model public.order_payments....................... [RUN]
2020-11-09 16:29:22.403911 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2020-11-09 16:29:22.404042 (Thread-1): Compiling model.jaffle_shop.order_payments
2020-11-09 16:29:22.411889 (Thread-1): Writing injected SQL for node "model.jaffle_shop.order_payments"
2020-11-09 16:29:22.412260 (Thread-1): finished collecting timing info
2020-11-09 16:29:22.419263 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 16:29:22.419400 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */
drop table if exists "dbttest1"."public"."order_payments__dbt_tmp" cascade
2020-11-09 16:29:22.419484 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 16:29:22.427808 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-11-09 16:29:22.431116 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 16:29:22.431230 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */
drop table if exists "dbttest1"."public"."order_payments__dbt_backup" cascade
2020-11-09 16:29:22.432435 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 16:29:22.433608 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.order_payments"
2020-11-09 16:29:22.434022 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 16:29:22.434107 (Thread-1): On model.jaffle_shop.order_payments: BEGIN
2020-11-09 16:29:22.435465 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 16:29:22.435589 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 16:29:22.435665 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */


  create  table "dbttest1"."public"."order_payments__dbt_tmp"
  as (
    

with payments as (

    select * from "dbttest1"."public"."stg_payments"

),

final as (

    select
        order_id,

        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,
        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,
        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,
        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,
        sum(amount) as total_amount

    from payments

    group by 1

)

select * from final
  );
2020-11-09 16:29:22.439463 (Thread-1): SQL status: SELECT 99 in 0.00 seconds
2020-11-09 16:29:22.443392 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 16:29:22.443523 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */
alter table "dbttest1"."public"."order_payments" rename to "order_payments__dbt_backup"
2020-11-09 16:29:22.445198 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 16:29:22.447484 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 16:29:22.447608 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */
alter table "dbttest1"."public"."order_payments__dbt_tmp" rename to "order_payments"
2020-11-09 16:29:22.448725 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 16:29:22.449907 (Thread-1): On model.jaffle_shop.order_payments: COMMIT
2020-11-09 16:29:22.450029 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 16:29:22.450111 (Thread-1): On model.jaffle_shop.order_payments: COMMIT
2020-11-09 16:29:22.452955 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 16:29:22.454719 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 16:29:22.454820 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */
drop table if exists "dbttest1"."public"."order_payments__dbt_backup" cascade
2020-11-09 16:29:22.457943 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 16:29:22.460134 (Thread-1): finished collecting timing info
2020-11-09 16:29:22.460357 (Thread-1): On model.jaffle_shop.order_payments: Close
2020-11-09 16:29:22.461071 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18537c04-fa17-44e3-8bbe-38e9d84689e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7d2850>]}
2020-11-09 16:29:22.462075 (Thread-1): 11:29:22 | 6 of 8 OK created table model public.order_payments.................. [SELECT 99 in 0.06s]
2020-11-09 16:29:22.462211 (Thread-1): Finished running node model.jaffle_shop.order_payments
2020-11-09 16:29:22.462418 (Thread-1): Began running node model.jaffle_shop.dim_customers
2020-11-09 16:29:22.463530 (Thread-1): 11:29:22 | 7 of 8 START table model public.dim_customers........................ [RUN]
2020-11-09 16:29:22.464192 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 16:29:22.464316 (Thread-1): Compiling model.jaffle_shop.dim_customers
2020-11-09 16:29:22.476700 (Thread-1): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2020-11-09 16:29:22.477290 (Thread-1): finished collecting timing info
2020-11-09 16:29:22.486317 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 16:29:22.486452 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "dbttest1"."public"."dim_customers__dbt_tmp" cascade
2020-11-09 16:29:22.486532 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 16:29:22.498410 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-11-09 16:29:22.502012 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 16:29:22.502144 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "dbttest1"."public"."dim_customers__dbt_backup" cascade
2020-11-09 16:29:22.503463 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 16:29:22.504569 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2020-11-09 16:29:22.504978 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 16:29:22.505064 (Thread-1): On model.jaffle_shop.dim_customers: BEGIN
2020-11-09 16:29:22.506434 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 16:29:22.506592 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 16:29:22.506691 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */


  create  table "dbttest1"."public"."dim_customers__dbt_tmp"
  as (
    with customers as (

    select * from "dbttest1"."public"."stg_customers"

),

customer_orders as (

    select * from "dbttest1"."public"."customer_orders"

),

customer_payments as (

    select * from "dbttest1"."public"."customer_payments"

),

final as (

    select
        customers.customer_id,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders using (customer_id)

    left join customer_payments using (customer_id)

)

select * from final
  );
2020-11-09 16:29:22.511614 (Thread-1): SQL status: SELECT 100 in 0.00 seconds
2020-11-09 16:29:22.515698 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 16:29:22.515910 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbttest1"."public"."dim_customers" rename to "dim_customers__dbt_backup"
2020-11-09 16:29:22.517355 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 16:29:22.519646 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 16:29:22.519814 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbttest1"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
2020-11-09 16:29:22.521129 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 16:29:22.522347 (Thread-1): On model.jaffle_shop.dim_customers: COMMIT
2020-11-09 16:29:22.522502 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 16:29:22.522627 (Thread-1): On model.jaffle_shop.dim_customers: COMMIT
2020-11-09 16:29:22.524653 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 16:29:22.526490 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 16:29:22.526615 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "dbttest1"."public"."dim_customers__dbt_backup" cascade
2020-11-09 16:29:22.528444 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 16:29:22.530690 (Thread-1): finished collecting timing info
2020-11-09 16:29:22.530942 (Thread-1): On model.jaffle_shop.dim_customers: Close
2020-11-09 16:29:22.531568 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18537c04-fa17-44e3-8bbe-38e9d84689e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6f8190>]}
2020-11-09 16:29:22.532787 (Thread-1): 11:29:22 | 7 of 8 OK created table model public.dim_customers................... [SELECT 100 in 0.07s]
2020-11-09 16:29:22.533006 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2020-11-09 16:29:22.533220 (Thread-1): Began running node model.jaffle_shop.fct_orders
2020-11-09 16:29:22.534560 (Thread-1): 11:29:22 | 8 of 8 START table model public.fct_orders........................... [RUN]
2020-11-09 16:29:22.534993 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 16:29:22.535125 (Thread-1): Compiling model.jaffle_shop.fct_orders
2020-11-09 16:29:22.549143 (Thread-1): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2020-11-09 16:29:22.549649 (Thread-1): finished collecting timing info
2020-11-09 16:29:22.557198 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 16:29:22.557328 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "dbttest1"."public"."fct_orders__dbt_tmp" cascade
2020-11-09 16:29:22.557411 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 16:29:22.571285 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-11-09 16:29:22.578563 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 16:29:22.578758 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "dbttest1"."public"."fct_orders__dbt_backup" cascade
2020-11-09 16:29:22.581361 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 16:29:22.584568 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.fct_orders"
2020-11-09 16:29:22.585159 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 16:29:22.585335 (Thread-1): On model.jaffle_shop.fct_orders: BEGIN
2020-11-09 16:29:22.586930 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 16:29:22.587100 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 16:29:22.587247 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */


  create  table "dbttest1"."public"."fct_orders__dbt_tmp"
  as (
    

with orders as (

    select * from "dbttest1"."public"."stg_orders"

),

order_payments as (

    select * from "dbttest1"."public"."order_payments"

),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.status,

        order_payments.credit_card_amount,

        order_payments.coupon_amount,

        order_payments.bank_transfer_amount,

        order_payments.gift_card_amount,

        order_payments.total_amount as amount

    from orders

    left join order_payments using (order_id)

)

select * from final
  );
2020-11-09 16:29:22.592705 (Thread-1): SQL status: SELECT 99 in 0.01 seconds
2020-11-09 16:29:22.599189 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 16:29:22.599332 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbttest1"."public"."fct_orders" rename to "fct_orders__dbt_backup"
2020-11-09 16:29:22.601040 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 16:29:22.603694 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 16:29:22.603853 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbttest1"."public"."fct_orders__dbt_tmp" rename to "fct_orders"
2020-11-09 16:29:22.605609 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 16:29:22.607011 (Thread-1): On model.jaffle_shop.fct_orders: COMMIT
2020-11-09 16:29:22.607134 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 16:29:22.607244 (Thread-1): On model.jaffle_shop.fct_orders: COMMIT
2020-11-09 16:29:22.608674 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 16:29:22.611049 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 16:29:22.611269 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "dbttest1"."public"."fct_orders__dbt_backup" cascade
2020-11-09 16:29:22.615245 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 16:29:22.618035 (Thread-1): finished collecting timing info
2020-11-09 16:29:22.618353 (Thread-1): On model.jaffle_shop.fct_orders: Close
2020-11-09 16:29:22.619144 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18537c04-fa17-44e3-8bbe-38e9d84689e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b987820>]}
2020-11-09 16:29:22.620264 (Thread-1): 11:29:22 | 8 of 8 OK created table model public.fct_orders...................... [SELECT 99 in 0.08s]
2020-11-09 16:29:22.620417 (Thread-1): Finished running node model.jaffle_shop.fct_orders
2020-11-09 16:29:22.621742 (MainThread): Acquiring new postgres connection "master".
2020-11-09 16:29:22.621977 (MainThread): Using postgres connection "master".
2020-11-09 16:29:22.622139 (MainThread): On master: BEGIN
2020-11-09 16:29:22.622290 (MainThread): Opening a new connection, currently in state closed
2020-11-09 16:29:22.631599 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-11-09 16:29:22.631795 (MainThread): On master: COMMIT
2020-11-09 16:29:22.631908 (MainThread): Using postgres connection "master".
2020-11-09 16:29:22.631984 (MainThread): On master: COMMIT
2020-11-09 16:29:22.633478 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-11-09 16:29:22.633693 (MainThread): On master: Close
2020-11-09 16:29:22.634133 (MainThread): 11:29:22 | 
2020-11-09 16:29:22.634337 (MainThread): 11:29:22 | Finished running 3 view models, 5 table models in 0.81s.
2020-11-09 16:29:22.634474 (MainThread): Connection 'master' was properly closed.
2020-11-09 16:29:22.634651 (MainThread): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2020-11-09 16:29:22.658489 (MainThread): 
2020-11-09 16:29:22.658743 (MainThread): Completed successfully
2020-11-09 16:29:22.658925 (MainThread): 
Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
2020-11-09 16:29:22.659157 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7fba60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b85e7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b85ea60>]}
2020-11-09 16:29:22.659378 (MainThread): Flushing usage events
2020-11-09 16:29:33.768787 (MainThread): Running with dbt=0.18.1
2020-11-09 16:29:33.869812 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['stg_orders'], partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=PosixPath('/tmp'), strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-09 16:29:33.870551 (MainThread): Tracking: tracking
2020-11-09 16:29:33.884415 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca8ae20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca9de80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10caa89d0>]}
2020-11-09 16:29:33.918653 (MainThread): Partial parsing not enabled
2020-11-09 16:29:33.920122 (MainThread): Parsing macros/catalog.sql
2020-11-09 16:29:33.925441 (MainThread): Parsing macros/relations.sql
2020-11-09 16:29:33.928222 (MainThread): Parsing macros/adapters.sql
2020-11-09 16:29:33.960956 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-11-09 16:29:33.964933 (MainThread): Parsing macros/core.sql
2020-11-09 16:29:33.970636 (MainThread): Parsing macros/materializations/helpers.sql
2020-11-09 16:29:33.986155 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-11-09 16:29:33.989322 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-11-09 16:29:34.019780 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-11-09 16:29:34.065874 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-11-09 16:29:34.098641 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-11-09 16:29:34.102729 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-11-09 16:29:34.114660 (MainThread): Parsing macros/materializations/common/merge.sql
2020-11-09 16:29:34.135628 (MainThread): Parsing macros/materializations/table/table.sql
2020-11-09 16:29:34.147112 (MainThread): Parsing macros/materializations/view/view.sql
2020-11-09 16:29:34.157522 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-11-09 16:29:34.165127 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-11-09 16:29:34.166245 (MainThread): Parsing macros/etc/query.sql
2020-11-09 16:29:34.167418 (MainThread): Parsing macros/etc/is_incremental.sql
2020-11-09 16:29:34.169618 (MainThread): Parsing macros/etc/datetime.sql
2020-11-09 16:29:34.184066 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-11-09 16:29:34.187431 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-11-09 16:29:34.190082 (MainThread): Parsing macros/adapters/common.sql
2020-11-09 16:29:34.251444 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-11-09 16:29:34.254328 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-11-09 16:29:34.256653 (MainThread): Parsing macros/schema_tests/unique.sql
2020-11-09 16:29:34.259396 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-11-09 16:29:34.272259 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2020-11-09 16:29:34.272792 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '248683ed-9e04-4638-9a83-ee7f0a4e51a0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb1a460>]}
2020-11-09 16:29:34.274074 (MainThread): Partial parsing not enabled
2020-11-09 16:29:34.358469 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 16:29:34.400563 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 16:29:34.410208 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:29:34.427084 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 16:29:34.446816 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 16:29:34.464086 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2020-11-09 16:29:34.478448 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 16:29:34.494412 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 16:29:35.278254 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 3 seed files, 0 sources
2020-11-09 16:29:35.281949 (MainThread): 
2020-11-09 16:29:35.282424 (MainThread): Acquiring new postgres connection "master".
2020-11-09 16:29:35.284192 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dbttest1".
2020-11-09 16:29:35.300142 (ThreadPoolExecutor-0_0): Using postgres connection "list_dbttest1".
2020-11-09 16:29:35.300361 (ThreadPoolExecutor-0_0): On list_dbttest1: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1"} */

    select distinct nspname from pg_namespace
  
2020-11-09 16:29:35.300584 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-09 16:29:35.310570 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2020-11-09 16:29:35.313771 (ThreadPoolExecutor-0_0): On list_dbttest1: Close
2020-11-09 16:29:35.366201 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dbttest1_public".
2020-11-09 16:29:35.374278 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2020-11-09 16:29:35.374442 (ThreadPoolExecutor-1_0): On list_dbttest1_public: BEGIN
2020-11-09 16:29:35.374572 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2020-11-09 16:29:35.382802 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2020-11-09 16:29:35.383017 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2020-11-09 16:29:35.383147 (ThreadPoolExecutor-1_0): On list_dbttest1_public: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1_public"} */
select
      'dbttest1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbttest1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-11-09 16:29:35.386604 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2020-11-09 16:29:35.398549 (ThreadPoolExecutor-1_0): On list_dbttest1_public: ROLLBACK
2020-11-09 16:29:35.399869 (ThreadPoolExecutor-1_0): On list_dbttest1_public: Close
2020-11-09 16:29:35.454619 (MainThread): Using postgres connection "master".
2020-11-09 16:29:35.454814 (MainThread): On master: BEGIN
2020-11-09 16:29:35.454925 (MainThread): Opening a new connection, currently in state init
2020-11-09 16:29:35.464233 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-11-09 16:29:35.464419 (MainThread): Using postgres connection "master".
2020-11-09 16:29:35.464528 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-11-09 16:29:35.471375 (MainThread): SQL status: SELECT 3 in 0.01 seconds
2020-11-09 16:29:35.476141 (MainThread): On master: ROLLBACK
2020-11-09 16:29:35.477312 (MainThread): Using postgres connection "master".
2020-11-09 16:29:35.477443 (MainThread): On master: BEGIN
2020-11-09 16:29:35.479594 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-11-09 16:29:35.479768 (MainThread): On master: COMMIT
2020-11-09 16:29:35.479867 (MainThread): Using postgres connection "master".
2020-11-09 16:29:35.479953 (MainThread): On master: COMMIT
2020-11-09 16:29:35.481288 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-11-09 16:29:35.481507 (MainThread): On master: Close
2020-11-09 16:29:35.481874 (MainThread): 11:29:35 | Concurrency: 1 threads (target='dev')
2020-11-09 16:29:35.482079 (MainThread): 11:29:35 | 
2020-11-09 16:29:35.485419 (Thread-1): Began running node model.jaffle_shop.stg_orders
2020-11-09 16:29:35.486717 (Thread-1): 11:29:35 | 1 of 1 START view model public.stg_orders............................ [RUN]
2020-11-09 16:29:35.487178 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:29:35.487315 (Thread-1): Compiling model.jaffle_shop.stg_orders
2020-11-09 16:29:35.514045 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2020-11-09 16:29:35.514519 (Thread-1): finished collecting timing info
2020-11-09 16:29:35.551713 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:29:35.551868 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbttest1"."public"."stg_orders__dbt_tmp" cascade
2020-11-09 16:29:35.551959 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 16:29:35.561621 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-11-09 16:29:35.564270 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:29:35.564402 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbttest1"."public"."stg_orders__dbt_backup" cascade
2020-11-09 16:29:35.565513 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-11-09 16:29:35.570577 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2020-11-09 16:29:35.571017 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:29:35.571119 (Thread-1): On model.jaffle_shop.stg_orders: BEGIN
2020-11-09 16:29:35.572332 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 16:29:35.572482 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:29:35.572594 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "dbttest1"."public"."stg_orders__dbt_tmp" as (
    with source as (
    select * from "dbttest1"."public"."raw_orders"

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from renamed
  );

2020-11-09 16:29:35.575207 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-11-09 16:29:35.586932 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:29:35.587113 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbttest1"."public"."stg_orders" rename to "stg_orders__dbt_backup"
2020-11-09 16:29:35.590078 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 16:29:35.594061 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:29:35.594201 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbttest1"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
2020-11-09 16:29:35.595775 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 16:29:35.604611 (Thread-1): On model.jaffle_shop.stg_orders: COMMIT
2020-11-09 16:29:35.604789 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:29:35.604878 (Thread-1): On model.jaffle_shop.stg_orders: COMMIT
2020-11-09 16:29:35.606348 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 16:29:35.610269 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:29:35.610415 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbttest1"."public"."stg_orders__dbt_backup" cascade
2020-11-09 16:29:35.612619 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-11-09 16:29:35.615672 (Thread-1): finished collecting timing info
2020-11-09 16:29:35.615966 (Thread-1): On model.jaffle_shop.stg_orders: Close
2020-11-09 16:29:35.616813 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '248683ed-9e04-4638-9a83-ee7f0a4e51a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdff970>]}
2020-11-09 16:29:35.617974 (Thread-1): 11:29:35 | 1 of 1 OK created view model public.stg_orders....................... [CREATE VIEW in 0.13s]
2020-11-09 16:29:35.618125 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2020-11-09 16:29:35.619296 (MainThread): Acquiring new postgres connection "master".
2020-11-09 16:29:35.619556 (MainThread): Using postgres connection "master".
2020-11-09 16:29:35.619685 (MainThread): On master: BEGIN
2020-11-09 16:29:35.619813 (MainThread): Opening a new connection, currently in state closed
2020-11-09 16:29:35.629393 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-11-09 16:29:35.629656 (MainThread): On master: COMMIT
2020-11-09 16:29:35.629770 (MainThread): Using postgres connection "master".
2020-11-09 16:29:35.629861 (MainThread): On master: COMMIT
2020-11-09 16:29:35.631326 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-11-09 16:29:35.631580 (MainThread): On master: Close
2020-11-09 16:29:35.632002 (MainThread): 11:29:35 | 
2020-11-09 16:29:35.632237 (MainThread): 11:29:35 | Finished running 1 view model in 0.35s.
2020-11-09 16:29:35.632547 (MainThread): Connection 'master' was properly closed.
2020-11-09 16:29:35.632811 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2020-11-09 16:29:35.637937 (MainThread): 
2020-11-09 16:29:35.638238 (MainThread): Completed successfully
2020-11-09 16:29:35.638389 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-11-09 16:29:35.638627 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc39460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccb8760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccb8c10>]}
2020-11-09 16:29:35.638917 (MainThread): Flushing usage events
2020-11-09 16:29:44.059586 (MainThread): Running with dbt=0.18.1
2020-11-09 16:29:44.222831 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['stg_orders,', 'state:modified'], partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=PosixPath('/tmp'), strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-09 16:29:44.223836 (MainThread): Tracking: tracking
2020-11-09 16:29:44.241002 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a922370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a955df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a95f940>]}
2020-11-09 16:29:44.287364 (MainThread): Partial parsing not enabled
2020-11-09 16:29:44.289025 (MainThread): Parsing macros/catalog.sql
2020-11-09 16:29:44.294662 (MainThread): Parsing macros/relations.sql
2020-11-09 16:29:44.297726 (MainThread): Parsing macros/adapters.sql
2020-11-09 16:29:44.341413 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-11-09 16:29:44.346094 (MainThread): Parsing macros/core.sql
2020-11-09 16:29:44.352806 (MainThread): Parsing macros/materializations/helpers.sql
2020-11-09 16:29:44.368885 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-11-09 16:29:44.372222 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-11-09 16:29:44.410199 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-11-09 16:29:44.471395 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-11-09 16:29:44.515831 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-11-09 16:29:44.520639 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-11-09 16:29:44.535494 (MainThread): Parsing macros/materializations/common/merge.sql
2020-11-09 16:29:44.569676 (MainThread): Parsing macros/materializations/table/table.sql
2020-11-09 16:29:44.588924 (MainThread): Parsing macros/materializations/view/view.sql
2020-11-09 16:29:44.605683 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-11-09 16:29:44.622934 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-11-09 16:29:44.625948 (MainThread): Parsing macros/etc/query.sql
2020-11-09 16:29:44.631983 (MainThread): Parsing macros/etc/is_incremental.sql
2020-11-09 16:29:44.636558 (MainThread): Parsing macros/etc/datetime.sql
2020-11-09 16:29:44.658903 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-11-09 16:29:44.663096 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-11-09 16:29:44.665280 (MainThread): Parsing macros/adapters/common.sql
2020-11-09 16:29:44.747075 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-11-09 16:29:44.749528 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-11-09 16:29:44.751419 (MainThread): Parsing macros/schema_tests/unique.sql
2020-11-09 16:29:44.754311 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-11-09 16:29:44.770707 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2020-11-09 16:29:44.771137 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f6d5db0f-9f14-4886-b660-a2e82191462d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a922eb0>]}
2020-11-09 16:29:44.772239 (MainThread): Partial parsing not enabled
2020-11-09 16:29:44.850838 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 16:29:44.889532 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 16:29:44.899030 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:29:44.908642 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 16:29:44.921319 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 16:29:44.932335 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2020-11-09 16:29:44.942021 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 16:29:44.950644 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 16:29:45.658882 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 3 seed files, 0 sources
2020-11-09 16:29:45.660134 (MainThread): The selector 'stg_orders,' does not match any nodes and will be ignored
2020-11-09 16:29:45.660600 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acb7310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acb7250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acb73d0>]}
2020-11-09 16:29:45.660911 (MainThread): Flushing usage events
2020-11-09 16:29:45.791768 (MainThread): Connection 'model.jaffle_shop.customer_orders' was properly closed.
2020-11-09 16:29:45.792043 (MainThread): Encountered an error:
2020-11-09 16:29:45.792187 (MainThread): Runtime Error
  Got a state selector method, but no comparison manifest
2020-11-09 16:29:45.793690 (MainThread): Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/main.py", line 255, in run_from_args
    results = task.run()
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/runnable.py", line 399, in run
    self._runtime_initialize()
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/runnable.py", line 124, in _runtime_initialize
    self.job_queue = self.get_graph_queue()
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/runnable.py", line 115, in get_graph_queue
    return selector.get_graph_queue(spec)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 189, in get_graph_queue
    selected_nodes = self.get_selected(spec)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 181, in get_selected
    selected_nodes = self.select_nodes(spec)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 119, in select_nodes
    node_selections = [
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 120, in <listcomp>
    self.select_nodes(component)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 119, in select_nodes
    node_selections = [
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 120, in <listcomp>
    self.select_nodes(component)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 119, in select_nodes
    node_selections = [
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 120, in <listcomp>
    self.select_nodes(component)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 117, in select_nodes
    result = self.get_nodes_from_criteria(spec)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 75, in get_nodes_from_criteria
    collected = self.select_included(nodes, spec)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 60, in select_included
    return set(method.search(included_nodes, spec.value))
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector_methods.py", line 460, in search
    raise RuntimeException(
dbt.exceptions.RuntimeException: Runtime Error
  Got a state selector method, but no comparison manifest

2020-11-09 16:30:00.990407 (MainThread): Running with dbt=0.18.1
2020-11-09 16:30:01.166935 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['state:modified'], partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=PosixPath('/tmp'), strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-09 16:30:01.167985 (MainThread): Tracking: tracking
2020-11-09 16:30:01.183915 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab3e760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab51d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab5e520>]}
2020-11-09 16:30:01.236994 (MainThread): Partial parsing not enabled
2020-11-09 16:30:01.239642 (MainThread): Parsing macros/catalog.sql
2020-11-09 16:30:01.246545 (MainThread): Parsing macros/relations.sql
2020-11-09 16:30:01.249251 (MainThread): Parsing macros/adapters.sql
2020-11-09 16:30:01.294744 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-11-09 16:30:01.300528 (MainThread): Parsing macros/core.sql
2020-11-09 16:30:01.305954 (MainThread): Parsing macros/materializations/helpers.sql
2020-11-09 16:30:01.319679 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-11-09 16:30:01.323878 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-11-09 16:30:01.357321 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-11-09 16:30:01.410641 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-11-09 16:30:01.456220 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-11-09 16:30:01.460834 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-11-09 16:30:01.472275 (MainThread): Parsing macros/materializations/common/merge.sql
2020-11-09 16:30:01.503194 (MainThread): Parsing macros/materializations/table/table.sql
2020-11-09 16:30:01.516873 (MainThread): Parsing macros/materializations/view/view.sql
2020-11-09 16:30:01.529241 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-11-09 16:30:01.540281 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-11-09 16:30:01.542941 (MainThread): Parsing macros/etc/query.sql
2020-11-09 16:30:01.546170 (MainThread): Parsing macros/etc/is_incremental.sql
2020-11-09 16:30:01.550645 (MainThread): Parsing macros/etc/datetime.sql
2020-11-09 16:30:01.566046 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-11-09 16:30:01.569686 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-11-09 16:30:01.572769 (MainThread): Parsing macros/adapters/common.sql
2020-11-09 16:30:01.661521 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-11-09 16:30:01.664266 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-11-09 16:30:01.666488 (MainThread): Parsing macros/schema_tests/unique.sql
2020-11-09 16:30:01.669076 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-11-09 16:30:01.679922 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2020-11-09 16:30:01.680142 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5723d6fa-b522-49e3-922c-21954aa21d1f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a770eb0>]}
2020-11-09 16:30:01.680901 (MainThread): Partial parsing not enabled
2020-11-09 16:30:01.744573 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 16:30:01.770971 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 16:30:01.780687 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:30:01.793226 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 16:30:01.807249 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 16:30:01.820020 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2020-11-09 16:30:01.832849 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 16:30:01.847536 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 16:30:02.643852 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 3 seed files, 0 sources
2020-11-09 16:30:02.644914 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aeba2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aebab80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aebafd0>]}
2020-11-09 16:30:02.645377 (MainThread): Flushing usage events
2020-11-09 16:30:02.781992 (MainThread): Connection 'model.jaffle_shop.customer_orders' was properly closed.
2020-11-09 16:30:02.782224 (MainThread): Encountered an error:
2020-11-09 16:30:02.782386 (MainThread): Runtime Error
  Got a state selector method, but no comparison manifest
2020-11-09 16:30:02.784286 (MainThread): Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/main.py", line 255, in run_from_args
    results = task.run()
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/runnable.py", line 399, in run
    self._runtime_initialize()
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/runnable.py", line 124, in _runtime_initialize
    self.job_queue = self.get_graph_queue()
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/runnable.py", line 115, in get_graph_queue
    return selector.get_graph_queue(spec)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 189, in get_graph_queue
    selected_nodes = self.get_selected(spec)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 181, in get_selected
    selected_nodes = self.select_nodes(spec)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 119, in select_nodes
    node_selections = [
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 120, in <listcomp>
    self.select_nodes(component)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 119, in select_nodes
    node_selections = [
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 120, in <listcomp>
    self.select_nodes(component)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 119, in select_nodes
    node_selections = [
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 120, in <listcomp>
    self.select_nodes(component)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 117, in select_nodes
    result = self.get_nodes_from_criteria(spec)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 75, in get_nodes_from_criteria
    collected = self.select_included(nodes, spec)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 60, in select_included
    return set(method.search(included_nodes, spec.value))
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector_methods.py", line 460, in search
    raise RuntimeException(
dbt.exceptions.RuntimeException: Runtime Error
  Got a state selector method, but no comparison manifest

2020-11-09 16:30:16.830335 (MainThread): Running with dbt=0.18.1
2020-11-09 16:30:16.979085 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=True, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['state:modified'], partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=PosixPath('/tmp'), strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-09 16:30:16.980571 (MainThread): Tracking: tracking
2020-11-09 16:30:16.998582 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d555e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d69d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d75580>]}
2020-11-09 16:30:17.055433 (MainThread): Partial parsing not enabled
2020-11-09 16:30:17.057550 (MainThread): Parsing macros/catalog.sql
2020-11-09 16:30:17.066104 (MainThread): Parsing macros/relations.sql
2020-11-09 16:30:17.069029 (MainThread): Parsing macros/adapters.sql
2020-11-09 16:30:17.122027 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-11-09 16:30:17.129606 (MainThread): Parsing macros/core.sql
2020-11-09 16:30:17.140026 (MainThread): Parsing macros/materializations/helpers.sql
2020-11-09 16:30:17.162400 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-11-09 16:30:17.165892 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-11-09 16:30:17.200009 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-11-09 16:30:17.263230 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-11-09 16:30:17.302038 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-11-09 16:30:17.304890 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-11-09 16:30:17.316789 (MainThread): Parsing macros/materializations/common/merge.sql
2020-11-09 16:30:17.341828 (MainThread): Parsing macros/materializations/table/table.sql
2020-11-09 16:30:17.352694 (MainThread): Parsing macros/materializations/view/view.sql
2020-11-09 16:30:17.363285 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-11-09 16:30:17.372408 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-11-09 16:30:17.375037 (MainThread): Parsing macros/etc/query.sql
2020-11-09 16:30:17.377730 (MainThread): Parsing macros/etc/is_incremental.sql
2020-11-09 16:30:17.380831 (MainThread): Parsing macros/etc/datetime.sql
2020-11-09 16:30:17.398689 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-11-09 16:30:17.401636 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-11-09 16:30:17.404121 (MainThread): Parsing macros/adapters/common.sql
2020-11-09 16:30:17.490678 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-11-09 16:30:17.494508 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-11-09 16:30:17.498194 (MainThread): Parsing macros/schema_tests/unique.sql
2020-11-09 16:30:17.502067 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-11-09 16:30:17.517865 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2020-11-09 16:30:17.518134 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7d6a5e1b-7b1a-49ef-9165-2c17b66e12b2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d31e20>]}
2020-11-09 16:30:17.519184 (MainThread): Partial parsing not enabled
2020-11-09 16:30:17.586260 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 16:30:17.614264 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 16:30:17.627631 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:30:17.638484 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 16:30:17.654423 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 16:30:17.666005 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2020-11-09 16:30:17.676285 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 16:30:17.688393 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 16:30:18.723201 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 3 seed files, 0 sources
2020-11-09 16:30:18.723936 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080d3e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080d3f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080d3ca0>]}
2020-11-09 16:30:18.724344 (MainThread): Flushing usage events
2020-11-09 16:30:18.864939 (MainThread): Connection 'model.jaffle_shop.customer_orders' was properly closed.
2020-11-09 16:30:18.865222 (MainThread): Encountered an error:
2020-11-09 16:30:18.865380 (MainThread): Runtime Error
  Got a state selector method, but no comparison manifest
2020-11-09 16:30:18.869812 (MainThread): Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/main.py", line 255, in run_from_args
    results = task.run()
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/runnable.py", line 399, in run
    self._runtime_initialize()
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/runnable.py", line 124, in _runtime_initialize
    self.job_queue = self.get_graph_queue()
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/runnable.py", line 115, in get_graph_queue
    return selector.get_graph_queue(spec)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 189, in get_graph_queue
    selected_nodes = self.get_selected(spec)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 181, in get_selected
    selected_nodes = self.select_nodes(spec)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 119, in select_nodes
    node_selections = [
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 120, in <listcomp>
    self.select_nodes(component)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 119, in select_nodes
    node_selections = [
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 120, in <listcomp>
    self.select_nodes(component)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 119, in select_nodes
    node_selections = [
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 120, in <listcomp>
    self.select_nodes(component)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 117, in select_nodes
    result = self.get_nodes_from_criteria(spec)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 75, in get_nodes_from_criteria
    collected = self.select_included(nodes, spec)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 60, in select_included
    return set(method.search(included_nodes, spec.value))
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector_methods.py", line 460, in search
    raise RuntimeException(
dbt.exceptions.RuntimeException: Runtime Error
  Got a state selector method, but no comparison manifest

2020-11-09 16:31:30.986313 (MainThread): Running with dbt=0.18.1
2020-11-09 16:31:31.125541 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=True, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['state:modified'], partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=PosixPath('/tmp'), strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-09 16:31:31.126755 (MainThread): Tracking: tracking
2020-11-09 16:31:31.143758 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c152ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c165e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1709a0>]}
2020-11-09 16:31:31.180600 (MainThread): Partial parsing not enabled
2020-11-09 16:31:31.182891 (MainThread): Parsing macros/catalog.sql
2020-11-09 16:31:31.189300 (MainThread): Parsing macros/relations.sql
2020-11-09 16:31:31.192966 (MainThread): Parsing macros/adapters.sql
2020-11-09 16:31:31.235328 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-11-09 16:31:31.240577 (MainThread): Parsing macros/core.sql
2020-11-09 16:31:31.247964 (MainThread): Parsing macros/materializations/helpers.sql
2020-11-09 16:31:31.266378 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-11-09 16:31:31.270012 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-11-09 16:31:31.311255 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-11-09 16:31:31.363216 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-11-09 16:31:31.397933 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-11-09 16:31:31.401392 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-11-09 16:31:31.413960 (MainThread): Parsing macros/materializations/common/merge.sql
2020-11-09 16:31:31.437872 (MainThread): Parsing macros/materializations/table/table.sql
2020-11-09 16:31:31.452184 (MainThread): Parsing macros/materializations/view/view.sql
2020-11-09 16:31:31.464206 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-11-09 16:31:31.472387 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-11-09 16:31:31.474532 (MainThread): Parsing macros/etc/query.sql
2020-11-09 16:31:31.476979 (MainThread): Parsing macros/etc/is_incremental.sql
2020-11-09 16:31:31.479865 (MainThread): Parsing macros/etc/datetime.sql
2020-11-09 16:31:31.496182 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-11-09 16:31:31.500434 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-11-09 16:31:31.503573 (MainThread): Parsing macros/adapters/common.sql
2020-11-09 16:31:31.570577 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-11-09 16:31:31.574201 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-11-09 16:31:31.576721 (MainThread): Parsing macros/schema_tests/unique.sql
2020-11-09 16:31:31.579968 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-11-09 16:31:31.591238 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2020-11-09 16:31:31.591466 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a7653d19-1336-42de-bdc6-b102f72fc3d9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1dd850>]}
2020-11-09 16:31:31.592466 (MainThread): Partial parsing not enabled
2020-11-09 16:31:31.661990 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 16:31:31.688526 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 16:31:31.699830 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:31:31.711764 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 16:31:31.727930 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 16:31:31.743044 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2020-11-09 16:31:31.754828 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 16:31:31.765708 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 16:31:32.601795 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 3 seed files, 0 sources
2020-11-09 16:31:32.602318 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4cfee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4cfd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4cfe80>]}
2020-11-09 16:31:32.602591 (MainThread): Flushing usage events
2020-11-09 16:31:32.841356 (MainThread): Connection 'model.jaffle_shop.customer_orders' was properly closed.
2020-11-09 16:31:32.841572 (MainThread): Encountered an error:
2020-11-09 16:31:32.841711 (MainThread): Runtime Error
  Got a state selector method, but no comparison manifest
2020-11-09 16:31:32.845095 (MainThread): Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/main.py", line 255, in run_from_args
    results = task.run()
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/runnable.py", line 399, in run
    self._runtime_initialize()
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/runnable.py", line 124, in _runtime_initialize
    self.job_queue = self.get_graph_queue()
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/runnable.py", line 115, in get_graph_queue
    return selector.get_graph_queue(spec)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 189, in get_graph_queue
    selected_nodes = self.get_selected(spec)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 181, in get_selected
    selected_nodes = self.select_nodes(spec)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 119, in select_nodes
    node_selections = [
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 120, in <listcomp>
    self.select_nodes(component)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 119, in select_nodes
    node_selections = [
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 120, in <listcomp>
    self.select_nodes(component)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 119, in select_nodes
    node_selections = [
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 120, in <listcomp>
    self.select_nodes(component)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 117, in select_nodes
    result = self.get_nodes_from_criteria(spec)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 75, in get_nodes_from_criteria
    collected = self.select_included(nodes, spec)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector.py", line 60, in select_included
    return set(method.search(included_nodes, spec.value))
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/graph/selector_methods.py", line 460, in search
    raise RuntimeException(
dbt.exceptions.RuntimeException: Runtime Error
  Got a state selector method, but no comparison manifest

2020-11-09 16:32:30.054681 (MainThread): Running with dbt=0.18.1
2020-11-09 16:32:31.407235 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=True, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['state:modified'], partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=PosixPath('/tmp/target'), strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-09 16:32:31.408056 (MainThread): Tracking: tracking
2020-11-09 16:32:31.420264 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbb15e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbe4d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc043a0>]}
2020-11-09 16:32:31.441771 (MainThread): Partial parsing not enabled
2020-11-09 16:32:31.443007 (MainThread): Parsing macros/catalog.sql
2020-11-09 16:32:31.446984 (MainThread): Parsing macros/relations.sql
2020-11-09 16:32:31.449056 (MainThread): Parsing macros/adapters.sql
2020-11-09 16:32:31.473483 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-11-09 16:32:31.477102 (MainThread): Parsing macros/core.sql
2020-11-09 16:32:31.481246 (MainThread): Parsing macros/materializations/helpers.sql
2020-11-09 16:32:31.491075 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-11-09 16:32:31.493343 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-11-09 16:32:31.514635 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-11-09 16:32:31.546766 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-11-09 16:32:31.569936 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-11-09 16:32:31.572167 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-11-09 16:32:31.579043 (MainThread): Parsing macros/materializations/common/merge.sql
2020-11-09 16:32:31.594796 (MainThread): Parsing macros/materializations/table/table.sql
2020-11-09 16:32:31.602396 (MainThread): Parsing macros/materializations/view/view.sql
2020-11-09 16:32:31.609718 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-11-09 16:32:31.615552 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-11-09 16:32:31.616860 (MainThread): Parsing macros/etc/query.sql
2020-11-09 16:32:31.618631 (MainThread): Parsing macros/etc/is_incremental.sql
2020-11-09 16:32:31.621004 (MainThread): Parsing macros/etc/datetime.sql
2020-11-09 16:32:31.631347 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-11-09 16:32:31.633830 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-11-09 16:32:31.636613 (MainThread): Parsing macros/adapters/common.sql
2020-11-09 16:32:31.718875 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-11-09 16:32:31.721124 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-11-09 16:32:31.723195 (MainThread): Parsing macros/schema_tests/unique.sql
2020-11-09 16:32:31.725327 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-11-09 16:32:31.733562 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2020-11-09 16:32:31.733735 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '62017e67-1088-42fe-bb0d-48456191dc59', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbf4a00>]}
2020-11-09 16:32:31.734311 (MainThread): Partial parsing not enabled
2020-11-09 16:32:31.761428 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 16:32:31.777914 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 16:32:31.784670 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:32:31.792764 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 16:32:31.802110 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 16:32:31.811726 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2020-11-09 16:32:31.821122 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 16:32:31.829045 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 16:32:32.304148 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 3 seed files, 0 sources
2020-11-09 16:32:32.305907 (MainThread): The selector 'state:modified' does not match any nodes and will be ignored
2020-11-09 16:32:32.307797 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2020-11-09 16:32:32.308037 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be19370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be19610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be19a60>]}
2020-11-09 16:32:32.308239 (MainThread): Flushing usage events
2020-11-09 16:32:32.443273 (MainThread): Connection 'model.jaffle_shop.customer_orders' was properly closed.
2020-11-09 16:33:26.874548 (MainThread): Running with dbt=0.18.1
2020-11-09 16:33:28.097336 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=True, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['state:modified'], partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=PosixPath('/tmp/target'), strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-09 16:33:28.098563 (MainThread): Tracking: tracking
2020-11-09 16:33:28.114790 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063dcfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063ccb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063cca60>]}
2020-11-09 16:33:28.139783 (MainThread): Partial parsing not enabled
2020-11-09 16:33:28.141201 (MainThread): Parsing macros/catalog.sql
2020-11-09 16:33:28.145248 (MainThread): Parsing macros/relations.sql
2020-11-09 16:33:28.147115 (MainThread): Parsing macros/adapters.sql
2020-11-09 16:33:28.170717 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-11-09 16:33:28.174130 (MainThread): Parsing macros/core.sql
2020-11-09 16:33:28.178468 (MainThread): Parsing macros/materializations/helpers.sql
2020-11-09 16:33:28.188685 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-11-09 16:33:28.191019 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-11-09 16:33:28.209156 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-11-09 16:33:28.244007 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-11-09 16:33:28.273844 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-11-09 16:33:28.276189 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-11-09 16:33:28.282980 (MainThread): Parsing macros/materializations/common/merge.sql
2020-11-09 16:33:28.298004 (MainThread): Parsing macros/materializations/table/table.sql
2020-11-09 16:33:28.305596 (MainThread): Parsing macros/materializations/view/view.sql
2020-11-09 16:33:28.312975 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-11-09 16:33:28.318604 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-11-09 16:33:28.319869 (MainThread): Parsing macros/etc/query.sql
2020-11-09 16:33:28.321185 (MainThread): Parsing macros/etc/is_incremental.sql
2020-11-09 16:33:28.323185 (MainThread): Parsing macros/etc/datetime.sql
2020-11-09 16:33:28.333062 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-11-09 16:33:28.335847 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-11-09 16:33:28.338928 (MainThread): Parsing macros/adapters/common.sql
2020-11-09 16:33:28.415171 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-11-09 16:33:28.417397 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-11-09 16:33:28.419242 (MainThread): Parsing macros/schema_tests/unique.sql
2020-11-09 16:33:28.421224 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-11-09 16:33:28.428801 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2020-11-09 16:33:28.428954 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '76df4279-e16f-4db4-95d2-60d61676229a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063dcfa0>]}
2020-11-09 16:33:28.429532 (MainThread): Partial parsing not enabled
2020-11-09 16:33:28.456598 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 16:33:28.473146 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 16:33:28.479986 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:33:28.486203 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 16:33:28.494696 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 16:33:28.502830 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2020-11-09 16:33:28.510971 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 16:33:28.518599 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 16:33:28.995942 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 3 seed files, 0 sources
2020-11-09 16:33:28.997905 (MainThread): The selector 'state:modified' does not match any nodes and will be ignored
2020-11-09 16:33:28.999399 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2020-11-09 16:33:28.999585 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065ea640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065ea5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065ea160>]}
2020-11-09 16:33:28.999774 (MainThread): Flushing usage events
2020-11-09 16:33:29.158741 (MainThread): Connection 'model.jaffle_shop.customer_orders' was properly closed.
2020-11-09 16:42:17.678944 (MainThread): Running with dbt=0.18.1
2020-11-09 16:42:18.881780 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=True, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['state:modified'], partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=PosixPath('/tmp/target'), strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-09 16:42:18.883236 (MainThread): Tracking: tracking
2020-11-09 16:42:18.895894 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124acd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124ebe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124eb190>]}
2020-11-09 16:42:18.921105 (MainThread): Partial parsing not enabled
2020-11-09 16:42:18.922377 (MainThread): Parsing macros/catalog.sql
2020-11-09 16:42:18.927040 (MainThread): Parsing macros/relations.sql
2020-11-09 16:42:18.929362 (MainThread): Parsing macros/adapters.sql
2020-11-09 16:42:18.954600 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-11-09 16:42:18.959355 (MainThread): Parsing macros/core.sql
2020-11-09 16:42:18.964450 (MainThread): Parsing macros/materializations/helpers.sql
2020-11-09 16:42:18.974514 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-11-09 16:42:18.976742 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-11-09 16:42:18.994604 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-11-09 16:42:19.027717 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-11-09 16:42:19.051579 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-11-09 16:42:19.053783 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-11-09 16:42:19.061850 (MainThread): Parsing macros/materializations/common/merge.sql
2020-11-09 16:42:19.077740 (MainThread): Parsing macros/materializations/table/table.sql
2020-11-09 16:42:19.085355 (MainThread): Parsing macros/materializations/view/view.sql
2020-11-09 16:42:19.092449 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-11-09 16:42:19.097923 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-11-09 16:42:19.099219 (MainThread): Parsing macros/etc/query.sql
2020-11-09 16:42:19.100746 (MainThread): Parsing macros/etc/is_incremental.sql
2020-11-09 16:42:19.102782 (MainThread): Parsing macros/etc/datetime.sql
2020-11-09 16:42:19.112863 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-11-09 16:42:19.115237 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-11-09 16:42:19.117480 (MainThread): Parsing macros/adapters/common.sql
2020-11-09 16:42:19.189785 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-11-09 16:42:19.192838 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-11-09 16:42:19.195217 (MainThread): Parsing macros/schema_tests/unique.sql
2020-11-09 16:42:19.197880 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-11-09 16:42:19.211088 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2020-11-09 16:42:19.211329 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '322f404d-62a9-414c-b7a9-d2003c007a7f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11240e670>]}
2020-11-09 16:42:19.212086 (MainThread): Partial parsing not enabled
2020-11-09 16:42:19.238871 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 16:42:19.255610 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 16:42:19.262873 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:42:19.270135 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 16:42:19.278911 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 16:42:19.286973 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2020-11-09 16:42:19.294202 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 16:42:19.301416 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 16:42:19.787161 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 3 seed files, 0 sources
2020-11-09 16:42:19.790592 (MainThread): 
2020-11-09 16:42:19.790967 (MainThread): Merged 10 items from state (sample: ['model.jaffle_shop.stg_customers', 'model.jaffle_shop.stg_payments', 'model.jaffle_shop.dim_customers', 'model.jaffle_shop.fct_orders', 'model.jaffle_shop.customer_payments'])
2020-11-09 16:42:19.870162 (MainThread): Acquiring new postgres connection "master".
2020-11-09 16:42:19.871557 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dbttest1".
2020-11-09 16:42:19.881303 (ThreadPoolExecutor-0_0): Using postgres connection "list_dbttest1".
2020-11-09 16:42:19.881440 (ThreadPoolExecutor-0_0): On list_dbttest1: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1"} */

    select distinct nspname from pg_namespace
  
2020-11-09 16:42:19.881526 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-09 16:42:19.889969 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2020-11-09 16:42:19.892697 (ThreadPoolExecutor-0_0): On list_dbttest1: Close
2020-11-09 16:42:19.927958 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dbttest1_public".
2020-11-09 16:42:19.933783 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2020-11-09 16:42:19.933905 (ThreadPoolExecutor-1_0): On list_dbttest1_public: BEGIN
2020-11-09 16:42:19.933985 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2020-11-09 16:42:19.943596 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2020-11-09 16:42:19.943759 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2020-11-09 16:42:19.943852 (ThreadPoolExecutor-1_0): On list_dbttest1_public: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1_public"} */
select
      'dbttest1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbttest1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-11-09 16:42:19.947125 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2020-11-09 16:42:19.955128 (ThreadPoolExecutor-1_0): On list_dbttest1_public: ROLLBACK
2020-11-09 16:42:19.956226 (ThreadPoolExecutor-1_0): On list_dbttest1_public: Close
2020-11-09 16:42:20.003910 (MainThread): Using postgres connection "master".
2020-11-09 16:42:20.004053 (MainThread): On master: BEGIN
2020-11-09 16:42:20.004152 (MainThread): Opening a new connection, currently in state init
2020-11-09 16:42:20.014875 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-11-09 16:42:20.015034 (MainThread): Using postgres connection "master".
2020-11-09 16:42:20.015120 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-11-09 16:42:20.021203 (MainThread): SQL status: SELECT 3 in 0.01 seconds
2020-11-09 16:42:20.024841 (MainThread): On master: ROLLBACK
2020-11-09 16:42:20.026237 (MainThread): Using postgres connection "master".
2020-11-09 16:42:20.026418 (MainThread): On master: BEGIN
2020-11-09 16:42:20.029929 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-11-09 16:42:20.030090 (MainThread): On master: COMMIT
2020-11-09 16:42:20.030181 (MainThread): Using postgres connection "master".
2020-11-09 16:42:20.030263 (MainThread): On master: COMMIT
2020-11-09 16:42:20.031305 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-11-09 16:42:20.031495 (MainThread): On master: Close
2020-11-09 16:42:20.031905 (MainThread): 11:42:20 | Concurrency: 1 threads (target='dev')
2020-11-09 16:42:20.032041 (MainThread): 11:42:20 | 
2020-11-09 16:42:20.035780 (Thread-1): Began running node model.jaffle_shop.stg_orders
2020-11-09 16:42:20.037041 (Thread-1): 11:42:20 | 1 of 1 START view model public.stg_orders............................ [RUN]
2020-11-09 16:42:20.037333 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:42:20.037463 (Thread-1): Compiling model.jaffle_shop.stg_orders
2020-11-09 16:42:20.048291 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2020-11-09 16:42:20.049147 (Thread-1): finished collecting timing info
2020-11-09 16:42:20.076908 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:42:20.077111 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbttest1"."public"."stg_orders__dbt_tmp" cascade
2020-11-09 16:42:20.077244 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 16:42:20.097478 (Thread-1): SQL status: DROP VIEW in 0.02 seconds
2020-11-09 16:42:20.101599 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:42:20.101787 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbttest1"."public"."stg_orders__dbt_backup" cascade
2020-11-09 16:42:20.103555 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-11-09 16:42:20.111950 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2020-11-09 16:42:20.112617 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:42:20.112809 (Thread-1): On model.jaffle_shop.stg_orders: BEGIN
2020-11-09 16:42:20.115721 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 16:42:20.115959 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:42:20.116105 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "dbttest1"."public"."stg_orders__dbt_tmp" as (
    with source as (
    select * from "dbttest1"."public"."raw_orders"

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select *, 1 from renamed
  );

2020-11-09 16:42:20.128248 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-11-09 16:42:20.140732 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:42:20.140910 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbttest1"."public"."stg_orders" rename to "stg_orders__dbt_backup"
2020-11-09 16:42:20.144005 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 16:42:20.147592 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:42:20.147783 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbttest1"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
2020-11-09 16:42:20.149772 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 16:42:20.162649 (Thread-1): On model.jaffle_shop.stg_orders: COMMIT
2020-11-09 16:42:20.162835 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:42:20.162957 (Thread-1): On model.jaffle_shop.stg_orders: COMMIT
2020-11-09 16:42:20.165584 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 16:42:20.171731 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 16:42:20.172090 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbttest1"."public"."stg_orders__dbt_backup" cascade
2020-11-09 16:42:20.175726 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-11-09 16:42:20.179481 (Thread-1): finished collecting timing info
2020-11-09 16:42:20.179956 (Thread-1): On model.jaffle_shop.stg_orders: Close
2020-11-09 16:42:20.180806 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '322f404d-62a9-414c-b7a9-d2003c007a7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125db7c0>]}
2020-11-09 16:42:20.182750 (Thread-1): 11:42:20 | 1 of 1 OK created view model public.stg_orders....................... [CREATE VIEW in 0.14s]
2020-11-09 16:42:20.183027 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2020-11-09 16:42:20.184922 (MainThread): Acquiring new postgres connection "master".
2020-11-09 16:42:20.185205 (MainThread): Using postgres connection "master".
2020-11-09 16:42:20.185388 (MainThread): On master: BEGIN
2020-11-09 16:42:20.185736 (MainThread): Opening a new connection, currently in state closed
2020-11-09 16:42:20.206434 (MainThread): SQL status: BEGIN in 0.02 seconds
2020-11-09 16:42:20.206814 (MainThread): On master: COMMIT
2020-11-09 16:42:20.207035 (MainThread): Using postgres connection "master".
2020-11-09 16:42:20.207281 (MainThread): On master: COMMIT
2020-11-09 16:42:20.210839 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-11-09 16:42:20.211289 (MainThread): On master: Close
2020-11-09 16:42:20.211909 (MainThread): 11:42:20 | 
2020-11-09 16:42:20.212117 (MainThread): 11:42:20 | Finished running 1 view model in 0.42s.
2020-11-09 16:42:20.212280 (MainThread): Connection 'master' was properly closed.
2020-11-09 16:42:20.212473 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2020-11-09 16:42:20.218976 (MainThread): 
2020-11-09 16:42:20.219413 (MainThread): Completed successfully
2020-11-09 16:42:20.219679 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-11-09 16:42:20.220016 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11260f9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11260ff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11260f1c0>]}
2020-11-09 16:42:20.220553 (MainThread): Flushing usage events
2020-11-09 22:16:34.012002 (MainThread): Running with dbt=0.18.1
2020-11-09 22:16:36.516970 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=PosixPath('/tmp/target'), strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-09 22:16:36.518575 (MainThread): Tracking: tracking
2020-11-09 22:16:36.532907 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130addf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130e05b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11310a3a0>]}
2020-11-09 22:16:36.577096 (MainThread): Partial parsing not enabled
2020-11-09 22:16:36.579315 (MainThread): Parsing macros/catalog.sql
2020-11-09 22:16:36.586557 (MainThread): Parsing macros/relations.sql
2020-11-09 22:16:36.589798 (MainThread): Parsing macros/adapters.sql
2020-11-09 22:16:36.631247 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-11-09 22:16:36.638647 (MainThread): Parsing macros/core.sql
2020-11-09 22:16:36.650274 (MainThread): Parsing macros/materializations/helpers.sql
2020-11-09 22:16:36.674723 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-11-09 22:16:36.680511 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-11-09 22:16:36.724554 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-11-09 22:16:36.786667 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-11-09 22:16:36.835103 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-11-09 22:16:36.839505 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-11-09 22:16:36.856563 (MainThread): Parsing macros/materializations/common/merge.sql
2020-11-09 22:16:36.888858 (MainThread): Parsing macros/materializations/table/table.sql
2020-11-09 22:16:36.905167 (MainThread): Parsing macros/materializations/view/view.sql
2020-11-09 22:16:36.919478 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-11-09 22:16:36.929702 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-11-09 22:16:36.931838 (MainThread): Parsing macros/etc/query.sql
2020-11-09 22:16:36.934551 (MainThread): Parsing macros/etc/is_incremental.sql
2020-11-09 22:16:36.938623 (MainThread): Parsing macros/etc/datetime.sql
2020-11-09 22:16:36.957314 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-11-09 22:16:36.961640 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-11-09 22:16:36.965601 (MainThread): Parsing macros/adapters/common.sql
2020-11-09 22:16:37.093946 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-11-09 22:16:37.098102 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-11-09 22:16:37.102175 (MainThread): Parsing macros/schema_tests/unique.sql
2020-11-09 22:16:37.106553 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-11-09 22:16:37.125528 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2020-11-09 22:16:37.125897 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '21fbdc62-262b-47b3-8aad-7a84d87df935', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130ef7c0>]}
2020-11-09 22:16:37.127016 (MainThread): Partial parsing not enabled
2020-11-09 22:16:37.204033 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 22:16:37.275219 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:16:37.289607 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:16:37.304186 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 22:16:37.321309 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:16:37.336238 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:16:37.349400 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 22:16:37.364404 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 22:16:38.422300 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 3 seed files, 1 source
2020-11-09 22:16:38.426498 (MainThread): 
2020-11-09 22:16:38.427018 (MainThread): Acquiring new postgres connection "master".
2020-11-09 22:16:38.441235 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dbttest1".
2020-11-09 22:16:38.464475 (ThreadPoolExecutor-0_0): Using postgres connection "list_dbttest1".
2020-11-09 22:16:38.464756 (ThreadPoolExecutor-0_0): On list_dbttest1: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1"} */

    select distinct nspname from pg_namespace
  
2020-11-09 22:16:38.464928 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-09 22:16:38.481586 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.02 seconds
2020-11-09 22:16:38.484651 (ThreadPoolExecutor-0_0): On list_dbttest1: Close
2020-11-09 22:16:38.533681 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dbttest1_public".
2020-11-09 22:16:38.542556 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2020-11-09 22:16:38.542740 (ThreadPoolExecutor-1_0): On list_dbttest1_public: BEGIN
2020-11-09 22:16:38.542900 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2020-11-09 22:16:38.554382 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2020-11-09 22:16:38.554549 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2020-11-09 22:16:38.554647 (ThreadPoolExecutor-1_0): On list_dbttest1_public: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1_public"} */
select
      'dbttest1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbttest1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-11-09 22:16:38.570610 (ThreadPoolExecutor-1_0): SQL status: SELECT 12 in 0.02 seconds
2020-11-09 22:16:38.586276 (ThreadPoolExecutor-1_0): On list_dbttest1_public: ROLLBACK
2020-11-09 22:16:38.587828 (ThreadPoolExecutor-1_0): On list_dbttest1_public: Close
2020-11-09 22:16:38.647445 (MainThread): Using postgres connection "master".
2020-11-09 22:16:38.647626 (MainThread): On master: BEGIN
2020-11-09 22:16:38.647738 (MainThread): Opening a new connection, currently in state init
2020-11-09 22:16:38.659154 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-11-09 22:16:38.659353 (MainThread): Using postgres connection "master".
2020-11-09 22:16:38.659447 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-11-09 22:16:38.685954 (MainThread): SQL status: SELECT 3 in 0.03 seconds
2020-11-09 22:16:38.691302 (MainThread): On master: ROLLBACK
2020-11-09 22:16:38.693073 (MainThread): Using postgres connection "master".
2020-11-09 22:16:38.693238 (MainThread): On master: BEGIN
2020-11-09 22:16:38.696183 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-11-09 22:16:38.696400 (MainThread): On master: COMMIT
2020-11-09 22:16:38.696547 (MainThread): Using postgres connection "master".
2020-11-09 22:16:38.696638 (MainThread): On master: COMMIT
2020-11-09 22:16:38.697903 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-11-09 22:16:38.698078 (MainThread): On master: Close
2020-11-09 22:16:38.698469 (MainThread): 17:16:38 | Concurrency: 1 threads (target='dev')
2020-11-09 22:16:38.698689 (MainThread): 17:16:38 | 
2020-11-09 22:16:38.703846 (Thread-1): Began running node model.jaffle_shop.stg_orders
2020-11-09 22:16:38.705558 (Thread-1): 17:16:38 | 1 of 8 START view model public.stg_orders............................ [RUN]
2020-11-09 22:16:38.706181 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:16:38.706395 (Thread-1): Compiling model.jaffle_shop.stg_orders
2020-11-09 22:16:38.723668 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2020-11-09 22:16:38.725140 (Thread-1): finished collecting timing info
2020-11-09 22:16:38.771465 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:16:38.771637 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbttest1"."public"."stg_orders__dbt_tmp" cascade
2020-11-09 22:16:38.771739 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 22:16:38.785608 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-11-09 22:16:38.789570 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:16:38.789786 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbttest1"."public"."stg_orders__dbt_backup" cascade
2020-11-09 22:16:38.791548 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-11-09 22:16:38.797626 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2020-11-09 22:16:38.798281 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:16:38.798475 (Thread-1): On model.jaffle_shop.stg_orders: BEGIN
2020-11-09 22:16:38.800435 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 22:16:38.800599 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:16:38.800720 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "dbttest1"."public"."stg_orders__dbt_tmp" as (
    with source as (
    select * from "dbttest1"."public"."raw_orders"

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

    union all

    select
	id as order_id,
	null as customer_id,
	null as order_date,
	null as status
    from
	"dbttest1"."test"."source1"

)

select * from renamed
  );

2020-11-09 22:16:38.804167 (Thread-1): Postgres error: relation "test.source1" does not exist
LINE 27:  "dbttest1"."test"."source1"
          ^

2020-11-09 22:16:38.804404 (Thread-1): On model.jaffle_shop.stg_orders: ROLLBACK
2020-11-09 22:16:38.806622 (Thread-1): finished collecting timing info
2020-11-09 22:16:38.807182 (Thread-1): On model.jaffle_shop.stg_orders: Close
2020-11-09 22:16:38.807730 (Thread-1): Database Error in model stg_orders (models/staging/stg_orders.sql)
  relation "test.source1" does not exist
  LINE 27:  "dbttest1"."test"."source1"
            ^
  compiled SQL at target/run/jaffle_shop/models/staging/stg_orders.sql
Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "test.source1" does not exist
LINE 27:  "dbttest1"."test"."source1"
          ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 224, in execute
    return self.connections.execute(
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/Users/naveen/.pyenv/versions/3.8.2/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 57, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model stg_orders (models/staging/stg_orders.sql)
  relation "test.source1" does not exist
  LINE 27:  "dbttest1"."test"."source1"
            ^
  compiled SQL at target/run/jaffle_shop/models/staging/stg_orders.sql
2020-11-09 22:16:38.816102 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21fbdc62-262b-47b3-8aad-7a84d87df935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11331f520>]}
2020-11-09 22:16:38.817483 (Thread-1): 17:16:38 | 1 of 8 ERROR creating view model public.stg_orders................... [ERROR in 0.11s]
2020-11-09 22:16:38.817669 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2020-11-09 22:16:38.817824 (Thread-1): Began running node model.jaffle_shop.stg_payments
2020-11-09 22:16:38.819315 (Thread-1): 17:16:38 | 2 of 8 START view model public.stg_payments.......................... [RUN]
2020-11-09 22:16:38.819865 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:16:38.820091 (Thread-1): Compiling model.jaffle_shop.stg_payments
2020-11-09 22:16:38.836612 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2020-11-09 22:16:38.837496 (Thread-1): finished collecting timing info
2020-11-09 22:16:38.845479 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:16:38.845629 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbttest1"."public"."stg_payments__dbt_tmp" cascade
2020-11-09 22:16:38.845763 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 22:16:38.856852 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-11-09 22:16:38.860111 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:16:38.860310 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbttest1"."public"."stg_payments__dbt_backup" cascade
2020-11-09 22:16:38.862229 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-11-09 22:16:38.863672 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2020-11-09 22:16:38.864276 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:16:38.864417 (Thread-1): On model.jaffle_shop.stg_payments: BEGIN
2020-11-09 22:16:38.865964 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 22:16:38.866146 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:16:38.866306 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "dbttest1"."public"."stg_payments__dbt_tmp" as (
    with source as (
    select * from "dbttest1"."public"."raw_payments"

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        --`amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed
  );

2020-11-09 22:16:38.882284 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2020-11-09 22:16:38.894328 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:16:38.894513 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbttest1"."public"."stg_payments" rename to "stg_payments__dbt_backup"
2020-11-09 22:16:38.897215 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:16:38.901751 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:16:38.901931 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbttest1"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
2020-11-09 22:16:38.905130 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:16:38.917502 (Thread-1): On model.jaffle_shop.stg_payments: COMMIT
2020-11-09 22:16:38.917820 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:16:38.918082 (Thread-1): On model.jaffle_shop.stg_payments: COMMIT
2020-11-09 22:16:38.922579 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 22:16:38.932847 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:16:38.933146 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbttest1"."public"."stg_payments__dbt_backup" cascade
2020-11-09 22:16:38.938803 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-11-09 22:16:38.944210 (Thread-1): finished collecting timing info
2020-11-09 22:16:38.944759 (Thread-1): On model.jaffle_shop.stg_payments: Close
2020-11-09 22:16:38.945803 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21fbdc62-262b-47b3-8aad-7a84d87df935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113248a60>]}
2020-11-09 22:16:38.948484 (Thread-1): 17:16:38 | 2 of 8 OK created view model public.stg_payments..................... [CREATE VIEW in 0.13s]
2020-11-09 22:16:38.948747 (Thread-1): Finished running node model.jaffle_shop.stg_payments
2020-11-09 22:16:38.949160 (Thread-1): Began running node model.jaffle_shop.stg_customers
2020-11-09 22:16:38.951767 (Thread-1): 17:16:38 | 3 of 8 START view model public.stg_customers......................... [RUN]
2020-11-09 22:16:38.952476 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 22:16:38.952689 (Thread-1): Compiling model.jaffle_shop.stg_customers
2020-11-09 22:16:38.974432 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2020-11-09 22:16:38.975128 (Thread-1): finished collecting timing info
2020-11-09 22:16:38.994449 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 22:16:38.994676 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbttest1"."public"."stg_customers__dbt_tmp" cascade
2020-11-09 22:16:38.995047 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 22:16:39.010938 (Thread-1): SQL status: DROP VIEW in 0.02 seconds
2020-11-09 22:16:39.018041 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 22:16:39.018951 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbttest1"."public"."stg_customers__dbt_backup" cascade
2020-11-09 22:16:39.025721 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-11-09 22:16:39.028103 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2020-11-09 22:16:39.028811 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 22:16:39.028973 (Thread-1): On model.jaffle_shop.stg_customers: BEGIN
2020-11-09 22:16:39.033327 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 22:16:39.033584 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 22:16:39.033962 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "dbttest1"."public"."stg_customers__dbt_tmp" as (
    with source as (
    select * from "dbttest1"."public"."raw_customers"

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name,
        email

    from source

)

select * from renamed
  );

2020-11-09 22:16:39.047673 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-11-09 22:16:39.056726 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 22:16:39.056940 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbttest1"."public"."stg_customers" rename to "stg_customers__dbt_backup"
2020-11-09 22:16:39.059683 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:16:39.064237 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 22:16:39.064489 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbttest1"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
2020-11-09 22:16:39.072267 (Thread-1): SQL status: ALTER TABLE in 0.01 seconds
2020-11-09 22:16:39.075133 (Thread-1): On model.jaffle_shop.stg_customers: COMMIT
2020-11-09 22:16:39.075379 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 22:16:39.075591 (Thread-1): On model.jaffle_shop.stg_customers: COMMIT
2020-11-09 22:16:39.077902 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 22:16:39.082676 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 22:16:39.082909 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbttest1"."public"."stg_customers__dbt_backup" cascade
2020-11-09 22:16:39.088661 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-11-09 22:16:39.094155 (Thread-1): finished collecting timing info
2020-11-09 22:16:39.094656 (Thread-1): On model.jaffle_shop.stg_customers: Close
2020-11-09 22:16:39.095910 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21fbdc62-262b-47b3-8aad-7a84d87df935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132c35e0>]}
2020-11-09 22:16:39.097296 (Thread-1): 17:16:39 | 3 of 8 OK created view model public.stg_customers.................... [CREATE VIEW in 0.14s]
2020-11-09 22:16:39.097703 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2020-11-09 22:16:39.098227 (Thread-1): Began running node model.jaffle_shop.customer_orders
2020-11-09 22:16:39.098706 (Thread-1): 17:16:39 | 4 of 8 SKIP relation public.customer_orders.......................... [SKIP]
2020-11-09 22:16:39.098867 (Thread-1): Finished running node model.jaffle_shop.customer_orders
2020-11-09 22:16:39.099173 (Thread-1): Began running node model.jaffle_shop.customer_payments
2020-11-09 22:16:39.099544 (Thread-1): 17:16:39 | 5 of 8 SKIP relation public.customer_payments........................ [SKIP]
2020-11-09 22:16:39.099840 (Thread-1): Finished running node model.jaffle_shop.customer_payments
2020-11-09 22:16:39.100076 (Thread-1): Began running node model.jaffle_shop.order_payments
2020-11-09 22:16:39.102528 (Thread-1): 17:16:39 | 6 of 8 START table model public.order_payments....................... [RUN]
2020-11-09 22:16:39.103358 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:16:39.103622 (Thread-1): Compiling model.jaffle_shop.order_payments
2020-11-09 22:16:39.121435 (Thread-1): Writing injected SQL for node "model.jaffle_shop.order_payments"
2020-11-09 22:16:39.123272 (Thread-1): finished collecting timing info
2020-11-09 22:16:39.160649 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:16:39.160875 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */
drop table if exists "dbttest1"."public"."order_payments__dbt_tmp" cascade
2020-11-09 22:16:39.160976 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 22:16:39.171704 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-11-09 22:16:39.174667 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:16:39.174810 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */
drop table if exists "dbttest1"."public"."order_payments__dbt_backup" cascade
2020-11-09 22:16:39.176988 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 22:16:39.183414 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.order_payments"
2020-11-09 22:16:39.183928 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:16:39.184095 (Thread-1): On model.jaffle_shop.order_payments: BEGIN
2020-11-09 22:16:39.185734 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 22:16:39.185909 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:16:39.185997 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */


  create  table "dbttest1"."public"."order_payments__dbt_tmp"
  as (
    

with payments as (

    select * from "dbttest1"."public"."stg_payments"

),

final as (

    select
        order_id,

        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,
        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,
        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,
        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,
        sum(amount) as total_amount

    from payments

    group by 1

)

select * from final
  );
2020-11-09 22:16:39.195663 (Thread-1): SQL status: SELECT 99 in 0.01 seconds
2020-11-09 22:16:39.200527 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:16:39.200671 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */
alter table "dbttest1"."public"."order_payments" rename to "order_payments__dbt_backup"
2020-11-09 22:16:39.202424 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:16:39.205398 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:16:39.205530 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */
alter table "dbttest1"."public"."order_payments__dbt_tmp" rename to "order_payments"
2020-11-09 22:16:39.207479 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:16:39.208763 (Thread-1): On model.jaffle_shop.order_payments: COMMIT
2020-11-09 22:16:39.208889 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:16:39.209027 (Thread-1): On model.jaffle_shop.order_payments: COMMIT
2020-11-09 22:16:39.211552 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 22:16:39.213781 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:16:39.213910 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */
drop table if exists "dbttest1"."public"."order_payments__dbt_backup" cascade
2020-11-09 22:16:39.220214 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-11-09 22:16:39.222728 (Thread-1): finished collecting timing info
2020-11-09 22:16:39.223029 (Thread-1): On model.jaffle_shop.order_payments: Close
2020-11-09 22:16:39.223700 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21fbdc62-262b-47b3-8aad-7a84d87df935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113448ee0>]}
2020-11-09 22:16:39.224817 (Thread-1): 17:16:39 | 6 of 8 OK created table model public.order_payments.................. [SELECT 99 in 0.12s]
2020-11-09 22:16:39.224994 (Thread-1): Finished running node model.jaffle_shop.order_payments
2020-11-09 22:16:39.225414 (Thread-1): Began running node model.jaffle_shop.dim_customers
2020-11-09 22:16:39.226162 (Thread-1): 17:16:39 | 7 of 8 SKIP relation public.dim_customers............................ [SKIP]
2020-11-09 22:16:39.226387 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2020-11-09 22:16:39.226567 (Thread-1): Began running node model.jaffle_shop.fct_orders
2020-11-09 22:16:39.226794 (Thread-1): 17:16:39 | 8 of 8 SKIP relation public.fct_orders............................... [SKIP]
2020-11-09 22:16:39.226931 (Thread-1): Finished running node model.jaffle_shop.fct_orders
2020-11-09 22:16:39.228223 (MainThread): Acquiring new postgres connection "master".
2020-11-09 22:16:39.228433 (MainThread): Using postgres connection "master".
2020-11-09 22:16:39.228565 (MainThread): On master: BEGIN
2020-11-09 22:16:39.228654 (MainThread): Opening a new connection, currently in state closed
2020-11-09 22:16:39.240374 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-11-09 22:16:39.240553 (MainThread): On master: COMMIT
2020-11-09 22:16:39.240662 (MainThread): Using postgres connection "master".
2020-11-09 22:16:39.240748 (MainThread): On master: COMMIT
2020-11-09 22:16:39.242297 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-11-09 22:16:39.242590 (MainThread): On master: Close
2020-11-09 22:16:39.243282 (MainThread): 17:16:39 | 
2020-11-09 22:16:39.243544 (MainThread): 17:16:39 | Finished running 3 view models, 5 table models in 0.82s.
2020-11-09 22:16:39.243892 (MainThread): Connection 'master' was properly closed.
2020-11-09 22:16:39.244181 (MainThread): Connection 'model.jaffle_shop.order_payments' was properly closed.
2020-11-09 22:16:39.270862 (MainThread): 
2020-11-09 22:16:39.271096 (MainThread): Completed with 1 error and 0 warnings:
2020-11-09 22:16:39.271204 (MainThread): 
2020-11-09 22:16:39.271303 (MainThread): Database Error in model stg_orders (models/staging/stg_orders.sql)
2020-11-09 22:16:39.271457 (MainThread):   relation "test.source1" does not exist
2020-11-09 22:16:39.271639 (MainThread):   LINE 27:  "dbttest1"."test"."source1"
2020-11-09 22:16:39.271740 (MainThread):             ^
2020-11-09 22:16:39.271871 (MainThread):   compiled SQL at target/run/jaffle_shop/models/staging/stg_orders.sql
2020-11-09 22:16:39.272042 (MainThread): 
Done. PASS=3 WARN=0 ERROR=1 SKIP=4 TOTAL=8
2020-11-09 22:16:39.272317 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11334ffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11334fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113334fd0>]}
2020-11-09 22:16:39.272528 (MainThread): Flushing usage events
2020-11-09 22:17:42.826121 (MainThread): Running with dbt=0.18.1
2020-11-09 22:17:45.220769 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=PosixPath('/tmp/target'), strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-09 22:17:45.221333 (MainThread): Tracking: tracking
2020-11-09 22:17:45.234899 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a796730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7a7f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7a7280>]}
2020-11-09 22:17:45.270891 (MainThread): Partial parsing not enabled
2020-11-09 22:17:45.272247 (MainThread): Parsing macros/catalog.sql
2020-11-09 22:17:45.277188 (MainThread): Parsing macros/relations.sql
2020-11-09 22:17:45.279317 (MainThread): Parsing macros/adapters.sql
2020-11-09 22:17:45.329822 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-11-09 22:17:45.334519 (MainThread): Parsing macros/core.sql
2020-11-09 22:17:45.343964 (MainThread): Parsing macros/materializations/helpers.sql
2020-11-09 22:17:45.360894 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-11-09 22:17:45.363833 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-11-09 22:17:45.396805 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-11-09 22:17:45.458771 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-11-09 22:17:45.502563 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-11-09 22:17:45.507189 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-11-09 22:17:45.517515 (MainThread): Parsing macros/materializations/common/merge.sql
2020-11-09 22:17:45.538286 (MainThread): Parsing macros/materializations/table/table.sql
2020-11-09 22:17:45.550168 (MainThread): Parsing macros/materializations/view/view.sql
2020-11-09 22:17:45.563284 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-11-09 22:17:45.572084 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-11-09 22:17:45.574550 (MainThread): Parsing macros/etc/query.sql
2020-11-09 22:17:45.576454 (MainThread): Parsing macros/etc/is_incremental.sql
2020-11-09 22:17:45.580326 (MainThread): Parsing macros/etc/datetime.sql
2020-11-09 22:17:45.598523 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-11-09 22:17:45.601557 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-11-09 22:17:45.604987 (MainThread): Parsing macros/adapters/common.sql
2020-11-09 22:17:45.716825 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-11-09 22:17:45.720891 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-11-09 22:17:45.723878 (MainThread): Parsing macros/schema_tests/unique.sql
2020-11-09 22:17:45.726931 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-11-09 22:17:45.738495 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2020-11-09 22:17:45.738789 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8a414a40-e3d7-4902-8a27-3c0c50325348', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a796730>]}
2020-11-09 22:17:45.739933 (MainThread): Partial parsing not enabled
2020-11-09 22:17:45.784065 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 22:17:45.814150 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:17:45.825063 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:17:45.835624 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 22:17:45.848654 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:17:45.860089 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:17:45.869718 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 22:17:45.882781 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 22:17:46.806707 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 3 seed files, 1 source
2020-11-09 22:17:46.812177 (MainThread): 
2020-11-09 22:17:46.812691 (MainThread): Acquiring new postgres connection "master".
2020-11-09 22:17:46.830778 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dbttest1".
2020-11-09 22:17:46.850993 (ThreadPoolExecutor-0_0): Using postgres connection "list_dbttest1".
2020-11-09 22:17:46.851210 (ThreadPoolExecutor-0_0): On list_dbttest1: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1"} */

    select distinct nspname from pg_namespace
  
2020-11-09 22:17:46.851317 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-09 22:17:46.864977 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2020-11-09 22:17:46.868690 (ThreadPoolExecutor-0_0): On list_dbttest1: Close
2020-11-09 22:17:46.926647 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dbttest1_public".
2020-11-09 22:17:46.937048 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2020-11-09 22:17:46.937249 (ThreadPoolExecutor-1_0): On list_dbttest1_public: BEGIN
2020-11-09 22:17:46.937404 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2020-11-09 22:17:46.948117 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2020-11-09 22:17:46.948293 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2020-11-09 22:17:46.948398 (ThreadPoolExecutor-1_0): On list_dbttest1_public: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1_public"} */
select
      'dbttest1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbttest1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-11-09 22:17:46.954358 (ThreadPoolExecutor-1_0): SQL status: SELECT 12 in 0.01 seconds
2020-11-09 22:17:46.967640 (ThreadPoolExecutor-1_0): On list_dbttest1_public: ROLLBACK
2020-11-09 22:17:46.969331 (ThreadPoolExecutor-1_0): On list_dbttest1_public: Close
2020-11-09 22:17:47.025834 (MainThread): Using postgres connection "master".
2020-11-09 22:17:47.025995 (MainThread): On master: BEGIN
2020-11-09 22:17:47.026095 (MainThread): Opening a new connection, currently in state init
2020-11-09 22:17:47.042698 (MainThread): SQL status: BEGIN in 0.02 seconds
2020-11-09 22:17:47.042907 (MainThread): Using postgres connection "master".
2020-11-09 22:17:47.043024 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-11-09 22:17:47.057829 (MainThread): SQL status: SELECT 3 in 0.01 seconds
2020-11-09 22:17:47.065635 (MainThread): On master: ROLLBACK
2020-11-09 22:17:47.068437 (MainThread): Using postgres connection "master".
2020-11-09 22:17:47.068610 (MainThread): On master: BEGIN
2020-11-09 22:17:47.093606 (MainThread): SQL status: BEGIN in 0.02 seconds
2020-11-09 22:17:47.093865 (MainThread): On master: COMMIT
2020-11-09 22:17:47.094014 (MainThread): Using postgres connection "master".
2020-11-09 22:17:47.094144 (MainThread): On master: COMMIT
2020-11-09 22:17:47.096512 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-11-09 22:17:47.096840 (MainThread): On master: Close
2020-11-09 22:17:47.097332 (MainThread): 17:17:47 | Concurrency: 1 threads (target='dev')
2020-11-09 22:17:47.097536 (MainThread): 17:17:47 | 
2020-11-09 22:17:47.101920 (Thread-1): Began running node model.jaffle_shop.stg_orders
2020-11-09 22:17:47.103625 (Thread-1): 17:17:47 | 1 of 8 START view model public.stg_orders............................ [RUN]
2020-11-09 22:17:47.104004 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:17:47.104182 (Thread-1): Compiling model.jaffle_shop.stg_orders
2020-11-09 22:17:47.116867 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2020-11-09 22:17:47.117537 (Thread-1): finished collecting timing info
2020-11-09 22:17:47.169657 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:17:47.169888 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbttest1"."public"."stg_orders__dbt_tmp" cascade
2020-11-09 22:17:47.170015 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 22:17:47.190685 (Thread-1): SQL status: DROP VIEW in 0.02 seconds
2020-11-09 22:17:47.195293 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:17:47.195447 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbttest1"."public"."stg_orders__dbt_backup" cascade
2020-11-09 22:17:47.198354 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-11-09 22:17:47.206147 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2020-11-09 22:17:47.206881 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:17:47.207060 (Thread-1): On model.jaffle_shop.stg_orders: BEGIN
2020-11-09 22:17:47.210197 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 22:17:47.210385 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:17:47.210507 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "dbttest1"."public"."stg_orders__dbt_tmp" as (
    with source as (
    select * from "dbttest1"."public"."raw_orders"

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

    union all

    select
	id as order_id,
	null as customer_id,
	null as order_date,
	null as status
    from
	"dbttest1"."public"."source1"

)

select * from renamed
  );

2020-11-09 22:17:47.217963 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-11-09 22:17:47.233989 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:17:47.234152 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbttest1"."public"."stg_orders" rename to "stg_orders__dbt_backup"
2020-11-09 22:17:47.237464 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:17:47.241444 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:17:47.241644 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbttest1"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
2020-11-09 22:17:47.245581 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:17:47.256592 (Thread-1): On model.jaffle_shop.stg_orders: COMMIT
2020-11-09 22:17:47.256807 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:17:47.256968 (Thread-1): On model.jaffle_shop.stg_orders: COMMIT
2020-11-09 22:17:47.258601 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 22:17:47.263342 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:17:47.263497 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbttest1"."public"."stg_orders__dbt_backup" cascade
2020-11-09 22:17:47.266561 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-11-09 22:17:47.269795 (Thread-1): finished collecting timing info
2020-11-09 22:17:47.270106 (Thread-1): On model.jaffle_shop.stg_orders: Close
2020-11-09 22:17:47.270952 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a414a40-e3d7-4902-8a27-3c0c50325348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8e1820>]}
2020-11-09 22:17:47.272525 (Thread-1): 17:17:47 | 1 of 8 OK created view model public.stg_orders....................... [CREATE VIEW in 0.17s]
2020-11-09 22:17:47.272823 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2020-11-09 22:17:47.273170 (Thread-1): Began running node model.jaffle_shop.stg_payments
2020-11-09 22:17:47.274991 (Thread-1): 17:17:47 | 2 of 8 START view model public.stg_payments.......................... [RUN]
2020-11-09 22:17:47.275598 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:17:47.275848 (Thread-1): Compiling model.jaffle_shop.stg_payments
2020-11-09 22:17:47.291928 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2020-11-09 22:17:47.292531 (Thread-1): finished collecting timing info
2020-11-09 22:17:47.306048 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:17:47.306275 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbttest1"."public"."stg_payments__dbt_tmp" cascade
2020-11-09 22:17:47.306426 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 22:17:47.322150 (Thread-1): SQL status: DROP VIEW in 0.02 seconds
2020-11-09 22:17:47.326830 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:17:47.327069 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbttest1"."public"."stg_payments__dbt_backup" cascade
2020-11-09 22:17:47.328936 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-11-09 22:17:47.331001 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2020-11-09 22:17:47.331746 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:17:47.331878 (Thread-1): On model.jaffle_shop.stg_payments: BEGIN
2020-11-09 22:17:47.333993 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 22:17:47.334171 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:17:47.334294 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "dbttest1"."public"."stg_payments__dbt_tmp" as (
    with source as (
    select * from "dbttest1"."public"."raw_payments"

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        --`amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed
  );

2020-11-09 22:17:47.338344 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-11-09 22:17:47.344901 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:17:47.345077 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbttest1"."public"."stg_payments" rename to "stg_payments__dbt_backup"
2020-11-09 22:17:47.347140 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:17:47.350818 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:17:47.351028 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbttest1"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
2020-11-09 22:17:47.354107 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:17:47.356240 (Thread-1): On model.jaffle_shop.stg_payments: COMMIT
2020-11-09 22:17:47.356489 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:17:47.356671 (Thread-1): On model.jaffle_shop.stg_payments: COMMIT
2020-11-09 22:17:47.358513 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 22:17:47.361413 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:17:47.361559 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbttest1"."public"."stg_payments__dbt_backup" cascade
2020-11-09 22:17:47.364340 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-11-09 22:17:47.368253 (Thread-1): finished collecting timing info
2020-11-09 22:17:47.368659 (Thread-1): On model.jaffle_shop.stg_payments: Close
2020-11-09 22:17:47.369859 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a414a40-e3d7-4902-8a27-3c0c50325348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9473a0>]}
2020-11-09 22:17:47.371403 (Thread-1): 17:17:47 | 2 of 8 OK created view model public.stg_payments..................... [CREATE VIEW in 0.09s]
2020-11-09 22:17:47.371590 (Thread-1): Finished running node model.jaffle_shop.stg_payments
2020-11-09 22:17:47.371754 (Thread-1): Began running node model.jaffle_shop.stg_customers
2020-11-09 22:17:47.373960 (Thread-1): 17:17:47 | 3 of 8 START view model public.stg_customers......................... [RUN]
2020-11-09 22:17:47.374472 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 22:17:47.374719 (Thread-1): Compiling model.jaffle_shop.stg_customers
2020-11-09 22:17:47.390982 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2020-11-09 22:17:47.391514 (Thread-1): finished collecting timing info
2020-11-09 22:17:47.405048 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 22:17:47.405268 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbttest1"."public"."stg_customers__dbt_tmp" cascade
2020-11-09 22:17:47.405415 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 22:17:47.418269 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-11-09 22:17:47.422165 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 22:17:47.422374 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbttest1"."public"."stg_customers__dbt_backup" cascade
2020-11-09 22:17:47.424465 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-11-09 22:17:47.426299 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2020-11-09 22:17:47.426968 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 22:17:47.427249 (Thread-1): On model.jaffle_shop.stg_customers: BEGIN
2020-11-09 22:17:47.429584 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 22:17:47.429953 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 22:17:47.430166 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "dbttest1"."public"."stg_customers__dbt_tmp" as (
    with source as (
    select * from "dbttest1"."public"."raw_customers"

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name,
        email

    from source

)

select * from renamed
  );

2020-11-09 22:17:47.438556 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-11-09 22:17:47.444613 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 22:17:47.444828 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbttest1"."public"."stg_customers" rename to "stg_customers__dbt_backup"
2020-11-09 22:17:47.453339 (Thread-1): SQL status: ALTER TABLE in 0.01 seconds
2020-11-09 22:17:47.457772 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 22:17:47.457959 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbttest1"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
2020-11-09 22:17:47.460939 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:17:47.463435 (Thread-1): On model.jaffle_shop.stg_customers: COMMIT
2020-11-09 22:17:47.463726 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 22:17:47.463930 (Thread-1): On model.jaffle_shop.stg_customers: COMMIT
2020-11-09 22:17:47.472506 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-11-09 22:17:47.477060 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 22:17:47.477234 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbttest1"."public"."stg_customers__dbt_backup" cascade
2020-11-09 22:17:47.480994 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-11-09 22:17:47.485112 (Thread-1): finished collecting timing info
2020-11-09 22:17:47.485550 (Thread-1): On model.jaffle_shop.stg_customers: Close
2020-11-09 22:17:47.486702 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a414a40-e3d7-4902-8a27-3c0c50325348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9bd250>]}
2020-11-09 22:17:47.488229 (Thread-1): 17:17:47 | 3 of 8 OK created view model public.stg_customers.................... [CREATE VIEW in 0.11s]
2020-11-09 22:17:47.488416 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2020-11-09 22:17:47.488736 (Thread-1): Began running node model.jaffle_shop.customer_orders
2020-11-09 22:17:47.490438 (Thread-1): 17:17:47 | 4 of 8 START table model public.customer_orders...................... [RUN]
2020-11-09 22:17:47.491159 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 22:17:47.491375 (Thread-1): Compiling model.jaffle_shop.customer_orders
2020-11-09 22:17:47.503378 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customer_orders"
2020-11-09 22:17:47.504015 (Thread-1): finished collecting timing info
2020-11-09 22:17:47.537940 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 22:17:47.538141 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
drop table if exists "dbttest1"."public"."customer_orders__dbt_tmp" cascade
2020-11-09 22:17:47.538259 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 22:17:47.549954 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-11-09 22:17:47.552970 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 22:17:47.553143 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
drop table if exists "dbttest1"."public"."customer_orders__dbt_backup" cascade
2020-11-09 22:17:47.554782 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 22:17:47.562907 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customer_orders"
2020-11-09 22:17:47.563570 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 22:17:47.563781 (Thread-1): On model.jaffle_shop.customer_orders: BEGIN
2020-11-09 22:17:47.566667 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 22:17:47.566968 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 22:17:47.567084 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */


  create  table "dbttest1"."public"."customer_orders__dbt_tmp"
  as (
    with orders as (

    select * from "dbttest1"."public"."stg_orders"

),

final as (

    select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by 1

)

select * from final
  );
2020-11-09 22:17:47.573702 (Thread-1): SQL status: SELECT 63 in 0.01 seconds
2020-11-09 22:17:47.580781 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 22:17:47.581071 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
alter table "dbttest1"."public"."customer_orders" rename to "customer_orders__dbt_backup"
2020-11-09 22:17:47.583545 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:17:47.589249 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 22:17:47.589434 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
alter table "dbttest1"."public"."customer_orders__dbt_tmp" rename to "customer_orders"
2020-11-09 22:17:47.591357 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:17:47.593102 (Thread-1): On model.jaffle_shop.customer_orders: COMMIT
2020-11-09 22:17:47.593294 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 22:17:47.593453 (Thread-1): On model.jaffle_shop.customer_orders: COMMIT
2020-11-09 22:17:47.595494 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 22:17:47.598635 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 22:17:47.598812 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
drop table if exists "dbttest1"."public"."customer_orders__dbt_backup" cascade
2020-11-09 22:17:47.602169 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 22:17:47.605617 (Thread-1): finished collecting timing info
2020-11-09 22:17:47.606166 (Thread-1): On model.jaffle_shop.customer_orders: Close
2020-11-09 22:17:47.607009 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a414a40-e3d7-4902-8a27-3c0c50325348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a91cf40>]}
2020-11-09 22:17:47.609207 (Thread-1): 17:17:47 | 4 of 8 OK created table model public.customer_orders................. [SELECT 63 in 0.12s]
2020-11-09 22:17:47.609467 (Thread-1): Finished running node model.jaffle_shop.customer_orders
2020-11-09 22:17:47.609715 (Thread-1): Began running node model.jaffle_shop.customer_payments
2020-11-09 22:17:47.611982 (Thread-1): 17:17:47 | 5 of 8 START table model public.customer_payments.................... [RUN]
2020-11-09 22:17:47.612568 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 22:17:47.612820 (Thread-1): Compiling model.jaffle_shop.customer_payments
2020-11-09 22:17:47.626776 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customer_payments"
2020-11-09 22:17:47.627269 (Thread-1): finished collecting timing info
2020-11-09 22:17:47.641275 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 22:17:47.641456 (Thread-1): On model.jaffle_shop.customer_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_payments"} */
drop table if exists "dbttest1"."public"."customer_payments__dbt_tmp" cascade
2020-11-09 22:17:47.641610 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 22:17:47.656539 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-11-09 22:17:47.659824 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 22:17:47.659973 (Thread-1): On model.jaffle_shop.customer_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_payments"} */
drop table if exists "dbttest1"."public"."customer_payments__dbt_backup" cascade
2020-11-09 22:17:47.661561 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 22:17:47.663634 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customer_payments"
2020-11-09 22:17:47.664296 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 22:17:47.664432 (Thread-1): On model.jaffle_shop.customer_payments: BEGIN
2020-11-09 22:17:47.666382 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 22:17:47.666662 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 22:17:47.666773 (Thread-1): On model.jaffle_shop.customer_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_payments"} */


  create  table "dbttest1"."public"."customer_payments__dbt_tmp"
  as (
    with payments as (

    select * from "dbttest1"."public"."stg_payments"

),

orders as (

    select * from "dbttest1"."public"."stg_orders"

),

final as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders using (order_id)

    group by 1

)

select * from final
  );
2020-11-09 22:17:47.673015 (Thread-1): SQL status: SELECT 63 in 0.01 seconds
2020-11-09 22:17:47.679543 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 22:17:47.679698 (Thread-1): On model.jaffle_shop.customer_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_payments"} */
alter table "dbttest1"."public"."customer_payments" rename to "customer_payments__dbt_backup"
2020-11-09 22:17:47.681798 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:17:47.685180 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 22:17:47.685376 (Thread-1): On model.jaffle_shop.customer_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_payments"} */
alter table "dbttest1"."public"."customer_payments__dbt_tmp" rename to "customer_payments"
2020-11-09 22:17:47.687453 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:17:47.689180 (Thread-1): On model.jaffle_shop.customer_payments: COMMIT
2020-11-09 22:17:47.689426 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 22:17:47.689561 (Thread-1): On model.jaffle_shop.customer_payments: COMMIT
2020-11-09 22:17:47.695289 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-11-09 22:17:47.697543 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 22:17:47.697688 (Thread-1): On model.jaffle_shop.customer_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_payments"} */
drop table if exists "dbttest1"."public"."customer_payments__dbt_backup" cascade
2020-11-09 22:17:47.701657 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 22:17:47.705202 (Thread-1): finished collecting timing info
2020-11-09 22:17:47.705638 (Thread-1): On model.jaffle_shop.customer_payments: Close
2020-11-09 22:17:47.707003 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a414a40-e3d7-4902-8a27-3c0c50325348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a953f70>]}
2020-11-09 22:17:47.709090 (Thread-1): 17:17:47 | 5 of 8 OK created table model public.customer_payments............... [SELECT 63 in 0.09s]
2020-11-09 22:17:47.709359 (Thread-1): Finished running node model.jaffle_shop.customer_payments
2020-11-09 22:17:47.709622 (Thread-1): Began running node model.jaffle_shop.order_payments
2020-11-09 22:17:47.711435 (Thread-1): 17:17:47 | 6 of 8 START table model public.order_payments....................... [RUN]
2020-11-09 22:17:47.712163 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:17:47.712371 (Thread-1): Compiling model.jaffle_shop.order_payments
2020-11-09 22:17:47.733076 (Thread-1): Writing injected SQL for node "model.jaffle_shop.order_payments"
2020-11-09 22:17:47.733798 (Thread-1): finished collecting timing info
2020-11-09 22:17:47.746616 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:17:47.746965 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */
drop table if exists "dbttest1"."public"."order_payments__dbt_tmp" cascade
2020-11-09 22:17:47.747107 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 22:17:47.766365 (Thread-1): SQL status: DROP TABLE in 0.02 seconds
2020-11-09 22:17:47.772857 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:17:47.773138 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */
drop table if exists "dbttest1"."public"."order_payments__dbt_backup" cascade
2020-11-09 22:17:47.775354 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 22:17:47.778581 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.order_payments"
2020-11-09 22:17:47.782473 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:17:47.782715 (Thread-1): On model.jaffle_shop.order_payments: BEGIN
2020-11-09 22:17:47.785635 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 22:17:47.785942 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:17:47.786093 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */


  create  table "dbttest1"."public"."order_payments__dbt_tmp"
  as (
    

with payments as (

    select * from "dbttest1"."public"."stg_payments"

),

final as (

    select
        order_id,

        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,
        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,
        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,
        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,
        sum(amount) as total_amount

    from payments

    group by 1

)

select * from final
  );
2020-11-09 22:17:47.799443 (Thread-1): SQL status: SELECT 99 in 0.01 seconds
2020-11-09 22:17:47.806448 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:17:47.806613 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */
alter table "dbttest1"."public"."order_payments" rename to "order_payments__dbt_backup"
2020-11-09 22:17:47.809732 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:17:47.814484 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:17:47.814706 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */
alter table "dbttest1"."public"."order_payments__dbt_tmp" rename to "order_payments"
2020-11-09 22:17:47.820729 (Thread-1): SQL status: ALTER TABLE in 0.01 seconds
2020-11-09 22:17:47.822972 (Thread-1): On model.jaffle_shop.order_payments: COMMIT
2020-11-09 22:17:47.823189 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:17:47.823291 (Thread-1): On model.jaffle_shop.order_payments: COMMIT
2020-11-09 22:17:47.825262 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 22:17:47.828062 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:17:47.828197 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */
drop table if exists "dbttest1"."public"."order_payments__dbt_backup" cascade
2020-11-09 22:17:47.831872 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 22:17:47.836175 (Thread-1): finished collecting timing info
2020-11-09 22:17:47.836549 (Thread-1): On model.jaffle_shop.order_payments: Close
2020-11-09 22:17:47.837830 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a414a40-e3d7-4902-8a27-3c0c50325348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8d2100>]}
2020-11-09 22:17:47.841275 (Thread-1): 17:17:47 | 6 of 8 OK created table model public.order_payments.................. [SELECT 99 in 0.13s]
2020-11-09 22:17:47.841561 (Thread-1): Finished running node model.jaffle_shop.order_payments
2020-11-09 22:17:47.841848 (Thread-1): Began running node model.jaffle_shop.dim_customers
2020-11-09 22:17:47.843925 (Thread-1): 17:17:47 | 7 of 8 START table model public.dim_customers........................ [RUN]
2020-11-09 22:17:47.844764 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 22:17:47.844949 (Thread-1): Compiling model.jaffle_shop.dim_customers
2020-11-09 22:17:47.875632 (Thread-1): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2020-11-09 22:17:47.876333 (Thread-1): finished collecting timing info
2020-11-09 22:17:47.890362 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 22:17:47.890573 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "dbttest1"."public"."dim_customers__dbt_tmp" cascade
2020-11-09 22:17:47.890754 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 22:17:47.908912 (Thread-1): SQL status: DROP TABLE in 0.02 seconds
2020-11-09 22:17:47.914944 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 22:17:47.915221 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "dbttest1"."public"."dim_customers__dbt_backup" cascade
2020-11-09 22:17:47.917071 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 22:17:47.919888 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2020-11-09 22:17:47.920694 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 22:17:47.921016 (Thread-1): On model.jaffle_shop.dim_customers: BEGIN
2020-11-09 22:17:47.923982 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 22:17:47.924152 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 22:17:47.924331 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */


  create  table "dbttest1"."public"."dim_customers__dbt_tmp"
  as (
    with customers as (

    select * from "dbttest1"."public"."stg_customers"

),

customer_orders as (

    select * from "dbttest1"."public"."customer_orders"

),

customer_payments as (

    select * from "dbttest1"."public"."customer_payments"

),

final as (

    select
        customers.customer_id,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders using (customer_id)

    left join customer_payments using (customer_id)

)

select * from final
  );
2020-11-09 22:17:47.934391 (Thread-1): SQL status: SELECT 100 in 0.01 seconds
2020-11-09 22:17:47.942017 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 22:17:47.942203 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbttest1"."public"."dim_customers" rename to "dim_customers__dbt_backup"
2020-11-09 22:17:47.944150 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:17:47.948867 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 22:17:47.949153 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbttest1"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
2020-11-09 22:17:47.951236 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:17:47.953589 (Thread-1): On model.jaffle_shop.dim_customers: COMMIT
2020-11-09 22:17:47.953734 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 22:17:47.953824 (Thread-1): On model.jaffle_shop.dim_customers: COMMIT
2020-11-09 22:17:47.955768 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 22:17:47.959321 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 22:17:47.959510 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "dbttest1"."public"."dim_customers__dbt_backup" cascade
2020-11-09 22:17:47.964977 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-11-09 22:17:47.970044 (Thread-1): finished collecting timing info
2020-11-09 22:17:47.970548 (Thread-1): On model.jaffle_shop.dim_customers: Close
2020-11-09 22:17:47.971781 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a414a40-e3d7-4902-8a27-3c0c50325348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aabe370>]}
2020-11-09 22:17:47.973992 (Thread-1): 17:17:47 | 7 of 8 OK created table model public.dim_customers................... [SELECT 100 in 0.13s]
2020-11-09 22:17:47.974488 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2020-11-09 22:17:47.974795 (Thread-1): Began running node model.jaffle_shop.fct_orders
2020-11-09 22:17:47.976769 (Thread-1): 17:17:47 | 8 of 8 START table model public.fct_orders........................... [RUN]
2020-11-09 22:17:47.977480 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:17:47.977634 (Thread-1): Compiling model.jaffle_shop.fct_orders
2020-11-09 22:17:48.009808 (Thread-1): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2020-11-09 22:17:48.010451 (Thread-1): finished collecting timing info
2020-11-09 22:17:48.023710 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:17:48.023861 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "dbttest1"."public"."fct_orders__dbt_tmp" cascade
2020-11-09 22:17:48.023956 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 22:17:48.037912 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-11-09 22:17:48.043641 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:17:48.043954 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "dbttest1"."public"."fct_orders__dbt_backup" cascade
2020-11-09 22:17:48.045815 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 22:17:48.048439 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.fct_orders"
2020-11-09 22:17:48.049143 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:17:48.049277 (Thread-1): On model.jaffle_shop.fct_orders: BEGIN
2020-11-09 22:17:48.051759 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 22:17:48.052064 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:17:48.052197 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */


  create  table "dbttest1"."public"."fct_orders__dbt_tmp"
  as (
    

with orders as (

    select * from "dbttest1"."public"."stg_orders"

),

order_payments as (

    select * from "dbttest1"."public"."order_payments"

),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.status,

        order_payments.credit_card_amount,

        order_payments.coupon_amount,

        order_payments.bank_transfer_amount,

        order_payments.gift_card_amount,

        order_payments.total_amount as amount

    from orders

    left join order_payments using (order_id)

)

select * from final
  );
2020-11-09 22:17:48.061839 (Thread-1): SQL status: SELECT 100 in 0.01 seconds
2020-11-09 22:17:48.070237 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:17:48.070778 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbttest1"."public"."fct_orders" rename to "fct_orders__dbt_backup"
2020-11-09 22:17:48.072677 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:17:48.077327 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:17:48.077585 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbttest1"."public"."fct_orders__dbt_tmp" rename to "fct_orders"
2020-11-09 22:17:48.080132 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:17:48.082486 (Thread-1): On model.jaffle_shop.fct_orders: COMMIT
2020-11-09 22:17:48.082699 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:17:48.082871 (Thread-1): On model.jaffle_shop.fct_orders: COMMIT
2020-11-09 22:17:48.085127 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 22:17:48.088979 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:17:48.089177 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "dbttest1"."public"."fct_orders__dbt_backup" cascade
2020-11-09 22:17:48.094767 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-11-09 22:17:48.099436 (Thread-1): finished collecting timing info
2020-11-09 22:17:48.099883 (Thread-1): On model.jaffle_shop.fct_orders: Close
2020-11-09 22:17:48.101159 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a414a40-e3d7-4902-8a27-3c0c50325348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8d0280>]}
2020-11-09 22:17:48.104085 (Thread-1): 17:17:48 | 8 of 8 OK created table model public.fct_orders...................... [SELECT 100 in 0.12s]
2020-11-09 22:17:48.104397 (Thread-1): Finished running node model.jaffle_shop.fct_orders
2020-11-09 22:17:48.106123 (MainThread): Acquiring new postgres connection "master".
2020-11-09 22:17:48.106448 (MainThread): Using postgres connection "master".
2020-11-09 22:17:48.106662 (MainThread): On master: BEGIN
2020-11-09 22:17:48.106848 (MainThread): Opening a new connection, currently in state closed
2020-11-09 22:17:48.122366 (MainThread): SQL status: BEGIN in 0.02 seconds
2020-11-09 22:17:48.122697 (MainThread): On master: COMMIT
2020-11-09 22:17:48.122910 (MainThread): Using postgres connection "master".
2020-11-09 22:17:48.123082 (MainThread): On master: COMMIT
2020-11-09 22:17:48.124685 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-11-09 22:17:48.124870 (MainThread): On master: Close
2020-11-09 22:17:48.125348 (MainThread): 17:17:48 | 
2020-11-09 22:17:48.125498 (MainThread): 17:17:48 | Finished running 3 view models, 5 table models in 1.31s.
2020-11-09 22:17:48.125612 (MainThread): Connection 'master' was properly closed.
2020-11-09 22:17:48.125815 (MainThread): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2020-11-09 22:17:48.176211 (MainThread): 
2020-11-09 22:17:48.176462 (MainThread): Completed successfully
2020-11-09 22:17:48.176737 (MainThread): 
Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
2020-11-09 22:17:48.177068 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9da5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9da0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9da190>]}
2020-11-09 22:17:48.177394 (MainThread): Flushing usage events
2020-11-09 22:18:59.998296 (MainThread): Running with dbt=0.18.1
2020-11-09 22:19:01.416913 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=True, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['state:modified'], partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=PosixPath('/tmp/target'), strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-09 22:19:01.417424 (MainThread): Tracking: tracking
2020-11-09 22:19:01.429647 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106517be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106501fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106501490>]}
2020-11-09 22:19:01.453754 (MainThread): Partial parsing not enabled
2020-11-09 22:19:01.455137 (MainThread): Parsing macros/catalog.sql
2020-11-09 22:19:01.458687 (MainThread): Parsing macros/relations.sql
2020-11-09 22:19:01.460523 (MainThread): Parsing macros/adapters.sql
2020-11-09 22:19:01.485407 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-11-09 22:19:01.488966 (MainThread): Parsing macros/core.sql
2020-11-09 22:19:01.493028 (MainThread): Parsing macros/materializations/helpers.sql
2020-11-09 22:19:01.503088 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-11-09 22:19:01.505341 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-11-09 22:19:01.526470 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-11-09 22:19:01.560008 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-11-09 22:19:01.585591 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-11-09 22:19:01.587747 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-11-09 22:19:01.594240 (MainThread): Parsing macros/materializations/common/merge.sql
2020-11-09 22:19:01.614689 (MainThread): Parsing macros/materializations/table/table.sql
2020-11-09 22:19:01.629384 (MainThread): Parsing macros/materializations/view/view.sql
2020-11-09 22:19:01.637036 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-11-09 22:19:01.642398 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-11-09 22:19:01.643512 (MainThread): Parsing macros/etc/query.sql
2020-11-09 22:19:01.644730 (MainThread): Parsing macros/etc/is_incremental.sql
2020-11-09 22:19:01.646745 (MainThread): Parsing macros/etc/datetime.sql
2020-11-09 22:19:01.657283 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-11-09 22:19:01.660209 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-11-09 22:19:01.662058 (MainThread): Parsing macros/adapters/common.sql
2020-11-09 22:19:01.804893 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-11-09 22:19:01.808661 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-11-09 22:19:01.811902 (MainThread): Parsing macros/schema_tests/unique.sql
2020-11-09 22:19:01.814914 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-11-09 22:19:01.828431 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2020-11-09 22:19:01.828708 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '945fe7aa-f4ed-4ce5-966c-72482aeb884c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f96040>]}
2020-11-09 22:19:01.829669 (MainThread): Partial parsing not enabled
2020-11-09 22:19:01.871362 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 22:19:01.890999 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:19:01.898917 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:19:01.908108 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 22:19:01.917393 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:19:01.926154 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:19:01.933289 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 22:19:01.942101 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 22:19:02.494986 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 3 seed files, 1 source
2020-11-09 22:19:02.498480 (MainThread): 
2020-11-09 22:19:02.498978 (MainThread): Merged 10 items from state (sample: ['seed.jaffle_shop.raw_payments', 'model.jaffle_shop.dim_customers', 'model.jaffle_shop.customer_payments', 'model.jaffle_shop.customer_orders', 'model.jaffle_shop.order_payments'])
2020-11-09 22:19:02.581703 (MainThread): Acquiring new postgres connection "master".
2020-11-09 22:19:02.583134 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dbttest1".
2020-11-09 22:19:02.592473 (ThreadPoolExecutor-0_0): Using postgres connection "list_dbttest1".
2020-11-09 22:19:02.592601 (ThreadPoolExecutor-0_0): On list_dbttest1: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1"} */

    select distinct nspname from pg_namespace
  
2020-11-09 22:19:02.592687 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-09 22:19:02.607565 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2020-11-09 22:19:02.610179 (ThreadPoolExecutor-0_0): On list_dbttest1: Close
2020-11-09 22:19:02.651240 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dbttest1_public".
2020-11-09 22:19:02.657224 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2020-11-09 22:19:02.657358 (ThreadPoolExecutor-1_0): On list_dbttest1_public: BEGIN
2020-11-09 22:19:02.657466 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2020-11-09 22:19:02.665194 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2020-11-09 22:19:02.665352 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2020-11-09 22:19:02.665458 (ThreadPoolExecutor-1_0): On list_dbttest1_public: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1_public"} */
select
      'dbttest1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbttest1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-11-09 22:19:02.669678 (ThreadPoolExecutor-1_0): SQL status: SELECT 12 in 0.00 seconds
2020-11-09 22:19:02.678150 (ThreadPoolExecutor-1_0): On list_dbttest1_public: ROLLBACK
2020-11-09 22:19:02.679213 (ThreadPoolExecutor-1_0): On list_dbttest1_public: Close
2020-11-09 22:19:02.717750 (MainThread): Using postgres connection "master".
2020-11-09 22:19:02.717878 (MainThread): On master: BEGIN
2020-11-09 22:19:02.717962 (MainThread): Opening a new connection, currently in state init
2020-11-09 22:19:02.726676 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-11-09 22:19:02.726832 (MainThread): Using postgres connection "master".
2020-11-09 22:19:02.726918 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-11-09 22:19:02.732761 (MainThread): SQL status: SELECT 4 in 0.01 seconds
2020-11-09 22:19:02.737320 (MainThread): On master: ROLLBACK
2020-11-09 22:19:02.738350 (MainThread): Using postgres connection "master".
2020-11-09 22:19:02.738475 (MainThread): On master: BEGIN
2020-11-09 22:19:02.740139 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-11-09 22:19:02.740286 (MainThread): On master: COMMIT
2020-11-09 22:19:02.740381 (MainThread): Using postgres connection "master".
2020-11-09 22:19:02.740458 (MainThread): On master: COMMIT
2020-11-09 22:19:02.741356 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-11-09 22:19:02.741501 (MainThread): On master: Close
2020-11-09 22:19:02.741787 (MainThread): 17:19:02 | Concurrency: 1 threads (target='dev')
2020-11-09 22:19:02.741919 (MainThread): 17:19:02 | 
2020-11-09 22:19:02.744825 (Thread-1): Began running node model.jaffle_shop.fct_orders
2020-11-09 22:19:02.745869 (Thread-1): 17:19:02 | 1 of 1 START table model public.fct_orders........................... [RUN]
2020-11-09 22:19:02.746197 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:19:02.746353 (Thread-1): Compiling model.jaffle_shop.fct_orders
2020-11-09 22:19:02.760354 (Thread-1): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2020-11-09 22:19:02.760817 (Thread-1): finished collecting timing info
2020-11-09 22:19:02.783824 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:19:02.783970 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "dbttest1"."public"."fct_orders__dbt_tmp" cascade
2020-11-09 22:19:02.784057 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 22:19:02.792131 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-11-09 22:19:02.794511 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:19:02.794623 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "dbttest1"."public"."fct_orders__dbt_backup" cascade
2020-11-09 22:19:02.795746 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 22:19:02.805814 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.fct_orders"
2020-11-09 22:19:02.806268 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:19:02.806363 (Thread-1): On model.jaffle_shop.fct_orders: BEGIN
2020-11-09 22:19:02.807687 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 22:19:02.807843 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:19:02.807931 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */


  create  table "dbttest1"."public"."fct_orders__dbt_tmp"
  as (
    

with orders as (

    select * from "dbttest1"."public"."stg_orders"

),

order_payments as (

    select * from "dbttest1"."public"."order_payments"

),

final as (

    select
	1 as something,
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.status,

        order_payments.credit_card_amount,

        order_payments.coupon_amount,

        order_payments.bank_transfer_amount,

        order_payments.gift_card_amount,

        order_payments.total_amount as amount

    from orders

    left join order_payments using (order_id)

)

select * from final
  );
2020-11-09 22:19:02.815280 (Thread-1): SQL status: SELECT 100 in 0.01 seconds
2020-11-09 22:19:02.822782 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:19:02.822955 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbttest1"."public"."fct_orders" rename to "fct_orders__dbt_backup"
2020-11-09 22:19:02.825242 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:19:02.827501 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:19:02.827605 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbttest1"."public"."fct_orders__dbt_tmp" rename to "fct_orders"
2020-11-09 22:19:02.829050 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:19:02.836101 (Thread-1): On model.jaffle_shop.fct_orders: COMMIT
2020-11-09 22:19:02.836263 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:19:02.836375 (Thread-1): On model.jaffle_shop.fct_orders: COMMIT
2020-11-09 22:19:02.838507 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 22:19:02.841873 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:19:02.841993 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "dbttest1"."public"."fct_orders__dbt_backup" cascade
2020-11-09 22:19:02.845448 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 22:19:02.847613 (Thread-1): finished collecting timing info
2020-11-09 22:19:02.847844 (Thread-1): On model.jaffle_shop.fct_orders: Close
2020-11-09 22:19:02.848330 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '945fe7aa-f4ed-4ce5-966c-72482aeb884c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066519d0>]}
2020-11-09 22:19:02.849568 (Thread-1): 17:19:02 | 1 of 1 OK created table model public.fct_orders...................... [SELECT 100 in 0.10s]
2020-11-09 22:19:02.849734 (Thread-1): Finished running node model.jaffle_shop.fct_orders
2020-11-09 22:19:02.850695 (MainThread): Acquiring new postgres connection "master".
2020-11-09 22:19:02.850919 (MainThread): Using postgres connection "master".
2020-11-09 22:19:02.851035 (MainThread): On master: BEGIN
2020-11-09 22:19:02.851137 (MainThread): Opening a new connection, currently in state closed
2020-11-09 22:19:02.858531 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-11-09 22:19:02.858697 (MainThread): On master: COMMIT
2020-11-09 22:19:02.858787 (MainThread): Using postgres connection "master".
2020-11-09 22:19:02.858863 (MainThread): On master: COMMIT
2020-11-09 22:19:02.859963 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-11-09 22:19:02.860103 (MainThread): On master: Close
2020-11-09 22:19:02.860465 (MainThread): 17:19:02 | 
2020-11-09 22:19:02.860611 (MainThread): 17:19:02 | Finished running 1 table model in 0.36s.
2020-11-09 22:19:02.860740 (MainThread): Connection 'master' was properly closed.
2020-11-09 22:19:02.860848 (MainThread): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2020-11-09 22:19:02.864949 (MainThread): 
2020-11-09 22:19:02.865103 (MainThread): Completed successfully
2020-11-09 22:19:02.865209 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-11-09 22:19:02.865380 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066527f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066c3130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066c34c0>]}
2020-11-09 22:19:02.865642 (MainThread): Flushing usage events
2020-11-09 22:19:13.941482 (MainThread): Running with dbt=0.18.1
2020-11-09 22:19:15.306750 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=True, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['state:modified+'], partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=PosixPath('/tmp/target'), strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-09 22:19:15.307216 (MainThread): Tracking: tracking
2020-11-09 22:19:15.316916 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4a18e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4d3f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4d3400>]}
2020-11-09 22:19:15.337661 (MainThread): Partial parsing not enabled
2020-11-09 22:19:15.338657 (MainThread): Parsing macros/catalog.sql
2020-11-09 22:19:15.341998 (MainThread): Parsing macros/relations.sql
2020-11-09 22:19:15.344304 (MainThread): Parsing macros/adapters.sql
2020-11-09 22:19:15.371997 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-11-09 22:19:15.375274 (MainThread): Parsing macros/core.sql
2020-11-09 22:19:15.379481 (MainThread): Parsing macros/materializations/helpers.sql
2020-11-09 22:19:15.389446 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-11-09 22:19:15.391395 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-11-09 22:19:15.409309 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-11-09 22:19:15.442689 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-11-09 22:19:15.466425 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-11-09 22:19:15.468483 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-11-09 22:19:15.475251 (MainThread): Parsing macros/materializations/common/merge.sql
2020-11-09 22:19:15.490527 (MainThread): Parsing macros/materializations/table/table.sql
2020-11-09 22:19:15.498014 (MainThread): Parsing macros/materializations/view/view.sql
2020-11-09 22:19:15.504670 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-11-09 22:19:15.509846 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-11-09 22:19:15.510854 (MainThread): Parsing macros/etc/query.sql
2020-11-09 22:19:15.512071 (MainThread): Parsing macros/etc/is_incremental.sql
2020-11-09 22:19:15.513857 (MainThread): Parsing macros/etc/datetime.sql
2020-11-09 22:19:15.523715 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-11-09 22:19:15.525828 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-11-09 22:19:15.527720 (MainThread): Parsing macros/adapters/common.sql
2020-11-09 22:19:15.600555 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-11-09 22:19:15.602669 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-11-09 22:19:15.604715 (MainThread): Parsing macros/schema_tests/unique.sql
2020-11-09 22:19:15.606589 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-11-09 22:19:15.615024 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2020-11-09 22:19:15.615348 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd3072d8e-8bae-424b-9eac-60b6d4312f68', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a501b80>]}
2020-11-09 22:19:15.616001 (MainThread): Partial parsing not enabled
2020-11-09 22:19:15.650766 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 22:19:15.666944 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:19:15.674593 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:19:15.683363 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 22:19:15.692394 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:19:15.701175 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:19:15.708557 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 22:19:15.716031 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 22:19:16.279920 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 3 seed files, 1 source
2020-11-09 22:19:16.283542 (MainThread): 
2020-11-09 22:19:16.283924 (MainThread): Merged 10 items from state (sample: ['seed.jaffle_shop.raw_customers', 'model.jaffle_shop.dim_customers', 'model.jaffle_shop.customer_orders', 'model.jaffle_shop.stg_payments', 'model.jaffle_shop.stg_customers'])
2020-11-09 22:19:16.363816 (MainThread): Acquiring new postgres connection "master".
2020-11-09 22:19:16.365848 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dbttest1".
2020-11-09 22:19:16.375839 (ThreadPoolExecutor-0_0): Using postgres connection "list_dbttest1".
2020-11-09 22:19:16.375976 (ThreadPoolExecutor-0_0): On list_dbttest1: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1"} */

    select distinct nspname from pg_namespace
  
2020-11-09 22:19:16.376068 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-09 22:19:16.384142 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2020-11-09 22:19:16.386381 (ThreadPoolExecutor-0_0): On list_dbttest1: Close
2020-11-09 22:19:16.423661 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dbttest1_public".
2020-11-09 22:19:16.430682 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2020-11-09 22:19:16.430825 (ThreadPoolExecutor-1_0): On list_dbttest1_public: BEGIN
2020-11-09 22:19:16.430911 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2020-11-09 22:19:16.442713 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2020-11-09 22:19:16.442885 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2020-11-09 22:19:16.443015 (ThreadPoolExecutor-1_0): On list_dbttest1_public: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1_public"} */
select
      'dbttest1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbttest1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-11-09 22:19:16.447845 (ThreadPoolExecutor-1_0): SQL status: SELECT 12 in 0.00 seconds
2020-11-09 22:19:16.462513 (ThreadPoolExecutor-1_0): On list_dbttest1_public: ROLLBACK
2020-11-09 22:19:16.464360 (ThreadPoolExecutor-1_0): On list_dbttest1_public: Close
2020-11-09 22:19:16.505248 (MainThread): Using postgres connection "master".
2020-11-09 22:19:16.505387 (MainThread): On master: BEGIN
2020-11-09 22:19:16.505475 (MainThread): Opening a new connection, currently in state init
2020-11-09 22:19:16.513395 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-11-09 22:19:16.513551 (MainThread): Using postgres connection "master".
2020-11-09 22:19:16.513639 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-11-09 22:19:16.520074 (MainThread): SQL status: SELECT 4 in 0.01 seconds
2020-11-09 22:19:16.524419 (MainThread): On master: ROLLBACK
2020-11-09 22:19:16.525573 (MainThread): Using postgres connection "master".
2020-11-09 22:19:16.525695 (MainThread): On master: BEGIN
2020-11-09 22:19:16.527642 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-11-09 22:19:16.527785 (MainThread): On master: COMMIT
2020-11-09 22:19:16.527877 (MainThread): Using postgres connection "master".
2020-11-09 22:19:16.527951 (MainThread): On master: COMMIT
2020-11-09 22:19:16.528989 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-11-09 22:19:16.529134 (MainThread): On master: Close
2020-11-09 22:19:16.529429 (MainThread): 17:19:16 | Concurrency: 1 threads (target='dev')
2020-11-09 22:19:16.529567 (MainThread): 17:19:16 | 
2020-11-09 22:19:16.532820 (Thread-1): Began running node model.jaffle_shop.fct_orders
2020-11-09 22:19:16.534070 (Thread-1): 17:19:16 | 1 of 1 START table model public.fct_orders........................... [RUN]
2020-11-09 22:19:16.534522 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:19:16.534768 (Thread-1): Compiling model.jaffle_shop.fct_orders
2020-11-09 22:19:16.548262 (Thread-1): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2020-11-09 22:19:16.549224 (Thread-1): finished collecting timing info
2020-11-09 22:19:16.573332 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:19:16.573489 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "dbttest1"."public"."fct_orders__dbt_tmp" cascade
2020-11-09 22:19:16.573579 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 22:19:16.582492 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-11-09 22:19:16.584800 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:19:16.584909 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "dbttest1"."public"."fct_orders__dbt_backup" cascade
2020-11-09 22:19:16.586108 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 22:19:16.596184 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.fct_orders"
2020-11-09 22:19:16.596655 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:19:16.596750 (Thread-1): On model.jaffle_shop.fct_orders: BEGIN
2020-11-09 22:19:16.597923 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 22:19:16.598129 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:19:16.598227 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */


  create  table "dbttest1"."public"."fct_orders__dbt_tmp"
  as (
    

with orders as (

    select * from "dbttest1"."public"."stg_orders"

),

order_payments as (

    select * from "dbttest1"."public"."order_payments"

),

final as (

    select
	1 as something,
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.status,

        order_payments.credit_card_amount,

        order_payments.coupon_amount,

        order_payments.bank_transfer_amount,

        order_payments.gift_card_amount,

        order_payments.total_amount as amount

    from orders

    left join order_payments using (order_id)

)

select * from final
  );
2020-11-09 22:19:16.603369 (Thread-1): SQL status: SELECT 100 in 0.01 seconds
2020-11-09 22:19:16.610683 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:19:16.610816 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbttest1"."public"."fct_orders" rename to "fct_orders__dbt_backup"
2020-11-09 22:19:16.612497 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:19:16.614750 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:19:16.614856 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbttest1"."public"."fct_orders__dbt_tmp" rename to "fct_orders"
2020-11-09 22:19:16.616591 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:19:16.623774 (Thread-1): On model.jaffle_shop.fct_orders: COMMIT
2020-11-09 22:19:16.623921 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:19:16.624004 (Thread-1): On model.jaffle_shop.fct_orders: COMMIT
2020-11-09 22:19:16.635708 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-11-09 22:19:16.641105 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:19:16.641245 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "dbttest1"."public"."fct_orders__dbt_backup" cascade
2020-11-09 22:19:16.644450 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 22:19:16.647515 (Thread-1): finished collecting timing info
2020-11-09 22:19:16.647798 (Thread-1): On model.jaffle_shop.fct_orders: Close
2020-11-09 22:19:16.648473 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3072d8e-8bae-424b-9eac-60b6d4312f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a63d5e0>]}
2020-11-09 22:19:16.650067 (Thread-1): 17:19:16 | 1 of 1 OK created table model public.fct_orders...................... [SELECT 100 in 0.11s]
2020-11-09 22:19:16.650290 (Thread-1): Finished running node model.jaffle_shop.fct_orders
2020-11-09 22:19:16.651455 (MainThread): Acquiring new postgres connection "master".
2020-11-09 22:19:16.651637 (MainThread): Using postgres connection "master".
2020-11-09 22:19:16.651728 (MainThread): On master: BEGIN
2020-11-09 22:19:16.651836 (MainThread): Opening a new connection, currently in state closed
2020-11-09 22:19:16.661111 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-11-09 22:19:16.661284 (MainThread): On master: COMMIT
2020-11-09 22:19:16.661383 (MainThread): Using postgres connection "master".
2020-11-09 22:19:16.661463 (MainThread): On master: COMMIT
2020-11-09 22:19:16.662520 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-11-09 22:19:16.662696 (MainThread): On master: Close
2020-11-09 22:19:16.663009 (MainThread): 17:19:16 | 
2020-11-09 22:19:16.663148 (MainThread): 17:19:16 | Finished running 1 table model in 0.38s.
2020-11-09 22:19:16.663309 (MainThread): Connection 'master' was properly closed.
2020-11-09 22:19:16.663448 (MainThread): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2020-11-09 22:19:16.667604 (MainThread): 
2020-11-09 22:19:16.667755 (MainThread): Completed successfully
2020-11-09 22:19:16.667859 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-11-09 22:19:16.668115 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6285e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a698730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a698ee0>]}
2020-11-09 22:19:16.668325 (MainThread): Flushing usage events
2020-11-09 22:21:30.800621 (MainThread): Running with dbt=0.18.1
2020-11-09 22:21:33.588405 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=True, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['config.materialized:incremental,state:modified+'], partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=PosixPath('/tmp/target'), strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-09 22:21:33.589482 (MainThread): Tracking: tracking
2020-11-09 22:21:33.608697 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103108e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110341f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110341400>]}
2020-11-09 22:21:33.645112 (MainThread): Partial parsing not enabled
2020-11-09 22:21:33.647130 (MainThread): Parsing macros/catalog.sql
2020-11-09 22:21:33.653243 (MainThread): Parsing macros/relations.sql
2020-11-09 22:21:33.656878 (MainThread): Parsing macros/adapters.sql
2020-11-09 22:21:33.698504 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-11-09 22:21:33.703510 (MainThread): Parsing macros/core.sql
2020-11-09 22:21:33.710730 (MainThread): Parsing macros/materializations/helpers.sql
2020-11-09 22:21:33.725004 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-11-09 22:21:33.727896 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-11-09 22:21:33.756175 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-11-09 22:21:33.817130 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-11-09 22:21:33.858461 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-11-09 22:21:33.861655 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-11-09 22:21:33.873937 (MainThread): Parsing macros/materializations/common/merge.sql
2020-11-09 22:21:33.900180 (MainThread): Parsing macros/materializations/table/table.sql
2020-11-09 22:21:33.913593 (MainThread): Parsing macros/materializations/view/view.sql
2020-11-09 22:21:33.928210 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-11-09 22:21:33.939559 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-11-09 22:21:33.941255 (MainThread): Parsing macros/etc/query.sql
2020-11-09 22:21:33.943633 (MainThread): Parsing macros/etc/is_incremental.sql
2020-11-09 22:21:33.946640 (MainThread): Parsing macros/etc/datetime.sql
2020-11-09 22:21:33.964776 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-11-09 22:21:33.968551 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-11-09 22:21:33.971682 (MainThread): Parsing macros/adapters/common.sql
2020-11-09 22:21:34.079072 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-11-09 22:21:34.082527 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-11-09 22:21:34.085504 (MainThread): Parsing macros/schema_tests/unique.sql
2020-11-09 22:21:34.088820 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-11-09 22:21:34.099666 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2020-11-09 22:21:34.099900 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9f1a17a4-a920-4348-a7a2-84a88360a23c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110371b80>]}
2020-11-09 22:21:34.101271 (MainThread): Partial parsing not enabled
2020-11-09 22:21:34.150163 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 22:21:34.174694 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:21:34.187559 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:21:34.199022 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 22:21:34.213103 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:21:34.227180 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:21:34.238585 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 22:21:34.251552 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 22:21:35.136816 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 3 seed files, 1 source
2020-11-09 22:21:35.141728 (MainThread): The selector 'config.materialized:incremental,state:modified+' does not match any nodes and will be ignored
2020-11-09 22:21:35.145503 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2020-11-09 22:21:35.145882 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104725b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110472e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110472b80>]}
2020-11-09 22:21:35.146369 (MainThread): Flushing usage events
2020-11-09 22:21:35.309505 (MainThread): Connection 'model.jaffle_shop.customer_orders' was properly closed.
2020-11-09 22:22:00.482051 (MainThread): Running with dbt=0.18.1
2020-11-09 22:22:03.689001 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=True, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['config.materialized:view,state:modified+'], partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=PosixPath('/tmp/target'), strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-09 22:22:03.689812 (MainThread): Tracking: tracking
2020-11-09 22:22:03.706324 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f0c1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f3df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f3d400>]}
2020-11-09 22:22:03.748720 (MainThread): Partial parsing not enabled
2020-11-09 22:22:03.750071 (MainThread): Parsing macros/catalog.sql
2020-11-09 22:22:03.755607 (MainThread): Parsing macros/relations.sql
2020-11-09 22:22:03.758335 (MainThread): Parsing macros/adapters.sql
2020-11-09 22:22:03.800783 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-11-09 22:22:03.807913 (MainThread): Parsing macros/core.sql
2020-11-09 22:22:03.815608 (MainThread): Parsing macros/materializations/helpers.sql
2020-11-09 22:22:03.832629 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-11-09 22:22:03.835427 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-11-09 22:22:03.865024 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-11-09 22:22:03.918440 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-11-09 22:22:03.958027 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-11-09 22:22:03.961479 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-11-09 22:22:03.973954 (MainThread): Parsing macros/materializations/common/merge.sql
2020-11-09 22:22:03.997662 (MainThread): Parsing macros/materializations/table/table.sql
2020-11-09 22:22:04.009008 (MainThread): Parsing macros/materializations/view/view.sql
2020-11-09 22:22:04.021407 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-11-09 22:22:04.029690 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-11-09 22:22:04.031292 (MainThread): Parsing macros/etc/query.sql
2020-11-09 22:22:04.033360 (MainThread): Parsing macros/etc/is_incremental.sql
2020-11-09 22:22:04.036078 (MainThread): Parsing macros/etc/datetime.sql
2020-11-09 22:22:04.053730 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-11-09 22:22:04.056932 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-11-09 22:22:04.059638 (MainThread): Parsing macros/adapters/common.sql
2020-11-09 22:22:04.175218 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-11-09 22:22:04.178625 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-11-09 22:22:04.181021 (MainThread): Parsing macros/schema_tests/unique.sql
2020-11-09 22:22:04.184367 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-11-09 22:22:04.197365 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2020-11-09 22:22:04.197637 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e933c48c-d1dc-4279-973c-8edbae713d47', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d70940>]}
2020-11-09 22:22:04.198569 (MainThread): Partial parsing not enabled
2020-11-09 22:22:04.246993 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 22:22:04.272877 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:22:04.284229 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:22:04.300743 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 22:22:04.313233 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:22:04.327386 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:22:04.340071 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 22:22:04.352182 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 22:22:05.231019 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 3 seed files, 1 source
2020-11-09 22:22:05.234962 (MainThread): The selector 'config.materialized:view,state:modified+' does not match any nodes and will be ignored
2020-11-09 22:22:05.239602 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2020-11-09 22:22:05.240027 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10506fe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10506fdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10506ffa0>]}
2020-11-09 22:22:05.240425 (MainThread): Flushing usage events
2020-11-09 22:22:05.374477 (MainThread): Connection 'model.jaffle_shop.customer_orders' was properly closed.
2020-11-09 22:23:53.507849 (MainThread): Running with dbt=0.18.1
2020-11-09 22:23:54.797147 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=True, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['state:modified+'], partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=PosixPath('/tmp/target'), strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-09 22:23:54.797622 (MainThread): Tracking: tracking
2020-11-09 22:23:54.807548 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe637c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe95f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe95460>]}
2020-11-09 22:23:54.841015 (MainThread): Partial parsing not enabled
2020-11-09 22:23:54.842513 (MainThread): Parsing macros/catalog.sql
2020-11-09 22:23:54.847909 (MainThread): Parsing macros/relations.sql
2020-11-09 22:23:54.850382 (MainThread): Parsing macros/adapters.sql
2020-11-09 22:23:54.874339 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-11-09 22:23:54.877767 (MainThread): Parsing macros/core.sql
2020-11-09 22:23:54.881939 (MainThread): Parsing macros/materializations/helpers.sql
2020-11-09 22:23:54.891670 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-11-09 22:23:54.893649 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-11-09 22:23:54.911752 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-11-09 22:23:54.944125 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-11-09 22:23:54.966275 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-11-09 22:23:54.968310 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-11-09 22:23:54.975011 (MainThread): Parsing macros/materializations/common/merge.sql
2020-11-09 22:23:54.990337 (MainThread): Parsing macros/materializations/table/table.sql
2020-11-09 22:23:54.997735 (MainThread): Parsing macros/materializations/view/view.sql
2020-11-09 22:23:55.004588 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-11-09 22:23:55.009797 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-11-09 22:23:55.010803 (MainThread): Parsing macros/etc/query.sql
2020-11-09 22:23:55.011945 (MainThread): Parsing macros/etc/is_incremental.sql
2020-11-09 22:23:55.013667 (MainThread): Parsing macros/etc/datetime.sql
2020-11-09 22:23:55.024270 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-11-09 22:23:55.026581 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-11-09 22:23:55.028823 (MainThread): Parsing macros/adapters/common.sql
2020-11-09 22:23:55.102301 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-11-09 22:23:55.104377 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-11-09 22:23:55.106090 (MainThread): Parsing macros/schema_tests/unique.sql
2020-11-09 22:23:55.107890 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-11-09 22:23:55.116053 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2020-11-09 22:23:55.116255 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'aa7842d2-a24d-475b-99c6-4c4c3d3de34f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fec3a60>]}
2020-11-09 22:23:55.117147 (MainThread): Partial parsing not enabled
2020-11-09 22:23:55.148394 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 22:23:55.165278 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:23:55.173873 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:23:55.181278 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 22:23:55.190088 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:23:55.199426 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:23:55.206714 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 22:23:55.214050 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 22:23:55.563637 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ffa03a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff94bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ffd8130>]}
2020-11-09 22:23:55.563876 (MainThread): Flushing usage events
2020-11-09 22:23:55.798882 (MainThread): Connection 'model.jaffle_shop.customer_orders' was properly closed.
2020-11-09 22:23:55.799212 (MainThread): Encountered an error:
2020-11-09 22:23:55.799468 (MainThread): Compilation Error in model stg_orders (models/staging/stg_orders.sql)
  Model 'model.jaffle_shop.stg_orders' (models/staging/stg_orders.sql) depends on a source named 'public.source1' which was not found
2020-11-09 22:23:55.806663 (MainThread): Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/main.py", line 255, in run_from_args
    results = task.run()
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/runnable.py", line 399, in run
    self._runtime_initialize()
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/runnable.py", line 118, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/runnable.py", line 78, in _runtime_initialize
    self.load_manifest()
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/runnable.py", line 65, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/parser/manifest.py", line 748, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/parser/manifest.py", line 351, in load_all
    manifest = loader.create_manifest()
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/parser/manifest.py", line 327, in create_manifest
    self.process_manifest(manifest)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/parser/manifest.py", line 297, in process_manifest
    process_sources(manifest, project_name)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/parser/manifest.py", line 706, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/parser/manifest.py", line 689, in _process_sources_for_node
    invalid_source_fail_unless_test(
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/parser/manifest.py", line 406, in invalid_source_fail_unless_test
    source_target_not_found(
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/exceptions.py", line 569, in source_target_not_found
    raise_compiler_error(msg, model)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model stg_orders (models/staging/stg_orders.sql)
  Model 'model.jaffle_shop.stg_orders' (models/staging/stg_orders.sql) depends on a source named 'public.source1' which was not found

2020-11-09 22:24:45.304957 (MainThread): Running with dbt=0.18.1
2020-11-09 22:24:46.603561 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=True, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['state:modified+'], partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=PosixPath('/tmp/target'), strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-09 22:24:46.604016 (MainThread): Tracking: tracking
2020-11-09 22:24:46.613998 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112feb820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ff2ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ff23d0>]}
2020-11-09 22:24:46.634733 (MainThread): Partial parsing not enabled
2020-11-09 22:24:46.635692 (MainThread): Parsing macros/catalog.sql
2020-11-09 22:24:46.639361 (MainThread): Parsing macros/relations.sql
2020-11-09 22:24:46.640971 (MainThread): Parsing macros/adapters.sql
2020-11-09 22:24:46.667447 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-11-09 22:24:46.672069 (MainThread): Parsing macros/core.sql
2020-11-09 22:24:46.678213 (MainThread): Parsing macros/materializations/helpers.sql
2020-11-09 22:24:46.688254 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-11-09 22:24:46.690176 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-11-09 22:24:46.708067 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-11-09 22:24:46.740913 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-11-09 22:24:46.763486 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-11-09 22:24:46.765564 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-11-09 22:24:46.773423 (MainThread): Parsing macros/materializations/common/merge.sql
2020-11-09 22:24:46.790562 (MainThread): Parsing macros/materializations/table/table.sql
2020-11-09 22:24:46.798268 (MainThread): Parsing macros/materializations/view/view.sql
2020-11-09 22:24:46.805171 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-11-09 22:24:46.810563 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-11-09 22:24:46.811630 (MainThread): Parsing macros/etc/query.sql
2020-11-09 22:24:46.812843 (MainThread): Parsing macros/etc/is_incremental.sql
2020-11-09 22:24:46.814705 (MainThread): Parsing macros/etc/datetime.sql
2020-11-09 22:24:46.824992 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-11-09 22:24:46.827332 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-11-09 22:24:46.829194 (MainThread): Parsing macros/adapters/common.sql
2020-11-09 22:24:46.908761 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-11-09 22:24:46.910865 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-11-09 22:24:46.912511 (MainThread): Parsing macros/schema_tests/unique.sql
2020-11-09 22:24:46.914335 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-11-09 22:24:46.922034 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2020-11-09 22:24:46.922198 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e93c535c-b0d0-491d-b1f6-15f7ac82eebf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a89040>]}
2020-11-09 22:24:46.922876 (MainThread): Partial parsing not enabled
2020-11-09 22:24:46.953238 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 22:24:46.970759 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:24:46.977435 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:24:46.984220 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 22:24:46.992957 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:24:47.001100 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:24:47.008941 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 22:24:47.016406 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 22:24:47.502668 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 3 seed files, 0 sources
2020-11-09 22:24:47.505957 (MainThread): 
2020-11-09 22:24:47.506219 (MainThread): Merged 4 items from state (sample: ['seed.jaffle_shop.raw_orders', 'model.jaffle_shop.stg_customers', 'seed.jaffle_shop.raw_payments', 'seed.jaffle_shop.raw_customers'])
2020-11-09 22:24:47.587977 (MainThread): Acquiring new postgres connection "master".
2020-11-09 22:24:47.595813 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dbttest1".
2020-11-09 22:24:47.605442 (ThreadPoolExecutor-0_0): Using postgres connection "list_dbttest1".
2020-11-09 22:24:47.605576 (ThreadPoolExecutor-0_0): On list_dbttest1: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1"} */

    select distinct nspname from pg_namespace
  
2020-11-09 22:24:47.605666 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-09 22:24:47.615696 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2020-11-09 22:24:47.618482 (ThreadPoolExecutor-0_0): On list_dbttest1: Close
2020-11-09 22:24:47.653224 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dbttest1_public".
2020-11-09 22:24:47.659875 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2020-11-09 22:24:47.660004 (ThreadPoolExecutor-1_0): On list_dbttest1_public: BEGIN
2020-11-09 22:24:47.660089 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2020-11-09 22:24:47.668337 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2020-11-09 22:24:47.668501 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2020-11-09 22:24:47.668590 (ThreadPoolExecutor-1_0): On list_dbttest1_public: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1_public"} */
select
      'dbttest1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbttest1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-11-09 22:24:47.671652 (ThreadPoolExecutor-1_0): SQL status: SELECT 12 in 0.00 seconds
2020-11-09 22:24:47.680467 (ThreadPoolExecutor-1_0): On list_dbttest1_public: ROLLBACK
2020-11-09 22:24:47.681643 (ThreadPoolExecutor-1_0): On list_dbttest1_public: Close
2020-11-09 22:24:47.719178 (MainThread): Using postgres connection "master".
2020-11-09 22:24:47.719311 (MainThread): On master: BEGIN
2020-11-09 22:24:47.719398 (MainThread): Opening a new connection, currently in state init
2020-11-09 22:24:47.727353 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-11-09 22:24:47.727505 (MainThread): Using postgres connection "master".
2020-11-09 22:24:47.727587 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-11-09 22:24:47.733581 (MainThread): SQL status: SELECT 4 in 0.01 seconds
2020-11-09 22:24:47.737926 (MainThread): On master: ROLLBACK
2020-11-09 22:24:47.739077 (MainThread): Using postgres connection "master".
2020-11-09 22:24:47.739193 (MainThread): On master: BEGIN
2020-11-09 22:24:47.741074 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-11-09 22:24:47.741217 (MainThread): On master: COMMIT
2020-11-09 22:24:47.741312 (MainThread): Using postgres connection "master".
2020-11-09 22:24:47.741406 (MainThread): On master: COMMIT
2020-11-09 22:24:47.742558 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-11-09 22:24:47.742718 (MainThread): On master: Close
2020-11-09 22:24:47.743033 (MainThread): 17:24:47 | Concurrency: 1 threads (target='dev')
2020-11-09 22:24:47.743165 (MainThread): 17:24:47 | 
2020-11-09 22:24:47.747346 (Thread-1): Began running node model.jaffle_shop.stg_orders
2020-11-09 22:24:47.748330 (Thread-1): 17:24:47 | 1 of 7 START view model public.stg_orders............................ [RUN]
2020-11-09 22:24:47.748648 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:24:47.748805 (Thread-1): Compiling model.jaffle_shop.stg_orders
2020-11-09 22:24:47.757741 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2020-11-09 22:24:47.758236 (Thread-1): finished collecting timing info
2020-11-09 22:24:47.786698 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:24:47.786851 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbttest1"."public"."stg_orders__dbt_tmp" cascade
2020-11-09 22:24:47.786942 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 22:24:47.795486 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-11-09 22:24:47.797820 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:24:47.797947 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbttest1"."public"."stg_orders__dbt_backup" cascade
2020-11-09 22:24:47.799206 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-11-09 22:24:47.804100 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2020-11-09 22:24:47.804548 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:24:47.804642 (Thread-1): On model.jaffle_shop.stg_orders: BEGIN
2020-11-09 22:24:47.805792 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 22:24:47.805955 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:24:47.806043 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "dbttest1"."public"."stg_orders__dbt_tmp" as (
    with source as (
    select * from "dbttest1"."public"."raw_orders"

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source
)

select * from renamed
  );

2020-11-09 22:24:47.812810 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-11-09 22:24:47.820841 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:24:47.820983 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbttest1"."public"."stg_orders" rename to "stg_orders__dbt_backup"
2020-11-09 22:24:47.823109 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:24:47.825475 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:24:47.825589 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbttest1"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
2020-11-09 22:24:47.826943 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:24:47.833310 (Thread-1): On model.jaffle_shop.stg_orders: COMMIT
2020-11-09 22:24:47.833449 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:24:47.833532 (Thread-1): On model.jaffle_shop.stg_orders: COMMIT
2020-11-09 22:24:47.835923 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 22:24:47.839251 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:24:47.839369 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbttest1"."public"."stg_orders__dbt_backup" cascade
2020-11-09 22:24:47.841451 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-11-09 22:24:47.843654 (Thread-1): finished collecting timing info
2020-11-09 22:24:47.843898 (Thread-1): On model.jaffle_shop.stg_orders: Close
2020-11-09 22:24:47.844747 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e93c535c-b0d0-491d-b1f6-15f7ac82eebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130f96a0>]}
2020-11-09 22:24:47.846569 (Thread-1): 17:24:47 | 1 of 7 OK created view model public.stg_orders....................... [CREATE VIEW in 0.10s]
2020-11-09 22:24:47.846856 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2020-11-09 22:24:47.847101 (Thread-1): Began running node model.jaffle_shop.stg_payments
2020-11-09 22:24:47.849034 (Thread-1): 17:24:47 | 2 of 7 START view model public.stg_payments.......................... [RUN]
2020-11-09 22:24:47.850061 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:24:47.850367 (Thread-1): Compiling model.jaffle_shop.stg_payments
2020-11-09 22:24:47.863594 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2020-11-09 22:24:47.864027 (Thread-1): finished collecting timing info
2020-11-09 22:24:47.870587 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:24:47.870712 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbttest1"."public"."stg_payments__dbt_tmp" cascade
2020-11-09 22:24:47.870801 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 22:24:47.881801 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-11-09 22:24:47.884801 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:24:47.884950 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbttest1"."public"."stg_payments__dbt_backup" cascade
2020-11-09 22:24:47.886476 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-11-09 22:24:47.887670 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2020-11-09 22:24:47.888097 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:24:47.888193 (Thread-1): On model.jaffle_shop.stg_payments: BEGIN
2020-11-09 22:24:47.889360 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 22:24:47.889512 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:24:47.889604 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "dbttest1"."public"."stg_payments__dbt_tmp" as (
    with source as (
    select * from "dbttest1"."public"."raw_payments"

),

renamed as (

    select
	1 as something,
        id as payment_id,
        order_id,
        payment_method,

        --`amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed
  );

2020-11-09 22:24:47.894077 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-11-09 22:24:47.897835 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:24:47.897964 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbttest1"."public"."stg_payments" rename to "stg_payments__dbt_backup"
2020-11-09 22:24:47.900342 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:24:47.902678 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:24:47.902787 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbttest1"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
2020-11-09 22:24:47.904113 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:24:47.905091 (Thread-1): On model.jaffle_shop.stg_payments: COMMIT
2020-11-09 22:24:47.905191 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:24:47.905265 (Thread-1): On model.jaffle_shop.stg_payments: COMMIT
2020-11-09 22:24:47.906417 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 22:24:47.908095 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:24:47.908208 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbttest1"."public"."stg_payments__dbt_backup" cascade
2020-11-09 22:24:47.909842 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-11-09 22:24:47.911948 (Thread-1): finished collecting timing info
2020-11-09 22:24:47.912181 (Thread-1): On model.jaffle_shop.stg_payments: Close
2020-11-09 22:24:47.912669 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e93c535c-b0d0-491d-b1f6-15f7ac82eebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131d8040>]}
2020-11-09 22:24:47.913608 (Thread-1): 17:24:47 | 2 of 7 OK created view model public.stg_payments..................... [CREATE VIEW in 0.06s]
2020-11-09 22:24:47.913744 (Thread-1): Finished running node model.jaffle_shop.stg_payments
2020-11-09 22:24:47.913868 (Thread-1): Began running node model.jaffle_shop.customer_orders
2020-11-09 22:24:47.915234 (Thread-1): 17:24:47 | 3 of 7 START table model public.customer_orders...................... [RUN]
2020-11-09 22:24:47.915867 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 22:24:47.916005 (Thread-1): Compiling model.jaffle_shop.customer_orders
2020-11-09 22:24:47.923274 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customer_orders"
2020-11-09 22:24:47.923812 (Thread-1): finished collecting timing info
2020-11-09 22:24:47.943393 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 22:24:47.943543 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
drop table if exists "dbttest1"."public"."customer_orders__dbt_tmp" cascade
2020-11-09 22:24:47.943630 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 22:24:47.951405 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-11-09 22:24:47.954638 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 22:24:47.954838 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
drop table if exists "dbttest1"."public"."customer_orders__dbt_backup" cascade
2020-11-09 22:24:47.956330 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 22:24:47.962473 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customer_orders"
2020-11-09 22:24:47.962932 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 22:24:47.963031 (Thread-1): On model.jaffle_shop.customer_orders: BEGIN
2020-11-09 22:24:47.964852 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 22:24:47.965014 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 22:24:47.965108 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */


  create  table "dbttest1"."public"."customer_orders__dbt_tmp"
  as (
    with orders as (

    select * from "dbttest1"."public"."stg_orders"

),

final as (

    select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by 1

)

select * from final
  );
2020-11-09 22:24:47.971415 (Thread-1): SQL status: SELECT 62 in 0.01 seconds
2020-11-09 22:24:47.976838 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 22:24:47.976975 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
alter table "dbttest1"."public"."customer_orders" rename to "customer_orders__dbt_backup"
2020-11-09 22:24:47.978519 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:24:47.980821 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 22:24:47.980927 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
alter table "dbttest1"."public"."customer_orders__dbt_tmp" rename to "customer_orders"
2020-11-09 22:24:47.982046 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:24:47.983021 (Thread-1): On model.jaffle_shop.customer_orders: COMMIT
2020-11-09 22:24:47.983120 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 22:24:47.983194 (Thread-1): On model.jaffle_shop.customer_orders: COMMIT
2020-11-09 22:24:47.984820 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 22:24:47.986459 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 22:24:47.986562 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
drop table if exists "dbttest1"."public"."customer_orders__dbt_backup" cascade
2020-11-09 22:24:47.988817 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 22:24:47.991525 (Thread-1): finished collecting timing info
2020-11-09 22:24:47.991910 (Thread-1): On model.jaffle_shop.customer_orders: Close
2020-11-09 22:24:47.993191 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e93c535c-b0d0-491d-b1f6-15f7ac82eebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131622b0>]}
2020-11-09 22:24:47.994940 (Thread-1): 17:24:47 | 3 of 7 OK created table model public.customer_orders................. [SELECT 62 in 0.08s]
2020-11-09 22:24:47.995104 (Thread-1): Finished running node model.jaffle_shop.customer_orders
2020-11-09 22:24:47.995245 (Thread-1): Began running node model.jaffle_shop.customer_payments
2020-11-09 22:24:47.997302 (Thread-1): 17:24:47 | 4 of 7 START table model public.customer_payments.................... [RUN]
2020-11-09 22:24:47.997672 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 22:24:47.997793 (Thread-1): Compiling model.jaffle_shop.customer_payments
2020-11-09 22:24:48.006349 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customer_payments"
2020-11-09 22:24:48.006931 (Thread-1): finished collecting timing info
2020-11-09 22:24:48.015530 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 22:24:48.015692 (Thread-1): On model.jaffle_shop.customer_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_payments"} */
drop table if exists "dbttest1"."public"."customer_payments__dbt_tmp" cascade
2020-11-09 22:24:48.015789 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 22:24:48.024999 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-11-09 22:24:48.027184 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 22:24:48.027301 (Thread-1): On model.jaffle_shop.customer_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_payments"} */
drop table if exists "dbttest1"."public"."customer_payments__dbt_backup" cascade
2020-11-09 22:24:48.028488 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 22:24:48.030439 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customer_payments"
2020-11-09 22:24:48.031074 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 22:24:48.031216 (Thread-1): On model.jaffle_shop.customer_payments: BEGIN
2020-11-09 22:24:48.032466 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 22:24:48.032594 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 22:24:48.032678 (Thread-1): On model.jaffle_shop.customer_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_payments"} */


  create  table "dbttest1"."public"."customer_payments__dbt_tmp"
  as (
    with payments as (

    select * from "dbttest1"."public"."stg_payments"

),

orders as (

    select * from "dbttest1"."public"."stg_orders"

),

final as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders using (order_id)

    group by 1

)

select * from final
  );
2020-11-09 22:24:48.036177 (Thread-1): SQL status: SELECT 62 in 0.00 seconds
2020-11-09 22:24:48.039820 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 22:24:48.040033 (Thread-1): On model.jaffle_shop.customer_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_payments"} */
alter table "dbttest1"."public"."customer_payments" rename to "customer_payments__dbt_backup"
2020-11-09 22:24:48.041514 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:24:48.044153 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 22:24:48.044293 (Thread-1): On model.jaffle_shop.customer_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_payments"} */
alter table "dbttest1"."public"."customer_payments__dbt_tmp" rename to "customer_payments"
2020-11-09 22:24:48.045703 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:24:48.046790 (Thread-1): On model.jaffle_shop.customer_payments: COMMIT
2020-11-09 22:24:48.046906 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 22:24:48.046988 (Thread-1): On model.jaffle_shop.customer_payments: COMMIT
2020-11-09 22:24:48.048359 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 22:24:48.050325 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 22:24:48.050446 (Thread-1): On model.jaffle_shop.customer_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_payments"} */
drop table if exists "dbttest1"."public"."customer_payments__dbt_backup" cascade
2020-11-09 22:24:48.053589 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 22:24:48.055702 (Thread-1): finished collecting timing info
2020-11-09 22:24:48.055934 (Thread-1): On model.jaffle_shop.customer_payments: Close
2020-11-09 22:24:48.056426 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e93c535c-b0d0-491d-b1f6-15f7ac82eebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132b93a0>]}
2020-11-09 22:24:48.057389 (Thread-1): 17:24:48 | 4 of 7 OK created table model public.customer_payments............... [SELECT 62 in 0.06s]
2020-11-09 22:24:48.057530 (Thread-1): Finished running node model.jaffle_shop.customer_payments
2020-11-09 22:24:48.057652 (Thread-1): Began running node model.jaffle_shop.order_payments
2020-11-09 22:24:48.058630 (Thread-1): 17:24:48 | 5 of 7 START table model public.order_payments....................... [RUN]
2020-11-09 22:24:48.059023 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:24:48.059142 (Thread-1): Compiling model.jaffle_shop.order_payments
2020-11-09 22:24:48.066772 (Thread-1): Writing injected SQL for node "model.jaffle_shop.order_payments"
2020-11-09 22:24:48.067153 (Thread-1): finished collecting timing info
2020-11-09 22:24:48.073346 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:24:48.073525 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */
drop table if exists "dbttest1"."public"."order_payments__dbt_tmp" cascade
2020-11-09 22:24:48.073626 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 22:24:48.082509 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-11-09 22:24:48.084934 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:24:48.085072 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */
drop table if exists "dbttest1"."public"."order_payments__dbt_backup" cascade
2020-11-09 22:24:48.086167 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 22:24:48.087265 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.order_payments"
2020-11-09 22:24:48.087685 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:24:48.087774 (Thread-1): On model.jaffle_shop.order_payments: BEGIN
2020-11-09 22:24:48.088886 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 22:24:48.089010 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:24:48.089086 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */


  create  table "dbttest1"."public"."order_payments__dbt_tmp"
  as (
    

with payments as (

    select * from "dbttest1"."public"."stg_payments"

),

final as (

    select
        order_id,

        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,
        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,
        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,
        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,
        sum(amount) as total_amount

    from payments

    group by 1

)

select * from final
  );
2020-11-09 22:24:48.094331 (Thread-1): SQL status: SELECT 99 in 0.01 seconds
2020-11-09 22:24:48.098464 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:24:48.098695 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */
alter table "dbttest1"."public"."order_payments" rename to "order_payments__dbt_backup"
2020-11-09 22:24:48.100209 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:24:48.102444 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:24:48.102554 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */
alter table "dbttest1"."public"."order_payments__dbt_tmp" rename to "order_payments"
2020-11-09 22:24:48.104401 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:24:48.105550 (Thread-1): On model.jaffle_shop.order_payments: COMMIT
2020-11-09 22:24:48.105671 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:24:48.105754 (Thread-1): On model.jaffle_shop.order_payments: COMMIT
2020-11-09 22:24:48.107629 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 22:24:48.110214 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:24:48.110334 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */
drop table if exists "dbttest1"."public"."order_payments__dbt_backup" cascade
2020-11-09 22:24:48.112933 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 22:24:48.115028 (Thread-1): finished collecting timing info
2020-11-09 22:24:48.115260 (Thread-1): On model.jaffle_shop.order_payments: Close
2020-11-09 22:24:48.115735 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e93c535c-b0d0-491d-b1f6-15f7ac82eebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133036a0>]}
2020-11-09 22:24:48.116860 (Thread-1): 17:24:48 | 5 of 7 OK created table model public.order_payments.................. [SELECT 99 in 0.06s]
2020-11-09 22:24:48.117015 (Thread-1): Finished running node model.jaffle_shop.order_payments
2020-11-09 22:24:48.117141 (Thread-1): Began running node model.jaffle_shop.dim_customers
2020-11-09 22:24:48.118264 (Thread-1): 17:24:48 | 6 of 7 START table model public.dim_customers........................ [RUN]
2020-11-09 22:24:48.118668 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 22:24:48.118837 (Thread-1): Compiling model.jaffle_shop.dim_customers
2020-11-09 22:24:48.133215 (Thread-1): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2020-11-09 22:24:48.133658 (Thread-1): finished collecting timing info
2020-11-09 22:24:48.140939 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 22:24:48.141082 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "dbttest1"."public"."dim_customers__dbt_tmp" cascade
2020-11-09 22:24:48.141172 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 22:24:48.149704 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-11-09 22:24:48.152222 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 22:24:48.152364 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "dbttest1"."public"."dim_customers__dbt_backup" cascade
2020-11-09 22:24:48.153527 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 22:24:48.154865 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2020-11-09 22:24:48.155324 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 22:24:48.155429 (Thread-1): On model.jaffle_shop.dim_customers: BEGIN
2020-11-09 22:24:48.157027 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 22:24:48.157177 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 22:24:48.157298 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */


  create  table "dbttest1"."public"."dim_customers__dbt_tmp"
  as (
    with customers as (

    select * from "dbttest1"."public"."stg_customers"

),

customer_orders as (

    select * from "dbttest1"."public"."customer_orders"

),

customer_payments as (

    select * from "dbttest1"."public"."customer_payments"

),

final as (

    select
        customers.customer_id,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders using (customer_id)

    left join customer_payments using (customer_id)

)

select * from final
  );
2020-11-09 22:24:48.160586 (Thread-1): SQL status: SELECT 100 in 0.00 seconds
2020-11-09 22:24:48.164093 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 22:24:48.164213 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbttest1"."public"."dim_customers" rename to "dim_customers__dbt_backup"
2020-11-09 22:24:48.165540 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:24:48.167950 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 22:24:48.168065 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbttest1"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
2020-11-09 22:24:48.170149 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:24:48.171259 (Thread-1): On model.jaffle_shop.dim_customers: COMMIT
2020-11-09 22:24:48.171379 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 22:24:48.171460 (Thread-1): On model.jaffle_shop.dim_customers: COMMIT
2020-11-09 22:24:48.172710 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 22:24:48.174632 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 22:24:48.174749 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "dbttest1"."public"."dim_customers__dbt_backup" cascade
2020-11-09 22:24:48.177222 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 22:24:48.179451 (Thread-1): finished collecting timing info
2020-11-09 22:24:48.179689 (Thread-1): On model.jaffle_shop.dim_customers: Close
2020-11-09 22:24:48.180227 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e93c535c-b0d0-491d-b1f6-15f7ac82eebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11312ad60>]}
2020-11-09 22:24:48.181265 (Thread-1): 17:24:48 | 6 of 7 OK created table model public.dim_customers................... [SELECT 100 in 0.06s]
2020-11-09 22:24:48.181437 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2020-11-09 22:24:48.181570 (Thread-1): Began running node model.jaffle_shop.fct_orders
2020-11-09 22:24:48.182550 (Thread-1): 17:24:48 | 7 of 7 START table model public.fct_orders........................... [RUN]
2020-11-09 22:24:48.182889 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:24:48.183009 (Thread-1): Compiling model.jaffle_shop.fct_orders
2020-11-09 22:24:48.199408 (Thread-1): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2020-11-09 22:24:48.200256 (Thread-1): finished collecting timing info
2020-11-09 22:24:48.209189 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:24:48.209334 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "dbttest1"."public"."fct_orders__dbt_tmp" cascade
2020-11-09 22:24:48.209439 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 22:24:48.218269 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-11-09 22:24:48.220504 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:24:48.220619 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "dbttest1"."public"."fct_orders__dbt_backup" cascade
2020-11-09 22:24:48.221802 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 22:24:48.222989 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.fct_orders"
2020-11-09 22:24:48.223406 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:24:48.223496 (Thread-1): On model.jaffle_shop.fct_orders: BEGIN
2020-11-09 22:24:48.224963 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 22:24:48.225114 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:24:48.225212 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */


  create  table "dbttest1"."public"."fct_orders__dbt_tmp"
  as (
    

with orders as (

    select * from "dbttest1"."public"."stg_orders"

),

order_payments as (

    select * from "dbttest1"."public"."order_payments"

),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.status,

        order_payments.credit_card_amount,

        order_payments.coupon_amount,

        order_payments.bank_transfer_amount,

        order_payments.gift_card_amount,

        order_payments.total_amount as amount

    from orders

    left join order_payments using (order_id)

)

select * from final
  );
2020-11-09 22:24:48.231384 (Thread-1): SQL status: SELECT 99 in 0.01 seconds
2020-11-09 22:24:48.234963 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:24:48.235077 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbttest1"."public"."fct_orders" rename to "fct_orders__dbt_backup"
2020-11-09 22:24:48.236578 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:24:48.238956 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:24:48.239074 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbttest1"."public"."fct_orders__dbt_tmp" rename to "fct_orders"
2020-11-09 22:24:48.240312 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:24:48.242029 (Thread-1): On model.jaffle_shop.fct_orders: COMMIT
2020-11-09 22:24:48.242243 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:24:48.242390 (Thread-1): On model.jaffle_shop.fct_orders: COMMIT
2020-11-09 22:24:48.244812 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 22:24:48.247519 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:24:48.247698 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "dbttest1"."public"."fct_orders__dbt_backup" cascade
2020-11-09 22:24:48.250249 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 22:24:48.253799 (Thread-1): finished collecting timing info
2020-11-09 22:24:48.254074 (Thread-1): On model.jaffle_shop.fct_orders: Close
2020-11-09 22:24:48.254645 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e93c535c-b0d0-491d-b1f6-15f7ac82eebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113319880>]}
2020-11-09 22:24:48.255732 (Thread-1): 17:24:48 | 7 of 7 OK created table model public.fct_orders...................... [SELECT 99 in 0.07s]
2020-11-09 22:24:48.255893 (Thread-1): Finished running node model.jaffle_shop.fct_orders
2020-11-09 22:24:48.257053 (MainThread): Acquiring new postgres connection "master".
2020-11-09 22:24:48.257222 (MainThread): Using postgres connection "master".
2020-11-09 22:24:48.257308 (MainThread): On master: BEGIN
2020-11-09 22:24:48.257385 (MainThread): Opening a new connection, currently in state closed
2020-11-09 22:24:48.266186 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-11-09 22:24:48.266352 (MainThread): On master: COMMIT
2020-11-09 22:24:48.266438 (MainThread): Using postgres connection "master".
2020-11-09 22:24:48.266512 (MainThread): On master: COMMIT
2020-11-09 22:24:48.267519 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-11-09 22:24:48.267659 (MainThread): On master: Close
2020-11-09 22:24:48.267990 (MainThread): 17:24:48 | 
2020-11-09 22:24:48.268163 (MainThread): 17:24:48 | Finished running 2 view models, 5 table models in 0.76s.
2020-11-09 22:24:48.268272 (MainThread): Connection 'master' was properly closed.
2020-11-09 22:24:48.268372 (MainThread): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2020-11-09 22:24:48.292148 (MainThread): 
2020-11-09 22:24:48.292437 (MainThread): Completed successfully
2020-11-09 22:24:48.292647 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2020-11-09 22:24:48.292921 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113315400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133152e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113315850>]}
2020-11-09 22:24:48.293152 (MainThread): Flushing usage events
2020-11-09 22:25:52.645014 (MainThread): Running with dbt=0.18.1
2020-11-09 22:25:53.955406 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=True, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['config.materialized:incremental,state:modified+'], partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=PosixPath('/tmp/target'), strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-09 22:25:53.955876 (MainThread): Tracking: tracking
2020-11-09 22:25:53.966133 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e750a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e634f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e63700>]}
2020-11-09 22:25:53.990586 (MainThread): Partial parsing not enabled
2020-11-09 22:25:53.992065 (MainThread): Parsing macros/catalog.sql
2020-11-09 22:25:53.996378 (MainThread): Parsing macros/relations.sql
2020-11-09 22:25:53.998911 (MainThread): Parsing macros/adapters.sql
2020-11-09 22:25:54.024990 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-11-09 22:25:54.028152 (MainThread): Parsing macros/core.sql
2020-11-09 22:25:54.032358 (MainThread): Parsing macros/materializations/helpers.sql
2020-11-09 22:25:54.042106 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-11-09 22:25:54.044058 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-11-09 22:25:54.062348 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-11-09 22:25:54.094935 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-11-09 22:25:54.117360 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-11-09 22:25:54.119372 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-11-09 22:25:54.126080 (MainThread): Parsing macros/materializations/common/merge.sql
2020-11-09 22:25:54.141132 (MainThread): Parsing macros/materializations/table/table.sql
2020-11-09 22:25:54.148536 (MainThread): Parsing macros/materializations/view/view.sql
2020-11-09 22:25:54.155506 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-11-09 22:25:54.161045 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-11-09 22:25:54.162111 (MainThread): Parsing macros/etc/query.sql
2020-11-09 22:25:54.163236 (MainThread): Parsing macros/etc/is_incremental.sql
2020-11-09 22:25:54.165008 (MainThread): Parsing macros/etc/datetime.sql
2020-11-09 22:25:54.175278 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-11-09 22:25:54.177399 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-11-09 22:25:54.179342 (MainThread): Parsing macros/adapters/common.sql
2020-11-09 22:25:54.250393 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-11-09 22:25:54.252436 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-11-09 22:25:54.254161 (MainThread): Parsing macros/schema_tests/unique.sql
2020-11-09 22:25:54.255971 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-11-09 22:25:54.263741 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2020-11-09 22:25:54.263914 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a76fd1f8-8ccb-4b8e-9be0-edf8057068b3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078f70d0>]}
2020-11-09 22:25:54.264515 (MainThread): Partial parsing not enabled
2020-11-09 22:25:54.291185 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 22:25:54.312621 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:25:54.322451 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:25:54.332273 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 22:25:54.347264 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:25:54.357945 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:25:54.365677 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 22:25:54.373057 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 22:25:54.857985 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 3 seed files, 0 sources
2020-11-09 22:25:54.862213 (MainThread): 
2020-11-09 22:25:54.862603 (MainThread): Merged 10 items from state (sample: ['seed.jaffle_shop.raw_orders', 'model.jaffle_shop.customer_payments', 'seed.jaffle_shop.raw_payments', 'model.jaffle_shop.order_payments', 'seed.jaffle_shop.raw_customers'])
2020-11-09 22:25:54.862740 (MainThread): Connection 'model.jaffle_shop.customer_orders' was properly closed.
2020-11-09 22:25:54.862892 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f99370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f99d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f99eb0>]}
2020-11-09 22:25:54.863069 (MainThread): Flushing usage events
2020-11-09 22:25:55.052333 (MainThread): Encountered an error:
2020-11-09 22:25:55.052636 (MainThread): 'source.jaffle_shop.public.source1'
2020-11-09 22:25:55.058175 (MainThread): Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/main.py", line 255, in run_from_args
    results = task.run()
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/runnable.py", line 419, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/runnable.py", line 379, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/run.py", line 392, in before_run
    self.defer_to_manifest(selected_uids)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/run.py", line 389, in defer_to_manifest
    self.write_manifest()
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/runnable.py", line 62, in write_manifest
    self.manifest.write(path)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/contracts/graph/manifest.py", line 762, in write
    self.writable_manifest().write(path)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/contracts/graph/manifest.py", line 741, in writable_manifest
    forward_edges, backward_edges = build_edges(edge_members)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/contracts/graph/manifest.py", line 231, in build_edges
    forward_edges[unique_id].append(node.unique_id)
KeyError: 'source.jaffle_shop.public.source1'

2020-11-09 22:30:45.331280 (MainThread): Running with dbt=0.18.1
2020-11-09 22:30:46.642801 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=True, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['config.materialized:table,state:modified+'], partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=PosixPath('/tmp/target'), strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-09 22:30:46.643936 (MainThread): Tracking: tracking
2020-11-09 22:30:46.657710 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bded90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bcafa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bca490>]}
2020-11-09 22:30:46.679251 (MainThread): Partial parsing not enabled
2020-11-09 22:30:46.680414 (MainThread): Parsing macros/catalog.sql
2020-11-09 22:30:46.684355 (MainThread): Parsing macros/relations.sql
2020-11-09 22:30:46.686522 (MainThread): Parsing macros/adapters.sql
2020-11-09 22:30:46.713003 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-11-09 22:30:46.719054 (MainThread): Parsing macros/core.sql
2020-11-09 22:30:46.724892 (MainThread): Parsing macros/materializations/helpers.sql
2020-11-09 22:30:46.737146 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-11-09 22:30:46.739633 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-11-09 22:30:46.763699 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-11-09 22:30:46.797747 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-11-09 22:30:46.820221 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-11-09 22:30:46.822453 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-11-09 22:30:46.830071 (MainThread): Parsing macros/materializations/common/merge.sql
2020-11-09 22:30:46.846976 (MainThread): Parsing macros/materializations/table/table.sql
2020-11-09 22:30:46.854929 (MainThread): Parsing macros/materializations/view/view.sql
2020-11-09 22:30:46.862996 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-11-09 22:30:46.869038 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-11-09 22:30:46.870443 (MainThread): Parsing macros/etc/query.sql
2020-11-09 22:30:46.871918 (MainThread): Parsing macros/etc/is_incremental.sql
2020-11-09 22:30:46.874049 (MainThread): Parsing macros/etc/datetime.sql
2020-11-09 22:30:46.883992 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-11-09 22:30:46.886333 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-11-09 22:30:46.888777 (MainThread): Parsing macros/adapters/common.sql
2020-11-09 22:30:46.962077 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-11-09 22:30:46.964265 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-11-09 22:30:46.966100 (MainThread): Parsing macros/schema_tests/unique.sql
2020-11-09 22:30:46.968269 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-11-09 22:30:46.977513 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2020-11-09 22:30:46.977790 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '39670394-3ed9-4683-b9b4-856ba11a630e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112660040>]}
2020-11-09 22:30:46.978895 (MainThread): Partial parsing not enabled
2020-11-09 22:30:47.014974 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 22:30:47.039475 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:30:47.064720 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:30:47.077993 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 22:30:47.100147 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:30:47.115847 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:30:47.155915 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 22:30:47.168829 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 22:30:47.677271 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 3 seed files, 0 sources
2020-11-09 22:30:47.680747 (MainThread): 
2020-11-09 22:30:47.681054 (MainThread): Merged 6 items from state (sample: ['seed.jaffle_shop.raw_orders', 'model.jaffle_shop.stg_customers', 'seed.jaffle_shop.raw_payments', 'model.jaffle_shop.stg_orders', 'model.jaffle_shop.stg_payments'])
2020-11-09 22:30:47.681178 (MainThread): Connection 'model.jaffle_shop.customer_orders' was properly closed.
2020-11-09 22:30:47.681333 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d01190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d01eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d01e80>]}
2020-11-09 22:30:47.681510 (MainThread): Flushing usage events
2020-11-09 22:30:47.878293 (MainThread): Encountered an error:
2020-11-09 22:30:47.878619 (MainThread): 'source.jaffle_shop.public.source1'
2020-11-09 22:30:47.884252 (MainThread): Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/main.py", line 255, in run_from_args
    results = task.run()
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/runnable.py", line 419, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/runnable.py", line 379, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/run.py", line 392, in before_run
    self.defer_to_manifest(selected_uids)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/run.py", line 389, in defer_to_manifest
    self.write_manifest()
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/runnable.py", line 62, in write_manifest
    self.manifest.write(path)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/contracts/graph/manifest.py", line 762, in write
    self.writable_manifest().write(path)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/contracts/graph/manifest.py", line 741, in writable_manifest
    forward_edges, backward_edges = build_edges(edge_members)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/contracts/graph/manifest.py", line 231, in build_edges
    forward_edges[unique_id].append(node.unique_id)
KeyError: 'source.jaffle_shop.public.source1'

2020-11-09 22:39:28.579123 (MainThread): Running with dbt=0.18.1
2020-11-09 22:39:29.927221 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=True, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['config.materialized:table,state:modified+'], partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=PosixPath('deferring_target'), strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-09 22:39:29.928929 (MainThread): Tracking: tracking
2020-11-09 22:39:29.941293 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa1dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa0a4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa0a700>]}
2020-11-09 22:39:29.963805 (MainThread): Partial parsing not enabled
2020-11-09 22:39:29.965046 (MainThread): Parsing macros/catalog.sql
2020-11-09 22:39:29.968816 (MainThread): Parsing macros/relations.sql
2020-11-09 22:39:29.970655 (MainThread): Parsing macros/adapters.sql
2020-11-09 22:39:29.994358 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-11-09 22:39:29.999435 (MainThread): Parsing macros/core.sql
2020-11-09 22:39:30.003854 (MainThread): Parsing macros/materializations/helpers.sql
2020-11-09 22:39:30.014387 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-11-09 22:39:30.016910 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-11-09 22:39:30.036019 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-11-09 22:39:30.070863 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-11-09 22:39:30.093671 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-11-09 22:39:30.095911 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-11-09 22:39:30.102982 (MainThread): Parsing macros/materializations/common/merge.sql
2020-11-09 22:39:30.119751 (MainThread): Parsing macros/materializations/table/table.sql
2020-11-09 22:39:30.127938 (MainThread): Parsing macros/materializations/view/view.sql
2020-11-09 22:39:30.135536 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-11-09 22:39:30.141242 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-11-09 22:39:30.142471 (MainThread): Parsing macros/etc/query.sql
2020-11-09 22:39:30.143953 (MainThread): Parsing macros/etc/is_incremental.sql
2020-11-09 22:39:30.146150 (MainThread): Parsing macros/etc/datetime.sql
2020-11-09 22:39:30.156533 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-11-09 22:39:30.159284 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-11-09 22:39:30.161886 (MainThread): Parsing macros/adapters/common.sql
2020-11-09 22:39:30.238941 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-11-09 22:39:30.241388 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-11-09 22:39:30.243407 (MainThread): Parsing macros/schema_tests/unique.sql
2020-11-09 22:39:30.245668 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-11-09 22:39:30.253905 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2020-11-09 22:39:30.254083 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b2496ac7-14f3-409c-bc77-ded282a22182', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4a0100>]}
2020-11-09 22:39:30.254690 (MainThread): Partial parsing not enabled
2020-11-09 22:39:30.284885 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 22:39:30.302727 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:39:30.310276 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:39:30.317875 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 22:39:30.327350 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:39:30.335748 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:39:30.344719 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 22:39:30.353184 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 22:39:30.846722 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 3 seed files, 0 sources
2020-11-09 22:39:30.850264 (MainThread): 
2020-11-09 22:39:30.850564 (MainThread): Merged 6 items from state (sample: ['seed.jaffle_shop.raw_orders', 'model.jaffle_shop.stg_payments', 'model.jaffle_shop.stg_orders', 'seed.jaffle_shop.raw_payments', 'seed.jaffle_shop.raw_customers'])
2020-11-09 22:39:30.850694 (MainThread): Connection 'model.jaffle_shop.customer_orders' was properly closed.
2020-11-09 22:39:30.850844 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab40370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab40d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab40eb0>]}
2020-11-09 22:39:30.851021 (MainThread): Flushing usage events
2020-11-09 22:39:31.012687 (MainThread): Encountered an error:
2020-11-09 22:39:31.012940 (MainThread): 'source.jaffle_shop.public.source1'
2020-11-09 22:39:31.017739 (MainThread): Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/main.py", line 255, in run_from_args
    results = task.run()
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/runnable.py", line 419, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/runnable.py", line 379, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/run.py", line 392, in before_run
    self.defer_to_manifest(selected_uids)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/run.py", line 389, in defer_to_manifest
    self.write_manifest()
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/runnable.py", line 62, in write_manifest
    self.manifest.write(path)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/contracts/graph/manifest.py", line 762, in write
    self.writable_manifest().write(path)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/contracts/graph/manifest.py", line 741, in writable_manifest
    forward_edges, backward_edges = build_edges(edge_members)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/contracts/graph/manifest.py", line 231, in build_edges
    forward_edges[unique_id].append(node.unique_id)
KeyError: 'source.jaffle_shop.public.source1'

2020-11-09 22:41:10.593567 (MainThread): Running with dbt=0.18.1
2020-11-09 22:41:12.097193 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=True, defer=True, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['config.materialized:table,state:modified+'], partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=PosixPath('deferring_target'), strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-09 22:41:12.098467 (MainThread): Tracking: tracking
2020-11-09 22:41:12.112634 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0d4a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0daf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0da400>]}
2020-11-09 22:41:12.144638 (MainThread): Partial parsing not enabled
2020-11-09 22:41:12.146188 (MainThread): Parsing macros/catalog.sql
2020-11-09 22:41:12.151603 (MainThread): Parsing macros/relations.sql
2020-11-09 22:41:12.154273 (MainThread): Parsing macros/adapters.sql
2020-11-09 22:41:12.183946 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-11-09 22:41:12.188553 (MainThread): Parsing macros/core.sql
2020-11-09 22:41:12.193896 (MainThread): Parsing macros/materializations/helpers.sql
2020-11-09 22:41:12.205495 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-11-09 22:41:12.208681 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-11-09 22:41:12.228941 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-11-09 22:41:12.271125 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-11-09 22:41:12.299178 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-11-09 22:41:12.301574 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-11-09 22:41:12.318498 (MainThread): Parsing macros/materializations/common/merge.sql
2020-11-09 22:41:12.351718 (MainThread): Parsing macros/materializations/table/table.sql
2020-11-09 22:41:12.360024 (MainThread): Parsing macros/materializations/view/view.sql
2020-11-09 22:41:12.368574 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-11-09 22:41:12.375325 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-11-09 22:41:12.376571 (MainThread): Parsing macros/etc/query.sql
2020-11-09 22:41:12.378245 (MainThread): Parsing macros/etc/is_incremental.sql
2020-11-09 22:41:12.381212 (MainThread): Parsing macros/etc/datetime.sql
2020-11-09 22:41:12.393173 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-11-09 22:41:12.395858 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-11-09 22:41:12.398614 (MainThread): Parsing macros/adapters/common.sql
2020-11-09 22:41:12.478857 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-11-09 22:41:12.481771 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-11-09 22:41:12.483674 (MainThread): Parsing macros/schema_tests/unique.sql
2020-11-09 22:41:12.487213 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-11-09 22:41:12.498646 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2020-11-09 22:41:12.498840 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '909baabc-7612-4869-8c50-a18d9cfa843b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f108b80>]}
2020-11-09 22:41:12.499374 (MainThread): Partial parsing not enabled
2020-11-09 22:41:12.530387 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 22:41:12.549148 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:41:12.559049 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:41:12.570599 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 22:41:12.584907 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:41:12.594309 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:41:12.604708 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 22:41:12.613672 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 22:41:13.141491 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 3 seed files, 0 sources
2020-11-09 22:41:13.144965 (MainThread): 
2020-11-09 22:41:13.145323 (MainThread): Merged 6 items from state (sample: ['seed.jaffle_shop.raw_orders', 'model.jaffle_shop.stg_payments', 'seed.jaffle_shop.raw_payments', 'model.jaffle_shop.stg_orders', 'seed.jaffle_shop.raw_customers'])
2020-11-09 22:41:13.145489 (MainThread): Connection 'model.jaffle_shop.customer_orders' was properly closed.
2020-11-09 22:41:13.145797 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f20f100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f20ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f20ff70>]}
2020-11-09 22:41:13.146030 (MainThread): Flushing usage events
2020-11-09 22:41:13.338030 (MainThread): Encountered an error:
2020-11-09 22:41:13.338333 (MainThread): 'source.jaffle_shop.public.source1'
2020-11-09 22:41:13.343158 (MainThread): Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/main.py", line 255, in run_from_args
    results = task.run()
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/runnable.py", line 419, in run
    result = self.execute_with_hooks(selected_uids)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/runnable.py", line 379, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/run.py", line 392, in before_run
    self.defer_to_manifest(selected_uids)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/run.py", line 389, in defer_to_manifest
    self.write_manifest()
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/task/runnable.py", line 62, in write_manifest
    self.manifest.write(path)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/contracts/graph/manifest.py", line 762, in write
    self.writable_manifest().write(path)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/contracts/graph/manifest.py", line 741, in writable_manifest
    forward_edges, backward_edges = build_edges(edge_members)
  File "/Users/naveen/.pyenv/versions/3.8.2/envs/dbt-core/lib/python3.8/site-packages/dbt/contracts/graph/manifest.py", line 231, in build_edges
    forward_edges[unique_id].append(node.unique_id)
KeyError: 'source.jaffle_shop.public.source1'

2020-11-09 22:45:10.455943 (MainThread): Running with dbt=0.18.1
2020-11-09 22:45:12.045912 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=True, defer=True, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['state:modified+'], partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=PosixPath('deferring_target'), strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-09 22:45:12.050276 (MainThread): Tracking: tracking
2020-11-09 22:45:12.065093 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dcd820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dd3ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dd33d0>]}
2020-11-09 22:45:12.097968 (MainThread): Partial parsing not enabled
2020-11-09 22:45:12.099408 (MainThread): Parsing macros/catalog.sql
2020-11-09 22:45:12.103976 (MainThread): Parsing macros/relations.sql
2020-11-09 22:45:12.106217 (MainThread): Parsing macros/adapters.sql
2020-11-09 22:45:12.137327 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-11-09 22:45:12.141208 (MainThread): Parsing macros/core.sql
2020-11-09 22:45:12.146688 (MainThread): Parsing macros/materializations/helpers.sql
2020-11-09 22:45:12.158422 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-11-09 22:45:12.162420 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-11-09 22:45:12.185407 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-11-09 22:45:12.225618 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-11-09 22:45:12.254880 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-11-09 22:45:12.258063 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-11-09 22:45:12.267878 (MainThread): Parsing macros/materializations/common/merge.sql
2020-11-09 22:45:12.286031 (MainThread): Parsing macros/materializations/table/table.sql
2020-11-09 22:45:12.297371 (MainThread): Parsing macros/materializations/view/view.sql
2020-11-09 22:45:12.306315 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-11-09 22:45:12.315222 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-11-09 22:45:12.316549 (MainThread): Parsing macros/etc/query.sql
2020-11-09 22:45:12.318303 (MainThread): Parsing macros/etc/is_incremental.sql
2020-11-09 22:45:12.321415 (MainThread): Parsing macros/etc/datetime.sql
2020-11-09 22:45:12.333450 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-11-09 22:45:12.335815 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-11-09 22:45:12.338328 (MainThread): Parsing macros/adapters/common.sql
2020-11-09 22:45:12.421098 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-11-09 22:45:12.423624 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-11-09 22:45:12.425694 (MainThread): Parsing macros/schema_tests/unique.sql
2020-11-09 22:45:12.428493 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-11-09 22:45:12.436612 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2020-11-09 22:45:12.436794 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b130a5bc-3d12-4b59-9473-ecb5a58c4c33', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dd30d0>]}
2020-11-09 22:45:12.437353 (MainThread): Partial parsing not enabled
2020-11-09 22:45:12.468715 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2020-11-09 22:45:12.494844 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:45:12.508429 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:45:12.518616 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 22:45:12.533657 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:45:12.556170 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:45:12.569950 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 22:45:12.580339 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 22:45:13.099446 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 3 seed files, 0 sources
2020-11-09 22:45:13.102801 (MainThread): 
2020-11-09 22:45:13.103106 (MainThread): Merged 4 items from state (sample: ['seed.jaffle_shop.raw_customers', 'seed.jaffle_shop.raw_payments', 'seed.jaffle_shop.raw_orders', 'model.jaffle_shop.stg_customers'])
2020-11-09 22:45:13.182581 (MainThread): Acquiring new postgres connection "master".
2020-11-09 22:45:13.190859 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dbttest1".
2020-11-09 22:45:13.200818 (ThreadPoolExecutor-0_0): Using postgres connection "list_dbttest1".
2020-11-09 22:45:13.200987 (ThreadPoolExecutor-0_0): On list_dbttest1: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1"} */

    select distinct nspname from pg_namespace
  
2020-11-09 22:45:13.201092 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-09 22:45:13.212613 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2020-11-09 22:45:13.215986 (ThreadPoolExecutor-0_0): On list_dbttest1: Close
2020-11-09 22:45:13.255608 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dbttest1_public".
2020-11-09 22:45:13.261806 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2020-11-09 22:45:13.262013 (ThreadPoolExecutor-1_0): On list_dbttest1_public: BEGIN
2020-11-09 22:45:13.262266 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2020-11-09 22:45:13.271533 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2020-11-09 22:45:13.271720 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2020-11-09 22:45:13.271882 (ThreadPoolExecutor-1_0): On list_dbttest1_public: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1_public"} */
select
      'dbttest1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbttest1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2020-11-09 22:45:13.275723 (ThreadPoolExecutor-1_0): SQL status: SELECT 12 in 0.00 seconds
2020-11-09 22:45:13.284951 (ThreadPoolExecutor-1_0): On list_dbttest1_public: ROLLBACK
2020-11-09 22:45:13.286404 (ThreadPoolExecutor-1_0): On list_dbttest1_public: Close
2020-11-09 22:45:13.327594 (MainThread): Using postgres connection "master".
2020-11-09 22:45:13.327872 (MainThread): On master: BEGIN
2020-11-09 22:45:13.328048 (MainThread): Opening a new connection, currently in state init
2020-11-09 22:45:13.338109 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-11-09 22:45:13.338295 (MainThread): Using postgres connection "master".
2020-11-09 22:45:13.338405 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-11-09 22:45:13.346720 (MainThread): SQL status: SELECT 3 in 0.01 seconds
2020-11-09 22:45:13.350882 (MainThread): On master: ROLLBACK
2020-11-09 22:45:13.352400 (MainThread): Using postgres connection "master".
2020-11-09 22:45:13.352564 (MainThread): On master: BEGIN
2020-11-09 22:45:13.354588 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-11-09 22:45:13.354765 (MainThread): On master: COMMIT
2020-11-09 22:45:13.354876 (MainThread): Using postgres connection "master".
2020-11-09 22:45:13.354968 (MainThread): On master: COMMIT
2020-11-09 22:45:13.355954 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-11-09 22:45:13.356258 (MainThread): On master: Close
2020-11-09 22:45:13.356711 (MainThread): 17:45:13 | Concurrency: 1 threads (target='dev')
2020-11-09 22:45:13.356886 (MainThread): 17:45:13 | 
2020-11-09 22:45:13.362326 (Thread-1): Began running node model.jaffle_shop.stg_orders
2020-11-09 22:45:13.363564 (Thread-1): 17:45:13 | 1 of 7 START view model public.stg_orders............................ [RUN]
2020-11-09 22:45:13.363904 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:45:13.364047 (Thread-1): Compiling model.jaffle_shop.stg_orders
2020-11-09 22:45:13.372343 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2020-11-09 22:45:13.372936 (Thread-1): finished collecting timing info
2020-11-09 22:45:13.400875 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:45:13.401069 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbttest1"."public"."stg_orders__dbt_tmp" cascade
2020-11-09 22:45:13.401176 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 22:45:13.408641 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-11-09 22:45:13.411136 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:45:13.411294 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbttest1"."public"."stg_orders__dbt_backup" cascade
2020-11-09 22:45:13.412268 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-11-09 22:45:13.417411 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2020-11-09 22:45:13.417936 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:45:13.418061 (Thread-1): On model.jaffle_shop.stg_orders: BEGIN
2020-11-09 22:45:13.419497 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 22:45:13.419702 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:45:13.419837 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "dbttest1"."public"."stg_orders__dbt_tmp" as (
    with source as (
    select * from "dbttest1"."public"."raw_orders"

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from renamed
  );

2020-11-09 22:45:13.431588 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-11-09 22:45:13.439665 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:45:13.439883 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbttest1"."public"."stg_orders" rename to "stg_orders__dbt_backup"
2020-11-09 22:45:13.442790 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:45:13.446057 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:45:13.446202 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbttest1"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
2020-11-09 22:45:13.447566 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:45:13.453920 (Thread-1): On model.jaffle_shop.stg_orders: COMMIT
2020-11-09 22:45:13.454111 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:45:13.454236 (Thread-1): On model.jaffle_shop.stg_orders: COMMIT
2020-11-09 22:45:13.455945 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 22:45:13.460312 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2020-11-09 22:45:13.460494 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbttest1"."public"."stg_orders__dbt_backup" cascade
2020-11-09 22:45:13.464076 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-11-09 22:45:13.466495 (Thread-1): finished collecting timing info
2020-11-09 22:45:13.466793 (Thread-1): On model.jaffle_shop.stg_orders: Close
2020-11-09 22:45:13.467409 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b130a5bc-3d12-4b59-9473-ecb5a58c4c33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fb1d60>]}
2020-11-09 22:45:13.468595 (Thread-1): 17:45:13 | 1 of 7 OK created view model public.stg_orders....................... [CREATE VIEW in 0.10s]
2020-11-09 22:45:13.468772 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2020-11-09 22:45:13.468959 (Thread-1): Began running node model.jaffle_shop.stg_payments
2020-11-09 22:45:13.470576 (Thread-1): 17:45:13 | 2 of 7 START view model public.stg_payments.......................... [RUN]
2020-11-09 22:45:13.471042 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:45:13.471253 (Thread-1): Compiling model.jaffle_shop.stg_payments
2020-11-09 22:45:13.481726 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2020-11-09 22:45:13.482278 (Thread-1): finished collecting timing info
2020-11-09 22:45:13.490553 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:45:13.490839 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbttest1"."public"."stg_payments__dbt_tmp" cascade
2020-11-09 22:45:13.491095 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 22:45:13.503440 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-11-09 22:45:13.505881 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:45:13.506035 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbttest1"."public"."stg_payments__dbt_backup" cascade
2020-11-09 22:45:13.507775 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-11-09 22:45:13.509499 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2020-11-09 22:45:13.511123 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:45:13.511904 (Thread-1): On model.jaffle_shop.stg_payments: BEGIN
2020-11-09 22:45:13.514935 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 22:45:13.515165 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:45:13.515279 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "dbttest1"."public"."stg_payments__dbt_tmp" as (
    with source as (
    select * from "dbttest1"."public"."raw_payments"

),

renamed as (

    select
	1 as something,
        id as payment_id,
        order_id,
        payment_method,

        --`amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed
  );

2020-11-09 22:45:13.519041 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-11-09 22:45:13.524491 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:45:13.524757 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbttest1"."public"."stg_payments" rename to "stg_payments__dbt_backup"
2020-11-09 22:45:13.527460 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:45:13.531403 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:45:13.531614 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbttest1"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
2020-11-09 22:45:13.533758 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:45:13.535571 (Thread-1): On model.jaffle_shop.stg_payments: COMMIT
2020-11-09 22:45:13.535958 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:45:13.536310 (Thread-1): On model.jaffle_shop.stg_payments: COMMIT
2020-11-09 22:45:13.539272 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 22:45:13.543168 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2020-11-09 22:45:13.543744 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbttest1"."public"."stg_payments__dbt_backup" cascade
2020-11-09 22:45:13.548033 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-11-09 22:45:13.552327 (Thread-1): finished collecting timing info
2020-11-09 22:45:13.552830 (Thread-1): On model.jaffle_shop.stg_payments: Close
2020-11-09 22:45:13.553738 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b130a5bc-3d12-4b59-9473-ecb5a58c4c33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f9bd90>]}
2020-11-09 22:45:13.556283 (Thread-1): 17:45:13 | 2 of 7 OK created view model public.stg_payments..................... [CREATE VIEW in 0.08s]
2020-11-09 22:45:13.556648 (Thread-1): Finished running node model.jaffle_shop.stg_payments
2020-11-09 22:45:13.557071 (Thread-1): Began running node model.jaffle_shop.customer_orders
2020-11-09 22:45:13.560154 (Thread-1): 17:45:13 | 3 of 7 START table model public.customer_orders...................... [RUN]
2020-11-09 22:45:13.562333 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 22:45:13.562615 (Thread-1): Compiling model.jaffle_shop.customer_orders
2020-11-09 22:45:13.575018 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customer_orders"
2020-11-09 22:45:13.576501 (Thread-1): finished collecting timing info
2020-11-09 22:45:13.605836 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 22:45:13.606105 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
drop table if exists "dbttest1"."public"."customer_orders__dbt_tmp" cascade
2020-11-09 22:45:13.606254 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 22:45:13.617416 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-11-09 22:45:13.620104 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 22:45:13.620265 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
drop table if exists "dbttest1"."public"."customer_orders__dbt_backup" cascade
2020-11-09 22:45:13.621406 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 22:45:13.628161 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customer_orders"
2020-11-09 22:45:13.629005 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 22:45:13.629133 (Thread-1): On model.jaffle_shop.customer_orders: BEGIN
2020-11-09 22:45:13.630731 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 22:45:13.630932 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 22:45:13.631035 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */


  create  table "dbttest1"."public"."customer_orders__dbt_tmp"
  as (
    with orders as (

    select * from "dbttest1"."public"."stg_orders"

),

final as (

    select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by 1

)

select * from final
  );
2020-11-09 22:45:13.637358 (Thread-1): SQL status: SELECT 62 in 0.01 seconds
2020-11-09 22:45:13.642993 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 22:45:13.643315 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
alter table "dbttest1"."public"."customer_orders" rename to "customer_orders__dbt_backup"
2020-11-09 22:45:13.645281 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:45:13.647971 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 22:45:13.648152 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
alter table "dbttest1"."public"."customer_orders__dbt_tmp" rename to "customer_orders"
2020-11-09 22:45:13.649580 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:45:13.650669 (Thread-1): On model.jaffle_shop.customer_orders: COMMIT
2020-11-09 22:45:13.650818 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 22:45:13.650919 (Thread-1): On model.jaffle_shop.customer_orders: COMMIT
2020-11-09 22:45:13.652416 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 22:45:13.654402 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2020-11-09 22:45:13.654569 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
drop table if exists "dbttest1"."public"."customer_orders__dbt_backup" cascade
2020-11-09 22:45:13.657873 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 22:45:13.661216 (Thread-1): finished collecting timing info
2020-11-09 22:45:13.661581 (Thread-1): On model.jaffle_shop.customer_orders: Close
2020-11-09 22:45:13.662493 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b130a5bc-3d12-4b59-9473-ecb5a58c4c33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fe0ee0>]}
2020-11-09 22:45:13.664028 (Thread-1): 17:45:13 | 3 of 7 OK created table model public.customer_orders................. [SELECT 62 in 0.10s]
2020-11-09 22:45:13.664209 (Thread-1): Finished running node model.jaffle_shop.customer_orders
2020-11-09 22:45:13.664413 (Thread-1): Began running node model.jaffle_shop.customer_payments
2020-11-09 22:45:13.666216 (Thread-1): 17:45:13 | 4 of 7 START table model public.customer_payments.................... [RUN]
2020-11-09 22:45:13.666699 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 22:45:13.666879 (Thread-1): Compiling model.jaffle_shop.customer_payments
2020-11-09 22:45:13.677366 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customer_payments"
2020-11-09 22:45:13.678346 (Thread-1): finished collecting timing info
2020-11-09 22:45:13.685096 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 22:45:13.685326 (Thread-1): On model.jaffle_shop.customer_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_payments"} */
drop table if exists "dbttest1"."public"."customer_payments__dbt_tmp" cascade
2020-11-09 22:45:13.685440 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 22:45:13.695258 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-11-09 22:45:13.697706 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 22:45:13.697861 (Thread-1): On model.jaffle_shop.customer_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_payments"} */
drop table if exists "dbttest1"."public"."customer_payments__dbt_backup" cascade
2020-11-09 22:45:13.698919 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 22:45:13.700195 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customer_payments"
2020-11-09 22:45:13.700649 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 22:45:13.700766 (Thread-1): On model.jaffle_shop.customer_payments: BEGIN
2020-11-09 22:45:13.702190 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 22:45:13.702404 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 22:45:13.702541 (Thread-1): On model.jaffle_shop.customer_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_payments"} */


  create  table "dbttest1"."public"."customer_payments__dbt_tmp"
  as (
    with payments as (

    select * from "dbttest1"."public"."stg_payments"

),

orders as (

    select * from "dbttest1"."public"."stg_orders"

),

final as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders using (order_id)

    group by 1

)

select * from final
  );
2020-11-09 22:45:13.707879 (Thread-1): SQL status: SELECT 62 in 0.01 seconds
2020-11-09 22:45:13.713814 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 22:45:13.714037 (Thread-1): On model.jaffle_shop.customer_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_payments"} */
alter table "dbttest1"."public"."customer_payments" rename to "customer_payments__dbt_backup"
2020-11-09 22:45:13.716768 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:45:13.721328 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 22:45:13.729675 (Thread-1): On model.jaffle_shop.customer_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_payments"} */
alter table "dbttest1"."public"."customer_payments__dbt_tmp" rename to "customer_payments"
2020-11-09 22:45:13.731060 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:45:13.734482 (Thread-1): On model.jaffle_shop.customer_payments: COMMIT
2020-11-09 22:45:13.741537 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 22:45:13.741762 (Thread-1): On model.jaffle_shop.customer_payments: COMMIT
2020-11-09 22:45:13.744379 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 22:45:13.747641 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2020-11-09 22:45:13.747864 (Thread-1): On model.jaffle_shop.customer_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_payments"} */
drop table if exists "dbttest1"."public"."customer_payments__dbt_backup" cascade
2020-11-09 22:45:13.750339 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 22:45:13.754039 (Thread-1): finished collecting timing info
2020-11-09 22:45:13.754398 (Thread-1): On model.jaffle_shop.customer_payments: Close
2020-11-09 22:45:13.755159 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b130a5bc-3d12-4b59-9473-ecb5a58c4c33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109edca30>]}
2020-11-09 22:45:13.756873 (Thread-1): 17:45:13 | 4 of 7 OK created table model public.customer_payments............... [SELECT 62 in 0.09s]
2020-11-09 22:45:13.757144 (Thread-1): Finished running node model.jaffle_shop.customer_payments
2020-11-09 22:45:13.757392 (Thread-1): Began running node model.jaffle_shop.order_payments
2020-11-09 22:45:13.759975 (Thread-1): 17:45:13 | 5 of 7 START table model public.order_payments....................... [RUN]
2020-11-09 22:45:13.761950 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:45:13.762359 (Thread-1): Compiling model.jaffle_shop.order_payments
2020-11-09 22:45:13.773401 (Thread-1): Writing injected SQL for node "model.jaffle_shop.order_payments"
2020-11-09 22:45:13.774002 (Thread-1): finished collecting timing info
2020-11-09 22:45:13.781985 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:45:13.782182 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */
drop table if exists "dbttest1"."public"."order_payments__dbt_tmp" cascade
2020-11-09 22:45:13.782318 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 22:45:13.790660 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-11-09 22:45:13.794618 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:45:13.794839 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */
drop table if exists "dbttest1"."public"."order_payments__dbt_backup" cascade
2020-11-09 22:45:13.796080 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 22:45:13.797528 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.order_payments"
2020-11-09 22:45:13.798135 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:45:13.798332 (Thread-1): On model.jaffle_shop.order_payments: BEGIN
2020-11-09 22:45:13.799630 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 22:45:13.799814 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:45:13.799929 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */


  create  table "dbttest1"."public"."order_payments__dbt_tmp"
  as (
    

with payments as (

    select * from "dbttest1"."public"."stg_payments"

),

final as (

    select
        order_id,

        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,
        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,
        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,
        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,
        sum(amount) as total_amount

    from payments

    group by 1

)

select * from final
  );
2020-11-09 22:45:13.805904 (Thread-1): SQL status: SELECT 99 in 0.01 seconds
2020-11-09 22:45:13.811636 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:45:13.811887 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */
alter table "dbttest1"."public"."order_payments" rename to "order_payments__dbt_backup"
2020-11-09 22:45:13.813604 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:45:13.816136 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:45:13.816364 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */
alter table "dbttest1"."public"."order_payments__dbt_tmp" rename to "order_payments"
2020-11-09 22:45:13.817956 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:45:13.819055 (Thread-1): On model.jaffle_shop.order_payments: COMMIT
2020-11-09 22:45:13.819189 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:45:13.819295 (Thread-1): On model.jaffle_shop.order_payments: COMMIT
2020-11-09 22:45:13.820375 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 22:45:13.824090 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2020-11-09 22:45:13.824422 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */
drop table if exists "dbttest1"."public"."order_payments__dbt_backup" cascade
2020-11-09 22:45:13.829190 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 22:45:13.831676 (Thread-1): finished collecting timing info
2020-11-09 22:45:13.831939 (Thread-1): On model.jaffle_shop.order_payments: Close
2020-11-09 22:45:13.832670 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b130a5bc-3d12-4b59-9473-ecb5a58c4c33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0e0640>]}
2020-11-09 22:45:13.834213 (Thread-1): 17:45:13 | 5 of 7 OK created table model public.order_payments.................. [SELECT 99 in 0.07s]
2020-11-09 22:45:13.834539 (Thread-1): Finished running node model.jaffle_shop.order_payments
2020-11-09 22:45:13.834808 (Thread-1): Began running node model.jaffle_shop.dim_customers
2020-11-09 22:45:13.836337 (Thread-1): 17:45:13 | 6 of 7 START table model public.dim_customers........................ [RUN]
2020-11-09 22:45:13.836987 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 22:45:13.837160 (Thread-1): Compiling model.jaffle_shop.dim_customers
2020-11-09 22:45:13.853493 (Thread-1): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2020-11-09 22:45:13.854092 (Thread-1): finished collecting timing info
2020-11-09 22:45:13.862293 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 22:45:13.862479 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "dbttest1"."public"."dim_customers__dbt_tmp" cascade
2020-11-09 22:45:13.862582 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 22:45:13.872147 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-11-09 22:45:13.875500 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 22:45:13.875684 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "dbttest1"."public"."dim_customers__dbt_backup" cascade
2020-11-09 22:45:13.877657 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 22:45:13.879325 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2020-11-09 22:45:13.879793 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 22:45:13.879905 (Thread-1): On model.jaffle_shop.dim_customers: BEGIN
2020-11-09 22:45:13.881395 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 22:45:13.881566 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 22:45:13.881672 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */


  create  table "dbttest1"."public"."dim_customers__dbt_tmp"
  as (
    with customers as (

    select * from "dbttest1"."public"."stg_customers"

),

customer_orders as (

    select * from "dbttest1"."public"."customer_orders"

),

customer_payments as (

    select * from "dbttest1"."public"."customer_payments"

),

final as (

    select
        customers.customer_id,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders using (customer_id)

    left join customer_payments using (customer_id)

)

select * from final
  );
2020-11-09 22:45:13.885884 (Thread-1): SQL status: SELECT 100 in 0.00 seconds
2020-11-09 22:45:13.890369 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 22:45:13.890546 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbttest1"."public"."dim_customers" rename to "dim_customers__dbt_backup"
2020-11-09 22:45:13.892308 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:45:13.895594 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 22:45:13.895793 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbttest1"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
2020-11-09 22:45:13.897059 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:45:13.898189 (Thread-1): On model.jaffle_shop.dim_customers: COMMIT
2020-11-09 22:45:13.898360 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 22:45:13.898455 (Thread-1): On model.jaffle_shop.dim_customers: COMMIT
2020-11-09 22:45:13.900525 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 22:45:13.902302 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2020-11-09 22:45:13.902432 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "dbttest1"."public"."dim_customers__dbt_backup" cascade
2020-11-09 22:45:13.904816 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 22:45:13.907486 (Thread-1): finished collecting timing info
2020-11-09 22:45:13.907883 (Thread-1): On model.jaffle_shop.dim_customers: Close
2020-11-09 22:45:13.908664 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b130a5bc-3d12-4b59-9473-ecb5a58c4c33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ed5be0>]}
2020-11-09 22:45:13.910007 (Thread-1): 17:45:13 | 6 of 7 OK created table model public.dim_customers................... [SELECT 100 in 0.07s]
2020-11-09 22:45:13.910292 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2020-11-09 22:45:13.910561 (Thread-1): Began running node model.jaffle_shop.fct_orders
2020-11-09 22:45:13.912302 (Thread-1): 17:45:13 | 7 of 7 START table model public.fct_orders........................... [RUN]
2020-11-09 22:45:13.912716 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:45:13.912918 (Thread-1): Compiling model.jaffle_shop.fct_orders
2020-11-09 22:45:13.929296 (Thread-1): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2020-11-09 22:45:13.929845 (Thread-1): finished collecting timing info
2020-11-09 22:45:13.937207 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:45:13.937372 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "dbttest1"."public"."fct_orders__dbt_tmp" cascade
2020-11-09 22:45:13.937475 (Thread-1): Opening a new connection, currently in state closed
2020-11-09 22:45:13.947634 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-11-09 22:45:13.950193 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:45:13.950359 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "dbttest1"."public"."fct_orders__dbt_backup" cascade
2020-11-09 22:45:13.951475 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 22:45:13.952680 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.fct_orders"
2020-11-09 22:45:13.953112 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:45:13.953225 (Thread-1): On model.jaffle_shop.fct_orders: BEGIN
2020-11-09 22:45:13.954225 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-11-09 22:45:13.954369 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:45:13.954463 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */


  create  table "dbttest1"."public"."fct_orders__dbt_tmp"
  as (
    

with orders as (

    select * from "dbttest1"."public"."stg_orders"

),

order_payments as (

    select * from "dbttest1"."public"."order_payments"

),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.status,

        order_payments.credit_card_amount,

        order_payments.coupon_amount,

        order_payments.bank_transfer_amount,

        order_payments.gift_card_amount,

        order_payments.total_amount as amount

    from orders

    left join order_payments using (order_id)

)

select * from final
  );
2020-11-09 22:45:13.964330 (Thread-1): SQL status: SELECT 99 in 0.01 seconds
2020-11-09 22:45:13.968790 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:45:13.968948 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbttest1"."public"."fct_orders" rename to "fct_orders__dbt_backup"
2020-11-09 22:45:13.970387 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:45:13.973110 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:45:13.973282 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbttest1"."public"."fct_orders__dbt_tmp" rename to "fct_orders"
2020-11-09 22:45:13.974906 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-11-09 22:45:13.977472 (Thread-1): On model.jaffle_shop.fct_orders: COMMIT
2020-11-09 22:45:13.978004 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:45:13.978276 (Thread-1): On model.jaffle_shop.fct_orders: COMMIT
2020-11-09 22:45:13.979966 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-11-09 22:45:13.982734 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2020-11-09 22:45:13.982899 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "dbttest1"."public"."fct_orders__dbt_backup" cascade
2020-11-09 22:45:13.986186 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-11-09 22:45:13.989461 (Thread-1): finished collecting timing info
2020-11-09 22:45:13.989763 (Thread-1): On model.jaffle_shop.fct_orders: Close
2020-11-09 22:45:13.990668 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b130a5bc-3d12-4b59-9473-ecb5a58c4c33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0fa850>]}
2020-11-09 22:45:13.992122 (Thread-1): 17:45:13 | 7 of 7 OK created table model public.fct_orders...................... [SELECT 99 in 0.08s]
2020-11-09 22:45:13.992531 (Thread-1): Finished running node model.jaffle_shop.fct_orders
2020-11-09 22:45:13.995307 (MainThread): Acquiring new postgres connection "master".
2020-11-09 22:45:13.995639 (MainThread): Using postgres connection "master".
2020-11-09 22:45:13.995784 (MainThread): On master: BEGIN
2020-11-09 22:45:13.995949 (MainThread): Opening a new connection, currently in state closed
2020-11-09 22:45:14.004531 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-11-09 22:45:14.004734 (MainThread): On master: COMMIT
2020-11-09 22:45:14.004844 (MainThread): Using postgres connection "master".
2020-11-09 22:45:14.004987 (MainThread): On master: COMMIT
2020-11-09 22:45:14.006441 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-11-09 22:45:14.006631 (MainThread): On master: Close
2020-11-09 22:45:14.007068 (MainThread): 17:45:14 | 
2020-11-09 22:45:14.007213 (MainThread): 17:45:14 | Finished running 2 view models, 5 table models in 0.90s.
2020-11-09 22:45:14.007329 (MainThread): Connection 'master' was properly closed.
2020-11-09 22:45:14.007560 (MainThread): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2020-11-09 22:45:14.035793 (MainThread): 
2020-11-09 22:45:14.036209 (MainThread): Completed successfully
2020-11-09 22:45:14.036393 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2020-11-09 22:45:14.036700 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0f96a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0f9820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0f97f0>]}
2020-11-09 22:45:14.037275 (MainThread): Flushing usage events
2020-11-16 18:58:04.798726 (MainThread): Running with dbt=0.18.1
2020-11-16 18:58:04.977441 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=True, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2020-11-16 18:58:04.978919 (MainThread): Tracking: tracking
2020-11-16 18:58:05.003274 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2ec790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2ffd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a30a4f0>]}
2020-11-16 18:58:05.047873 (MainThread): Partial parsing not enabled
2020-11-16 18:58:05.050123 (MainThread): Parsing macros/catalog.sql
2020-11-16 18:58:05.059667 (MainThread): Parsing macros/relations.sql
2020-11-16 18:58:05.063893 (MainThread): Parsing macros/adapters.sql
2020-11-16 18:58:05.108959 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-11-16 18:58:05.116142 (MainThread): Parsing macros/core.sql
2020-11-16 18:58:05.125930 (MainThread): Parsing macros/materializations/helpers.sql
2020-11-16 18:58:05.147877 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-11-16 18:58:05.152744 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-11-16 18:58:05.188679 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-11-16 18:58:05.247594 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-11-16 18:58:05.288488 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-11-16 18:58:05.293630 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-11-16 18:58:05.313484 (MainThread): Parsing macros/materializations/common/merge.sql
2020-11-16 18:58:05.357491 (MainThread): Parsing macros/materializations/table/table.sql
2020-11-16 18:58:05.386130 (MainThread): Parsing macros/materializations/view/view.sql
2020-11-16 18:58:05.414892 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-11-16 18:58:05.438229 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-11-16 18:58:05.443360 (MainThread): Parsing macros/etc/query.sql
2020-11-16 18:58:05.449346 (MainThread): Parsing macros/etc/is_incremental.sql
2020-11-16 18:58:05.455793 (MainThread): Parsing macros/etc/datetime.sql
2020-11-16 18:58:05.487906 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-11-16 18:58:05.495998 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-11-16 18:58:05.502505 (MainThread): Parsing macros/adapters/common.sql
2020-11-16 18:58:05.655994 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-11-16 18:58:05.664667 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-11-16 18:58:05.669709 (MainThread): Parsing macros/schema_tests/unique.sql
2020-11-16 18:58:05.675537 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-11-16 18:58:05.696634 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2020-11-16 18:58:05.697112 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ac50565f-2c97-49f9-8311-45f5dd9f5de1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2ffd00>]}
2020-11-16 18:58:05.698799 (MainThread): Partial parsing not enabled
2020-11-16 18:58:05.785714 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2020-11-16 18:58:05.833808 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2020-11-16 18:58:05.849184 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2020-11-16 18:58:05.867834 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2020-11-16 18:58:05.899532 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2020-11-16 18:58:05.923287 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2020-11-16 18:58:05.945464 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2020-11-16 18:58:05.967036 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2020-11-16 18:58:07.219927 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 3 seed files, 0 sources
2020-11-16 18:58:07.227396 (MainThread): 
2020-11-16 18:58:07.228315 (MainThread): Acquiring new postgres connection "master".
2020-11-16 18:58:07.341828 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dbttest1_public".
2020-11-16 18:58:07.365291 (ThreadPoolExecutor-0_0): Using postgres connection "list_dbttest1_public".
2020-11-16 18:58:07.365625 (ThreadPoolExecutor-0_0): On list_dbttest1_public: BEGIN
2020-11-16 18:58:07.365875 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-16 18:58:07.405013 (ThreadPoolExecutor-0_0): Got an error when attempting to open a postgres connection: 'FATAL:  database "dbttest1" does not exist
'
2020-11-16 18:58:07.405413 (ThreadPoolExecutor-0_0): Error running SQL: BEGIN
2020-11-16 18:58:07.405647 (ThreadPoolExecutor-0_0): Rolling back transaction.
2020-11-16 18:58:07.405992 (ThreadPoolExecutor-0_0): Error running SQL: macro list_relations_without_caching
2020-11-16 18:58:07.406233 (ThreadPoolExecutor-0_0): Rolling back transaction.
2020-11-16 18:58:07.406489 (ThreadPoolExecutor-0_0): On list_dbttest1_public: No close available on handle
2020-11-16 18:58:07.407416 (MainThread): Connection 'master' was properly closed.
2020-11-16 18:58:07.407611 (MainThread): Connection 'list_dbttest1_public' was properly closed.
2020-11-16 18:58:07.407773 (MainThread): ERROR: Database Error
  FATAL:  database "dbttest1" does not exist
  
2020-11-16 18:58:07.408156 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a385190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4a7c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6669d0>]}
2020-11-16 18:58:07.408631 (MainThread): Flushing usage events
2020-11-16 19:44:52.748585 (MainThread): Running with dbt=0.18.1
2020-11-16 19:44:52.915349 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='json', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2020-11-16 19:44:52.917750 (MainThread): Tracking: tracking
2020-11-16 19:44:52.933788 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a41bdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c918d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c926520>]}
2020-11-16 19:44:52.974078 (MainThread): Partial parsing not enabled
2020-11-16 19:44:52.975959 (MainThread): Parsing macros/catalog.sql
2020-11-16 19:44:52.983677 (MainThread): Parsing macros/relations.sql
2020-11-16 19:44:52.987173 (MainThread): Parsing macros/adapters.sql
2020-11-16 19:44:53.035507 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-11-16 19:44:53.041176 (MainThread): Parsing macros/core.sql
2020-11-16 19:44:53.046992 (MainThread): Parsing macros/materializations/helpers.sql
2020-11-16 19:44:53.061391 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-11-16 19:44:53.064552 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-11-16 19:44:53.089066 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-11-16 19:44:53.139953 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-11-16 19:44:53.180161 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-11-16 19:44:53.183320 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-11-16 19:44:53.195013 (MainThread): Parsing macros/materializations/common/merge.sql
2020-11-16 19:44:53.222610 (MainThread): Parsing macros/materializations/table/table.sql
2020-11-16 19:44:53.233205 (MainThread): Parsing macros/materializations/view/view.sql
2020-11-16 19:44:53.244834 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-11-16 19:44:53.252995 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-11-16 19:44:53.255341 (MainThread): Parsing macros/etc/query.sql
2020-11-16 19:44:53.258060 (MainThread): Parsing macros/etc/is_incremental.sql
2020-11-16 19:44:53.263926 (MainThread): Parsing macros/etc/datetime.sql
2020-11-16 19:44:53.283417 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-11-16 19:44:53.287524 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-11-16 19:44:53.291124 (MainThread): Parsing macros/adapters/common.sql
2020-11-16 19:44:53.365266 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-11-16 19:44:53.368363 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-11-16 19:44:53.370992 (MainThread): Parsing macros/schema_tests/unique.sql
2020-11-16 19:44:53.373912 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-11-16 19:44:53.386896 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2020-11-16 19:44:53.387513 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '856073df-6923-4776-9d39-9522fb8b32a0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c538f10>]}
2020-11-16 19:44:53.388526 (MainThread): Partial parsing not enabled
2020-11-16 19:44:53.448706 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2020-11-16 19:44:53.473171 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2020-11-16 19:44:53.483482 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2020-11-16 19:44:53.493677 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2020-11-16 19:44:53.508120 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2020-11-16 19:44:53.521839 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2020-11-16 19:44:53.533343 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2020-11-16 19:44:53.548581 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2020-11-16 19:44:54.705301 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 3 seed files, 0 sources
2020-11-16 19:44:54.712346 (MainThread): 
2020-11-16 19:44:54.713117 (MainThread): Acquiring new postgres connection "master".
2020-11-16 19:44:54.814045 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dbttest1_public".
2020-11-16 19:44:54.829318 (ThreadPoolExecutor-0_0): Using postgres connection "list_dbttest1_public".
2020-11-16 19:44:54.829552 (ThreadPoolExecutor-0_0): On list_dbttest1_public: BEGIN
2020-11-16 19:44:54.829720 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-16 19:44:54.839306 (ThreadPoolExecutor-0_0): Got an error when attempting to open a postgres connection: 'FATAL:  database "dbttest1" does not exist
'
2020-11-16 19:44:54.839502 (ThreadPoolExecutor-0_0): Error running SQL: BEGIN
2020-11-16 19:44:54.839612 (ThreadPoolExecutor-0_0): Rolling back transaction.
2020-11-16 19:44:54.839760 (ThreadPoolExecutor-0_0): Error running SQL: macro list_relations_without_caching
2020-11-16 19:44:54.839859 (ThreadPoolExecutor-0_0): Rolling back transaction.
2020-11-16 19:44:54.839977 (ThreadPoolExecutor-0_0): On list_dbttest1_public: No close available on handle
2020-11-16 19:44:54.840642 (MainThread): Connection 'master' was properly closed.
2020-11-16 19:44:54.840777 (MainThread): Connection 'list_dbttest1_public' was properly closed.
2020-11-16 19:44:54.840911 (MainThread): ERROR: Database Error
  FATAL:  database "dbttest1" does not exist
  
2020-11-16 19:44:54.841705 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c98a0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10caba5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc81a60>]}
2020-11-16 19:44:54.842072 (MainThread): Flushing usage events
2020-11-18 22:11:18.818284 (MainThread): Running with dbt=0.18.1
2020-11-18 22:11:18.924977 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-18 22:11:18.926501 (MainThread): Tracking: tracking
2020-11-18 22:11:18.941942 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb799a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb8ac40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb97430>]}
2020-11-18 22:11:18.967151 (MainThread): Partial parsing not enabled
2020-11-18 22:11:18.968803 (MainThread): Parsing macros/catalog.sql
2020-11-18 22:11:18.973850 (MainThread): Parsing macros/relations.sql
2020-11-18 22:11:18.975786 (MainThread): Parsing macros/adapters.sql
2020-11-18 22:11:18.999727 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-11-18 22:11:19.004572 (MainThread): Parsing macros/core.sql
2020-11-18 22:11:19.009601 (MainThread): Parsing macros/materializations/helpers.sql
2020-11-18 22:11:19.019742 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-11-18 22:11:19.022236 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-11-18 22:11:19.040802 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-11-18 22:11:19.074403 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-11-18 22:11:19.097688 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-11-18 22:11:19.099972 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-11-18 22:11:19.107136 (MainThread): Parsing macros/materializations/common/merge.sql
2020-11-18 22:11:19.122307 (MainThread): Parsing macros/materializations/table/table.sql
2020-11-18 22:11:19.129821 (MainThread): Parsing macros/materializations/view/view.sql
2020-11-18 22:11:19.137469 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-11-18 22:11:19.143654 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-11-18 22:11:19.145028 (MainThread): Parsing macros/etc/query.sql
2020-11-18 22:11:19.146744 (MainThread): Parsing macros/etc/is_incremental.sql
2020-11-18 22:11:19.149168 (MainThread): Parsing macros/etc/datetime.sql
2020-11-18 22:11:19.160013 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-11-18 22:11:19.162337 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-11-18 22:11:19.164554 (MainThread): Parsing macros/adapters/common.sql
2020-11-18 22:11:19.214246 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-11-18 22:11:19.216719 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-11-18 22:11:19.218860 (MainThread): Parsing macros/schema_tests/unique.sql
2020-11-18 22:11:19.221051 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-11-18 22:11:19.229410 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2020-11-18 22:11:19.229605 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4e788b09-55b0-4f40-98fb-e2f735f962ef', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb79e20>]}
2020-11-18 22:11:19.230321 (MainThread): Partial parsing not enabled
2020-11-18 22:11:19.281592 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2020-11-18 22:11:19.298717 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2020-11-18 22:11:19.306222 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2020-11-18 22:11:19.313932 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2020-11-18 22:11:19.323642 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2020-11-18 22:11:19.332458 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2020-11-18 22:11:19.341836 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2020-11-18 22:11:19.350646 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2020-11-18 22:11:19.849394 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 3 seed files, 0 sources
2020-11-18 22:11:19.851649 (MainThread): 
2020-11-18 22:11:19.852049 (MainThread): Acquiring new postgres connection "master".
2020-11-18 22:11:19.864907 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dbttest1".
2020-11-18 22:11:19.876298 (ThreadPoolExecutor-0_0): Using postgres connection "list_dbttest1".
2020-11-18 22:11:19.876454 (ThreadPoolExecutor-0_0): On list_dbttest1: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1"} */

    select distinct nspname from pg_namespace
  
2020-11-18 22:11:19.876542 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-18 22:11:19.892502 (ThreadPoolExecutor-0_0): Got an error when attempting to open a postgres connection: 'FATAL:  database "dbttest1" does not exist
'
2020-11-18 22:11:19.892672 (ThreadPoolExecutor-0_0): Error running SQL: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1"} */

    select distinct nspname from pg_namespace
  
2020-11-18 22:11:19.892760 (ThreadPoolExecutor-0_0): Rolling back transaction.
2020-11-18 22:11:19.892888 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2020-11-18 22:11:19.892965 (ThreadPoolExecutor-0_0): Rolling back transaction.
2020-11-18 22:11:19.893067 (ThreadPoolExecutor-0_0): On list_dbttest1: No close available on handle
2020-11-18 22:11:19.893563 (MainThread): Connection 'master' was properly closed.
2020-11-18 22:11:19.893671 (MainThread): Connection 'list_dbttest1' was properly closed.
2020-11-18 22:11:19.893782 (MainThread): ERROR: Database Error
  FATAL:  database "dbttest1" does not exist
  
2020-11-18 22:11:19.893951 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed26d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eee55b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eeddc70>]}
2020-11-18 22:11:19.894140 (MainThread): Flushing usage events
2020-11-18 22:12:32.968704 (MainThread): Running with dbt=0.18.1
2020-11-18 22:12:33.053297 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='json', models=None, partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-18 22:12:33.054384 (MainThread): Tracking: tracking
2020-11-18 22:12:33.066875 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111182dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11367cd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11368a4f0>]}
2020-11-18 22:12:33.090302 (MainThread): Partial parsing not enabled
2020-11-18 22:12:33.091470 (MainThread): Parsing macros/catalog.sql
2020-11-18 22:12:33.095929 (MainThread): Parsing macros/relations.sql
2020-11-18 22:12:33.097948 (MainThread): Parsing macros/adapters.sql
2020-11-18 22:12:33.121784 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-11-18 22:12:33.125450 (MainThread): Parsing macros/core.sql
2020-11-18 22:12:33.129718 (MainThread): Parsing macros/materializations/helpers.sql
2020-11-18 22:12:33.140201 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-11-18 22:12:33.142420 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-11-18 22:12:33.161480 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-11-18 22:12:33.200178 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-11-18 22:12:33.233473 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-11-18 22:12:33.236379 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-11-18 22:12:33.243654 (MainThread): Parsing macros/materializations/common/merge.sql
2020-11-18 22:12:33.261133 (MainThread): Parsing macros/materializations/table/table.sql
2020-11-18 22:12:33.269366 (MainThread): Parsing macros/materializations/view/view.sql
2020-11-18 22:12:33.276566 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-11-18 22:12:33.282448 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-11-18 22:12:33.283722 (MainThread): Parsing macros/etc/query.sql
2020-11-18 22:12:33.285113 (MainThread): Parsing macros/etc/is_incremental.sql
2020-11-18 22:12:33.287091 (MainThread): Parsing macros/etc/datetime.sql
2020-11-18 22:12:33.297309 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-11-18 22:12:33.299730 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-11-18 22:12:33.301957 (MainThread): Parsing macros/adapters/common.sql
2020-11-18 22:12:33.359498 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-11-18 22:12:33.362425 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-11-18 22:12:33.364663 (MainThread): Parsing macros/schema_tests/unique.sql
2020-11-18 22:12:33.366761 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-11-18 22:12:33.375244 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2020-11-18 22:12:33.375628 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '18410865-8ed3-44fc-a555-9940b6a7af4d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11329ceb0>]}
2020-11-18 22:12:33.376175 (MainThread): Partial parsing not enabled
2020-11-18 22:12:33.415742 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2020-11-18 22:12:33.435730 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2020-11-18 22:12:33.443234 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2020-11-18 22:12:33.450481 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2020-11-18 22:12:33.460035 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2020-11-18 22:12:33.468587 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2020-11-18 22:12:33.476868 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2020-11-18 22:12:33.484945 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2020-11-18 22:12:34.015942 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 3 seed files, 0 sources
2020-11-18 22:12:34.018288 (MainThread): 
2020-11-18 22:12:34.018615 (MainThread): Acquiring new postgres connection "master".
2020-11-18 22:12:34.030051 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dbttest1".
2020-11-18 22:12:34.042700 (ThreadPoolExecutor-0_0): Using postgres connection "list_dbttest1".
2020-11-18 22:12:34.042850 (ThreadPoolExecutor-0_0): On list_dbttest1: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1"} */

    select distinct nspname from pg_namespace
  
2020-11-18 22:12:34.042943 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-18 22:12:34.052955 (ThreadPoolExecutor-0_0): Got an error when attempting to open a postgres connection: 'FATAL:  database "dbttest1" does not exist
'
2020-11-18 22:12:34.053265 (ThreadPoolExecutor-0_0): Error running SQL: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1"} */

    select distinct nspname from pg_namespace
  
2020-11-18 22:12:34.053454 (ThreadPoolExecutor-0_0): Rolling back transaction.
2020-11-18 22:12:34.053710 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2020-11-18 22:12:34.053887 (ThreadPoolExecutor-0_0): Rolling back transaction.
2020-11-18 22:12:34.054034 (ThreadPoolExecutor-0_0): On list_dbttest1: No close available on handle
2020-11-18 22:12:34.054684 (MainThread): Connection 'master' was properly closed.
2020-11-18 22:12:34.054841 (MainThread): Connection 'list_dbttest1' was properly closed.
2020-11-18 22:12:34.055031 (MainThread): ERROR: Database Error
  FATAL:  database "dbttest1" does not exist
  
2020-11-18 22:12:34.055615 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138172b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139e6340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139de9d0>]}
2020-11-18 22:12:34.055904 (MainThread): Flushing usage events
2021-02-22 18:41:18.010404 (MainThread): Running with dbt=0.17.0
2021-02-22 18:41:18.154546 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', show=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-02-22 18:41:18.155757 (MainThread): Tracking: tracking
2021-02-22 18:41:18.178714 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10538aa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105770cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105770c10>]}
2021-02-22 18:41:18.206004 (MainThread): Partial parsing not enabled
2021-02-22 18:41:18.208823 (MainThread): Parsing macros/core.sql
2021-02-22 18:41:18.215293 (MainThread): Parsing macros/materializations/helpers.sql
2021-02-22 18:41:18.224957 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-02-22 18:41:18.227238 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-02-22 18:41:18.247788 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-02-22 18:41:18.285642 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-02-22 18:41:18.317749 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-02-22 18:41:18.320207 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-02-22 18:41:18.327932 (MainThread): Parsing macros/materializations/common/merge.sql
2021-02-22 18:41:18.344968 (MainThread): Parsing macros/materializations/table/table.sql
2021-02-22 18:41:18.355199 (MainThread): Parsing macros/materializations/view/view.sql
2021-02-22 18:41:18.363492 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-02-22 18:41:18.369954 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-02-22 18:41:18.371403 (MainThread): Parsing macros/etc/query.sql
2021-02-22 18:41:18.373062 (MainThread): Parsing macros/etc/is_incremental.sql
2021-02-22 18:41:18.375451 (MainThread): Parsing macros/etc/datetime.sql
2021-02-22 18:41:18.387374 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-02-22 18:41:18.390243 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-02-22 18:41:18.392602 (MainThread): Parsing macros/adapters/common.sql
2021-02-22 18:41:18.453932 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-02-22 18:41:18.455543 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-02-22 18:41:18.457031 (MainThread): Parsing macros/schema_tests/unique.sql
2021-02-22 18:41:18.458733 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-02-22 18:41:18.461774 (MainThread): Parsing macros/catalog.sql
2021-02-22 18:41:18.464993 (MainThread): Parsing macros/relations.sql
2021-02-22 18:41:18.467035 (MainThread): Parsing macros/adapters.sql
2021-02-22 18:41:18.493564 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-02-22 18:41:18.520711 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0
2021-02-22 18:41:18.521502 (MainThread): Partial parsing not enabled
2021-02-22 18:41:18.592736 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2021-02-22 18:41:18.592971 (MainThread): Opening a new connection, currently in state init
2021-02-22 18:41:18.649411 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2021-02-22 18:41:18.649711 (MainThread): Opening a new connection, currently in state init
2021-02-22 18:41:18.664839 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2021-02-22 18:41:18.665130 (MainThread): Opening a new connection, currently in state init
2021-02-22 18:41:18.676664 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2021-02-22 18:41:18.676827 (MainThread): Opening a new connection, currently in state init
2021-02-22 18:41:18.690411 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2021-02-22 18:41:18.690619 (MainThread): Opening a new connection, currently in state init
2021-02-22 18:41:18.737753 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2021-02-22 18:41:18.737933 (MainThread): Opening a new connection, currently in state init
2021-02-22 18:41:18.746719 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2021-02-22 18:41:18.746878 (MainThread): Opening a new connection, currently in state init
2021-02-22 18:41:18.756063 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2021-02-22 18:41:18.756312 (MainThread): Opening a new connection, currently in state init
2021-02-22 18:41:19.277253 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 134 macros, 0 operations, 3 seed files, 0 sources
2021-02-22 18:41:19.280718 (MainThread): 
2021-02-22 18:41:19.281191 (MainThread): Acquiring new postgres connection "master".
2021-02-22 18:41:19.281317 (MainThread): Opening a new connection, currently in state init
2021-02-22 18:41:19.286132 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dbttest1".
2021-02-22 18:41:19.286336 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-22 18:41:19.298083 (ThreadPoolExecutor-0_0): Using postgres connection "list_dbttest1".
2021-02-22 18:41:19.298262 (ThreadPoolExecutor-0_0): On list_dbttest1: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1"} */

    select distinct nspname from pg_namespace
  
2021-02-22 18:41:19.312333 (ThreadPoolExecutor-0_0): Got an error when attempting to open a postgres connection: 'FATAL:  database "dbttest1" does not exist
'
2021-02-22 18:41:19.312645 (ThreadPoolExecutor-0_0): Error running SQL: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1"} */

    select distinct nspname from pg_namespace
  
2021-02-22 18:41:19.312810 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-02-22 18:41:19.312993 (ThreadPoolExecutor-0_0): On list_dbttest1: No close available on handle
2021-02-22 18:41:19.313300 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2021-02-22 18:41:19.313471 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-02-22 18:41:19.314269 (MainThread): Connection 'master' was properly closed.
2021-02-22 18:41:19.314456 (MainThread): Connection 'list_dbttest1' was properly closed.
2021-02-22 18:41:19.314706 (MainThread): ERROR: Database Error
  FATAL:  database "dbttest1" does not exist
  
2021-02-22 18:41:19.315259 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10591dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b45f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105be5c50>]}
2021-02-22 18:41:19.315575 (MainThread): Flushing usage events
2021-02-22 18:41:53.873986 (MainThread): Running with dbt=0.17.0
2021-02-22 18:41:54.024645 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', show=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-02-22 18:41:54.027044 (MainThread): Tracking: tracking
2021-02-22 18:41:54.058425 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055018d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058f3d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058f3c50>]}
2021-02-22 18:41:54.112245 (MainThread): Partial parsing not enabled
2021-02-22 18:41:54.119204 (MainThread): Parsing macros/core.sql
2021-02-22 18:41:54.150936 (MainThread): Parsing macros/materializations/helpers.sql
2021-02-22 18:41:54.169976 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-02-22 18:41:54.174630 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-02-22 18:41:54.209835 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-02-22 18:41:54.259300 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-02-22 18:41:54.293954 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-02-22 18:41:54.296633 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-02-22 18:41:54.307201 (MainThread): Parsing macros/materializations/common/merge.sql
2021-02-22 18:41:54.328196 (MainThread): Parsing macros/materializations/table/table.sql
2021-02-22 18:41:54.338601 (MainThread): Parsing macros/materializations/view/view.sql
2021-02-22 18:41:54.349213 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-02-22 18:41:54.356388 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-02-22 18:41:54.358568 (MainThread): Parsing macros/etc/query.sql
2021-02-22 18:41:54.361114 (MainThread): Parsing macros/etc/is_incremental.sql
2021-02-22 18:41:54.365034 (MainThread): Parsing macros/etc/datetime.sql
2021-02-22 18:41:54.379251 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-02-22 18:41:54.382570 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-02-22 18:41:54.384730 (MainThread): Parsing macros/adapters/common.sql
2021-02-22 18:41:54.452473 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-02-22 18:41:54.454003 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-02-22 18:41:54.455435 (MainThread): Parsing macros/schema_tests/unique.sql
2021-02-22 18:41:54.456855 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-02-22 18:41:54.460144 (MainThread): Parsing macros/catalog.sql
2021-02-22 18:41:54.463395 (MainThread): Parsing macros/relations.sql
2021-02-22 18:41:54.465375 (MainThread): Parsing macros/adapters.sql
2021-02-22 18:41:54.496391 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-02-22 18:41:54.522733 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0
2021-02-22 18:41:54.523550 (MainThread): Partial parsing not enabled
2021-02-22 18:41:54.574718 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2021-02-22 18:41:54.574958 (MainThread): Opening a new connection, currently in state init
2021-02-22 18:41:54.609186 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2021-02-22 18:41:54.609364 (MainThread): Opening a new connection, currently in state init
2021-02-22 18:41:54.617603 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2021-02-22 18:41:54.617790 (MainThread): Opening a new connection, currently in state init
2021-02-22 18:41:54.628042 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2021-02-22 18:41:54.628265 (MainThread): Opening a new connection, currently in state init
2021-02-22 18:41:54.640605 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2021-02-22 18:41:54.640770 (MainThread): Opening a new connection, currently in state init
2021-02-22 18:41:54.675015 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2021-02-22 18:41:54.675202 (MainThread): Opening a new connection, currently in state init
2021-02-22 18:41:54.683458 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2021-02-22 18:41:54.683620 (MainThread): Opening a new connection, currently in state init
2021-02-22 18:41:54.691460 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2021-02-22 18:41:54.691671 (MainThread): Opening a new connection, currently in state init
2021-02-22 18:41:55.195599 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 134 macros, 0 operations, 3 seed files, 0 sources
2021-02-22 18:41:55.200311 (MainThread): 
2021-02-22 18:41:55.200898 (MainThread): Acquiring new postgres connection "master".
2021-02-22 18:41:55.201065 (MainThread): Opening a new connection, currently in state init
2021-02-22 18:41:55.211909 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dbttest1".
2021-02-22 18:41:55.212178 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-22 18:41:55.231670 (ThreadPoolExecutor-0_0): Using postgres connection "list_dbttest1".
2021-02-22 18:41:55.231979 (ThreadPoolExecutor-0_0): On list_dbttest1: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1"} */

    select distinct nspname from pg_namespace
  
2021-02-22 18:41:55.302583 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.07 seconds
2021-02-22 18:41:55.350786 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dbttest1_public".
2021-02-22 18:41:55.350982 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_dbttest1).
2021-02-22 18:41:55.357560 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2021-02-22 18:41:55.357763 (ThreadPoolExecutor-1_0): On list_dbttest1_public: BEGIN
2021-02-22 18:41:55.360349 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-02-22 18:41:55.360540 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2021-02-22 18:41:55.360680 (ThreadPoolExecutor-1_0): On list_dbttest1_public: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1_public"} */
select
      'dbttest1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbttest1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-02-22 18:41:55.382947 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.02 seconds
2021-02-22 18:41:55.383333 (ThreadPoolExecutor-1_0): On list_dbttest1_public: ROLLBACK
2021-02-22 18:41:55.429375 (MainThread): Using postgres connection "master".
2021-02-22 18:41:55.429550 (MainThread): On master: BEGIN
2021-02-22 18:41:55.438252 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-02-22 18:41:55.438444 (MainThread): Using postgres connection "master".
2021-02-22 18:41:55.438555 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-02-22 18:41:55.479474 (MainThread): SQL status: SELECT 0 in 0.04 seconds
2021-02-22 18:41:55.479835 (MainThread): On master: ROLLBACK
2021-02-22 18:41:55.482000 (MainThread): Using postgres connection "master".
2021-02-22 18:41:55.482221 (MainThread): On master: BEGIN
2021-02-22 18:41:55.485008 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-02-22 18:41:55.485224 (MainThread): On master: COMMIT
2021-02-22 18:41:55.485343 (MainThread): Using postgres connection "master".
2021-02-22 18:41:55.485441 (MainThread): On master: COMMIT
2021-02-22 18:41:55.486476 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-02-22 18:41:55.486826 (MainThread): 13:41:55 | Concurrency: 1 threads (target='dev')
2021-02-22 18:41:55.486991 (MainThread): 13:41:55 | 
2021-02-22 18:41:55.488570 (Thread-1): Began running node seed.jaffle_shop.raw_customers
2021-02-22 18:41:55.489855 (Thread-1): 13:41:55 | 1 of 3 START seed file public.raw_customers.......................... [RUN]
2021-02-22 18:41:55.490396 (Thread-1): Acquiring new postgres connection "seed.jaffle_shop.raw_customers".
2021-02-22 18:41:55.490530 (Thread-1): Re-using an available connection from the pool (formerly list_dbttest1_public).
2021-02-22 18:41:55.490661 (Thread-1): finished collecting timing info
2021-02-22 18:41:55.533960 (Thread-1): * Deprecation Warning: The quote_columns parameter was not set for seeds, so the
default value of False was chosen. The default will change to True in a future
release.

For more information, see:
https://docs.getdbt.com/v0.15/docs/seeds#section-specify-column-quoting
2021-02-22 18:41:55.534633 (Thread-1): Using postgres connection "seed.jaffle_shop.raw_customers".
2021-02-22 18:41:55.534899 (Thread-1): On seed.jaffle_shop.raw_customers: BEGIN
2021-02-22 18:41:55.537772 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-02-22 18:41:55.538029 (Thread-1): Using postgres connection "seed.jaffle_shop.raw_customers".
2021-02-22 18:41:55.538190 (Thread-1): On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */

    create table "dbttest1"."public"."raw_customers" (id integer,first_name text,last_name text,email text)
  
2021-02-22 18:41:55.583845 (Thread-1): SQL status: CREATE TABLE in 0.05 seconds
2021-02-22 18:41:55.611580 (Thread-1): Using postgres connection "seed.jaffle_shop.raw_customers".
2021-02-22 18:41:55.611925 (Thread-1): On seed.jaffle_shop.raw_customers: 
            insert into "dbttest1"."public"."raw_customers" (id, first_name, last_name, email) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%...
2021-02-22 18:41:55.617055 (Thread-1): SQL status: INSERT 0 100 in 0.00 seconds
2021-02-22 18:41:55.626210 (Thread-1): Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
2021-02-22 18:41:55.640251 (Thread-1): On seed.jaffle_shop.raw_customers: COMMIT
2021-02-22 18:41:55.640456 (Thread-1): Using postgres connection "seed.jaffle_shop.raw_customers".
2021-02-22 18:41:55.640563 (Thread-1): On seed.jaffle_shop.raw_customers: COMMIT
2021-02-22 18:41:55.661513 (Thread-1): SQL status: COMMIT in 0.02 seconds
2021-02-22 18:41:55.663859 (Thread-1): finished collecting timing info
2021-02-22 18:41:55.665302 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a26c802-3bab-49e5-a7e7-25cb0d3e36b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105daa3d0>]}
2021-02-22 18:41:55.665784 (Thread-1): 13:41:55 | 1 of 3 OK loaded seed file public.raw_customers...................... [INSERT 100 in 0.17s]
2021-02-22 18:41:55.666055 (Thread-1): Finished running node seed.jaffle_shop.raw_customers
2021-02-22 18:41:55.666285 (Thread-1): Began running node seed.jaffle_shop.raw_orders
2021-02-22 18:41:55.668691 (Thread-1): 13:41:55 | 2 of 3 START seed file public.raw_orders............................. [RUN]
2021-02-22 18:41:55.669328 (Thread-1): Acquiring new postgres connection "seed.jaffle_shop.raw_orders".
2021-02-22 18:41:55.669564 (Thread-1): Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_customers).
2021-02-22 18:41:55.669789 (Thread-1): finished collecting timing info
2021-02-22 18:41:55.685186 (Thread-1): Using postgres connection "seed.jaffle_shop.raw_orders".
2021-02-22 18:41:55.685398 (Thread-1): On seed.jaffle_shop.raw_orders: BEGIN
2021-02-22 18:41:55.689618 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-02-22 18:41:55.690445 (Thread-1): Using postgres connection "seed.jaffle_shop.raw_orders".
2021-02-22 18:41:55.690723 (Thread-1): On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */

    create table "dbttest1"."public"."raw_orders" (id integer,user_id integer,order_date date,status text)
  
2021-02-22 18:41:55.699089 (Thread-1): SQL status: CREATE TABLE in 0.01 seconds
2021-02-22 18:41:55.704463 (Thread-1): Using postgres connection "seed.jaffle_shop.raw_orders".
2021-02-22 18:41:55.704716 (Thread-1): On seed.jaffle_shop.raw_orders: 
            insert into "dbttest1"."public"."raw_orders" (id, user_id, order_date, status) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s...
2021-02-22 18:41:55.708359 (Thread-1): SQL status: INSERT 0 99 in 0.00 seconds
2021-02-22 18:41:55.708901 (Thread-1): Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
2021-02-22 18:41:55.712809 (Thread-1): On seed.jaffle_shop.raw_orders: COMMIT
2021-02-22 18:41:55.712979 (Thread-1): Using postgres connection "seed.jaffle_shop.raw_orders".
2021-02-22 18:41:55.713106 (Thread-1): On seed.jaffle_shop.raw_orders: COMMIT
2021-02-22 18:41:55.718795 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-02-22 18:41:55.720841 (Thread-1): finished collecting timing info
2021-02-22 18:41:55.721586 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a26c802-3bab-49e5-a7e7-25cb0d3e36b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d0bbd0>]}
2021-02-22 18:41:55.721851 (Thread-1): 13:41:55 | 2 of 3 OK loaded seed file public.raw_orders......................... [INSERT 99 in 0.05s]
2021-02-22 18:41:55.722024 (Thread-1): Finished running node seed.jaffle_shop.raw_orders
2021-02-22 18:41:55.722205 (Thread-1): Began running node seed.jaffle_shop.raw_payments
2021-02-22 18:41:55.723563 (Thread-1): 13:41:55 | 3 of 3 START seed file public.raw_payments........................... [RUN]
2021-02-22 18:41:55.724127 (Thread-1): Acquiring new postgres connection "seed.jaffle_shop.raw_payments".
2021-02-22 18:41:55.724349 (Thread-1): Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_orders).
2021-02-22 18:41:55.724505 (Thread-1): finished collecting timing info
2021-02-22 18:41:55.736945 (Thread-1): Using postgres connection "seed.jaffle_shop.raw_payments".
2021-02-22 18:41:55.737586 (Thread-1): On seed.jaffle_shop.raw_payments: BEGIN
2021-02-22 18:41:55.741813 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-02-22 18:41:55.742068 (Thread-1): Using postgres connection "seed.jaffle_shop.raw_payments".
2021-02-22 18:41:55.742215 (Thread-1): On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */

    create table "dbttest1"."public"."raw_payments" (id integer,order_id integer,payment_method text,amount integer)
  
2021-02-22 18:41:55.745132 (Thread-1): SQL status: CREATE TABLE in 0.00 seconds
2021-02-22 18:41:55.751540 (Thread-1): Using postgres connection "seed.jaffle_shop.raw_payments".
2021-02-22 18:41:55.751741 (Thread-1): On seed.jaffle_shop.raw_payments: 
            insert into "dbttest1"."public"."raw_payments" (id, order_id, payment_method, amount) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%...
2021-02-22 18:41:55.758211 (Thread-1): SQL status: INSERT 0 113 in 0.01 seconds
2021-02-22 18:41:55.758888 (Thread-1): Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
2021-02-22 18:41:55.762486 (Thread-1): On seed.jaffle_shop.raw_payments: COMMIT
2021-02-22 18:41:55.762693 (Thread-1): Using postgres connection "seed.jaffle_shop.raw_payments".
2021-02-22 18:41:55.762840 (Thread-1): On seed.jaffle_shop.raw_payments: COMMIT
2021-02-22 18:41:55.771535 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-02-22 18:41:55.774054 (Thread-1): finished collecting timing info
2021-02-22 18:41:55.774947 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a26c802-3bab-49e5-a7e7-25cb0d3e36b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105daa3d0>]}
2021-02-22 18:41:55.775324 (Thread-1): 13:41:55 | 3 of 3 OK loaded seed file public.raw_payments....................... [INSERT 113 in 0.05s]
2021-02-22 18:41:55.775559 (Thread-1): Finished running node seed.jaffle_shop.raw_payments
2021-02-22 18:41:55.798157 (MainThread): Using postgres connection "master".
2021-02-22 18:41:55.798378 (MainThread): On master: BEGIN
2021-02-22 18:41:55.800798 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-02-22 18:41:55.801026 (MainThread): On master: COMMIT
2021-02-22 18:41:55.801176 (MainThread): Using postgres connection "master".
2021-02-22 18:41:55.801304 (MainThread): On master: COMMIT
2021-02-22 18:41:55.803827 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-02-22 18:41:55.805275 (MainThread): 13:41:55 | 
2021-02-22 18:41:55.805875 (MainThread): 13:41:55 | Finished running 3 seeds in 0.60s.
2021-02-22 18:41:55.806353 (MainThread): Connection 'master' was left open.
2021-02-22 18:41:55.806782 (MainThread): On master: Close
2021-02-22 18:41:55.807391 (MainThread): Connection 'seed.jaffle_shop.raw_payments' was left open.
2021-02-22 18:41:55.807677 (MainThread): On seed.jaffle_shop.raw_payments: Close
2021-02-22 18:41:55.822682 (MainThread): 
2021-02-22 18:41:55.822946 (MainThread): Completed successfully
2021-02-22 18:41:55.823157 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-02-22 18:41:55.823409 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cd5d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dff5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de02d0>]}
2021-02-22 18:41:55.823693 (MainThread): Flushing usage events
2021-02-23 03:09:41.799799 (MainThread): Running with dbt=0.17.0
2021-02-23 03:09:41.894070 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-23 03:09:41.895228 (MainThread): Tracking: tracking
2021-02-23 03:09:41.915167 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a47d5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a86cc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a86cb50>]}
2021-02-23 03:09:41.939789 (MainThread): Partial parsing not enabled
2021-02-23 03:09:41.943331 (MainThread): Parsing macros/core.sql
2021-02-23 03:09:41.950960 (MainThread): Parsing macros/materializations/helpers.sql
2021-02-23 03:09:41.963969 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-02-23 03:09:41.966782 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-02-23 03:09:41.986949 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-02-23 03:09:42.022412 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-02-23 03:09:42.047831 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-02-23 03:09:42.050719 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-02-23 03:09:42.058939 (MainThread): Parsing macros/materializations/common/merge.sql
2021-02-23 03:09:42.075999 (MainThread): Parsing macros/materializations/table/table.sql
2021-02-23 03:09:42.085003 (MainThread): Parsing macros/materializations/view/view.sql
2021-02-23 03:09:42.092772 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-02-23 03:09:42.098716 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-02-23 03:09:42.100237 (MainThread): Parsing macros/etc/query.sql
2021-02-23 03:09:42.101901 (MainThread): Parsing macros/etc/is_incremental.sql
2021-02-23 03:09:42.104374 (MainThread): Parsing macros/etc/datetime.sql
2021-02-23 03:09:42.116134 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-02-23 03:09:42.118852 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-02-23 03:09:42.121060 (MainThread): Parsing macros/adapters/common.sql
2021-02-23 03:09:42.182416 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-02-23 03:09:42.184187 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-02-23 03:09:42.185606 (MainThread): Parsing macros/schema_tests/unique.sql
2021-02-23 03:09:42.187126 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-02-23 03:09:42.190137 (MainThread): Parsing macros/catalog.sql
2021-02-23 03:09:42.193172 (MainThread): Parsing macros/relations.sql
2021-02-23 03:09:42.195195 (MainThread): Parsing macros/adapters.sql
2021-02-23 03:09:42.220351 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-02-23 03:09:42.241938 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0
2021-02-23 03:09:42.242613 (MainThread): Partial parsing not enabled
2021-02-23 03:09:42.283329 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2021-02-23 03:09:42.283507 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:09:42.315893 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2021-02-23 03:09:42.316082 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:09:42.324645 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2021-02-23 03:09:42.324786 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:09:42.333171 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2021-02-23 03:09:42.333350 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:09:42.343943 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2021-02-23 03:09:42.344096 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:09:42.377607 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2021-02-23 03:09:42.377755 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:09:42.385798 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2021-02-23 03:09:42.385945 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:09:42.394291 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:09:42.394432 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:09:42.851323 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 134 macros, 0 operations, 3 seed files, 0 sources
2021-02-23 03:09:42.853773 (MainThread): 
2021-02-23 03:09:42.854185 (MainThread): Acquiring new postgres connection "master".
2021-02-23 03:09:42.854316 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:09:42.865156 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dbttest1".
2021-02-23 03:09:42.865437 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-23 03:09:42.879662 (ThreadPoolExecutor-0_0): Using postgres connection "list_dbttest1".
2021-02-23 03:09:42.879840 (ThreadPoolExecutor-0_0): On list_dbttest1: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1"} */

    select distinct nspname from pg_namespace
  
2021-02-23 03:09:42.917371 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.04 seconds
2021-02-23 03:09:42.969649 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dbttest1_public".
2021-02-23 03:09:42.969873 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_dbttest1).
2021-02-23 03:09:42.975831 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2021-02-23 03:09:42.975989 (ThreadPoolExecutor-1_0): On list_dbttest1_public: BEGIN
2021-02-23 03:09:42.977416 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:09:42.977561 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2021-02-23 03:09:42.977655 (ThreadPoolExecutor-1_0): On list_dbttest1_public: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1_public"} */
select
      'dbttest1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbttest1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-02-23 03:09:42.992281 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.01 seconds
2021-02-23 03:09:42.995141 (ThreadPoolExecutor-1_0): On list_dbttest1_public: ROLLBACK
2021-02-23 03:09:43.038184 (MainThread): Using postgres connection "master".
2021-02-23 03:09:43.038335 (MainThread): On master: BEGIN
2021-02-23 03:09:43.051750 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-02-23 03:09:43.051955 (MainThread): Using postgres connection "master".
2021-02-23 03:09:43.052061 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-02-23 03:09:43.075005 (MainThread): SQL status: SELECT 0 in 0.02 seconds
2021-02-23 03:09:43.075337 (MainThread): On master: ROLLBACK
2021-02-23 03:09:43.076734 (MainThread): Using postgres connection "master".
2021-02-23 03:09:43.076874 (MainThread): On master: BEGIN
2021-02-23 03:09:43.078697 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:09:43.078874 (MainThread): On master: COMMIT
2021-02-23 03:09:43.078984 (MainThread): Using postgres connection "master".
2021-02-23 03:09:43.079077 (MainThread): On master: COMMIT
2021-02-23 03:09:43.080138 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-02-23 03:09:43.080450 (MainThread): 22:09:43 | Concurrency: 1 threads (target='dev')
2021-02-23 03:09:43.080596 (MainThread): 22:09:43 | 
2021-02-23 03:09:43.082548 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-02-23 03:09:43.083661 (Thread-1): 22:09:43 | 1 of 8 START view model public.stg_orders............................ [RUN]
2021-02-23 03:09:43.084050 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2021-02-23 03:09:43.084169 (Thread-1): Re-using an available connection from the pool (formerly list_dbttest1_public).
2021-02-23 03:09:43.084280 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-02-23 03:09:43.104142 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-02-23 03:09:43.106147 (Thread-1): finished collecting timing info
2021-02-23 03:09:43.136204 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2021-02-23 03:09:43.136375 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbttest1"."public"."stg_orders__dbt_tmp" cascade
2021-02-23 03:09:43.146825 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-02-23 03:09:43.150327 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2021-02-23 03:09:43.150504 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbttest1"."public"."stg_orders__dbt_backup" cascade
2021-02-23 03:09:43.153173 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-02-23 03:09:43.158702 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-02-23 03:09:43.159231 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2021-02-23 03:09:43.159339 (Thread-1): On model.jaffle_shop.stg_orders: BEGIN
2021-02-23 03:09:43.161561 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:09:43.161746 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2021-02-23 03:09:43.161857 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "dbttest1"."public"."stg_orders__dbt_tmp" as (
    with source as (
    select * from "dbttest1"."public"."raw_orders"

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from renamed
  );

2021-02-23 03:09:43.198290 (Thread-1): SQL status: CREATE VIEW in 0.04 seconds
2021-02-23 03:09:43.204747 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2021-02-23 03:09:43.204906 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbttest1"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
2021-02-23 03:09:43.207415 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-02-23 03:09:43.214869 (Thread-1): On model.jaffle_shop.stg_orders: COMMIT
2021-02-23 03:09:43.215028 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2021-02-23 03:09:43.215122 (Thread-1): On model.jaffle_shop.stg_orders: COMMIT
2021-02-23 03:09:43.227419 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-02-23 03:09:43.231421 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2021-02-23 03:09:43.231556 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbttest1"."public"."stg_orders__dbt_backup" cascade
2021-02-23 03:09:43.232979 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-02-23 03:09:43.235452 (Thread-1): finished collecting timing info
2021-02-23 03:09:43.236092 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c8e8b35-1b66-4987-b88b-22341b34ac8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad77890>]}
2021-02-23 03:09:43.237304 (Thread-1): 22:09:43 | 1 of 8 OK created view model public.stg_orders....................... [CREATE VIEW in 0.15s]
2021-02-23 03:09:43.237485 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-02-23 03:09:43.237626 (Thread-1): Began running node model.jaffle_shop.stg_payments
2021-02-23 03:09:43.238640 (Thread-1): 22:09:43 | 2 of 8 START view model public.stg_payments.......................... [RUN]
2021-02-23 03:09:43.239043 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2021-02-23 03:09:43.239218 (Thread-1): Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders).
2021-02-23 03:09:43.239318 (Thread-1): Compiling model.jaffle_shop.stg_payments
2021-02-23 03:09:43.248084 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-02-23 03:09:43.248613 (Thread-1): finished collecting timing info
2021-02-23 03:09:43.255344 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2021-02-23 03:09:43.255510 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbttest1"."public"."stg_payments__dbt_tmp" cascade
2021-02-23 03:09:43.257329 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-02-23 03:09:43.259812 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2021-02-23 03:09:43.259984 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbttest1"."public"."stg_payments__dbt_backup" cascade
2021-02-23 03:09:43.261562 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-02-23 03:09:43.262816 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2021-02-23 03:09:43.263232 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2021-02-23 03:09:43.263329 (Thread-1): On model.jaffle_shop.stg_payments: BEGIN
2021-02-23 03:09:43.264672 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:09:43.264902 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2021-02-23 03:09:43.265005 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "dbttest1"."public"."stg_payments__dbt_tmp" as (
    with source as (
    select * from "dbttest1"."public"."raw_payments"

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        --`amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed
  );

2021-02-23 03:09:43.283115 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2021-02-23 03:09:43.285700 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2021-02-23 03:09:43.285883 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbttest1"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
2021-02-23 03:09:43.287506 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-02-23 03:09:43.288715 (Thread-1): On model.jaffle_shop.stg_payments: COMMIT
2021-02-23 03:09:43.288840 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2021-02-23 03:09:43.288936 (Thread-1): On model.jaffle_shop.stg_payments: COMMIT
2021-02-23 03:09:43.290783 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-02-23 03:09:43.292497 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2021-02-23 03:09:43.292626 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbttest1"."public"."stg_payments__dbt_backup" cascade
2021-02-23 03:09:43.293946 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-02-23 03:09:43.296275 (Thread-1): finished collecting timing info
2021-02-23 03:09:43.296871 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c8e8b35-1b66-4987-b88b-22341b34ac8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9fc5d0>]}
2021-02-23 03:09:43.298062 (Thread-1): 22:09:43 | 2 of 8 OK created view model public.stg_payments..................... [CREATE VIEW in 0.06s]
2021-02-23 03:09:43.298205 (Thread-1): Finished running node model.jaffle_shop.stg_payments
2021-02-23 03:09:43.298347 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-02-23 03:09:43.299417 (Thread-1): 22:09:43 | 3 of 8 START view model public.stg_customers......................... [RUN]
2021-02-23 03:09:43.299851 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2021-02-23 03:09:43.299947 (Thread-1): Re-using an available connection from the pool (formerly model.jaffle_shop.stg_payments).
2021-02-23 03:09:43.300039 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-02-23 03:09:43.308310 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-02-23 03:09:43.309523 (Thread-1): finished collecting timing info
2021-02-23 03:09:43.319739 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2021-02-23 03:09:43.319923 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbttest1"."public"."stg_customers__dbt_tmp" cascade
2021-02-23 03:09:43.321534 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-02-23 03:09:43.323880 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2021-02-23 03:09:43.324008 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbttest1"."public"."stg_customers__dbt_backup" cascade
2021-02-23 03:09:43.325338 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-02-23 03:09:43.326586 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-02-23 03:09:43.327031 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2021-02-23 03:09:43.327160 (Thread-1): On model.jaffle_shop.stg_customers: BEGIN
2021-02-23 03:09:43.328476 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:09:43.328635 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2021-02-23 03:09:43.328731 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "dbttest1"."public"."stg_customers__dbt_tmp" as (
    with source as (
    select * from "dbttest1"."public"."raw_customers"

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name,
        email

    from source

)

select * from renamed
  );

2021-02-23 03:09:43.330791 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-02-23 03:09:43.333249 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2021-02-23 03:09:43.333397 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbttest1"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
2021-02-23 03:09:43.335515 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-02-23 03:09:43.336667 (Thread-1): On model.jaffle_shop.stg_customers: COMMIT
2021-02-23 03:09:43.336781 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2021-02-23 03:09:43.336867 (Thread-1): On model.jaffle_shop.stg_customers: COMMIT
2021-02-23 03:09:43.338994 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-02-23 03:09:43.340862 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2021-02-23 03:09:43.341055 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbttest1"."public"."stg_customers__dbt_backup" cascade
2021-02-23 03:09:43.342705 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-02-23 03:09:43.345447 (Thread-1): finished collecting timing info
2021-02-23 03:09:43.346176 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c8e8b35-1b66-4987-b88b-22341b34ac8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad915d0>]}
2021-02-23 03:09:43.347254 (Thread-1): 22:09:43 | 3 of 8 OK created view model public.stg_customers.................... [CREATE VIEW in 0.05s]
2021-02-23 03:09:43.347391 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-02-23 03:09:43.347524 (Thread-1): Began running node model.jaffle_shop.customer_orders
2021-02-23 03:09:43.348540 (Thread-1): 22:09:43 | 4 of 8 START table model public.customer_orders...................... [RUN]
2021-02-23 03:09:43.349013 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:09:43.349122 (Thread-1): Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers).
2021-02-23 03:09:43.349216 (Thread-1): Compiling model.jaffle_shop.customer_orders
2021-02-23 03:09:43.355897 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customer_orders"
2021-02-23 03:09:43.356460 (Thread-1): finished collecting timing info
2021-02-23 03:09:43.380899 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:09:43.381068 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
drop table if exists "dbttest1"."public"."customer_orders__dbt_tmp" cascade
2021-02-23 03:09:43.383794 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-02-23 03:09:43.386015 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:09:43.386128 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
drop table if exists "dbttest1"."public"."customer_orders__dbt_backup" cascade
2021-02-23 03:09:43.387699 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-02-23 03:09:43.395015 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customer_orders"
2021-02-23 03:09:43.398188 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:09:43.398321 (Thread-1): On model.jaffle_shop.customer_orders: BEGIN
2021-02-23 03:09:43.399964 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:09:43.400136 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:09:43.400236 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */


  create  table "dbttest1"."public"."customer_orders__dbt_tmp"
  as (
    with orders as (

    select * from "dbttest1"."public"."stg_orders"

),

final as (

    select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by 1

),

delay as (
    select pg_sleep(10)
)

select
    *
from final
left join delay
  );
2021-02-23 03:09:43.402822 (Thread-1): Postgres error: syntax error at or near ")"
LINE 34:   );
           ^

2021-02-23 03:09:43.403125 (Thread-1): On model.jaffle_shop.customer_orders: ROLLBACK
2021-02-23 03:09:43.404821 (Thread-1): finished collecting timing info
2021-02-23 03:09:43.405423 (Thread-1): Database Error in model customer_orders (models/marts/core/intermediate/customer_orders.sql)
  syntax error at or near ")"
  LINE 34:   );
             ^
  compiled SQL at target/run/jaffle_shop/models/marts/core/intermediate/customer_orders.sql
Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near ")"
LINE 34:   );
           ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 119, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/Users/naveen/.pyenv/versions/3.7.4/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model customer_orders (models/marts/core/intermediate/customer_orders.sql)
  syntax error at or near ")"
  LINE 34:   );
             ^
  compiled SQL at target/run/jaffle_shop/models/marts/core/intermediate/customer_orders.sql
2021-02-23 03:09:43.412067 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c8e8b35-1b66-4987-b88b-22341b34ac8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad931d0>]}
2021-02-23 03:09:43.413201 (Thread-1): 22:09:43 | 4 of 8 ERROR creating table model public.customer_orders............. [ERROR in 0.06s]
2021-02-23 03:09:43.413347 (Thread-1): Finished running node model.jaffle_shop.customer_orders
2021-02-23 03:09:43.413483 (Thread-1): Began running node model.jaffle_shop.customer_payments
2021-02-23 03:09:43.414552 (Thread-1): 22:09:43 | 5 of 8 START table model public.customer_payments.................... [RUN]
2021-02-23 03:09:43.414842 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2021-02-23 03:09:43.414937 (Thread-1): Re-using an available connection from the pool (formerly model.jaffle_shop.customer_orders).
2021-02-23 03:09:43.415029 (Thread-1): Compiling model.jaffle_shop.customer_payments
2021-02-23 03:09:43.424252 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customer_payments"
2021-02-23 03:09:43.424713 (Thread-1): finished collecting timing info
2021-02-23 03:09:43.430922 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2021-02-23 03:09:43.431057 (Thread-1): On model.jaffle_shop.customer_payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_payments"} */
drop table if exists "dbttest1"."public"."customer_payments__dbt_tmp" cascade
2021-02-23 03:09:43.433735 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-02-23 03:09:43.436246 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2021-02-23 03:09:43.436419 (Thread-1): On model.jaffle_shop.customer_payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_payments"} */
drop table if exists "dbttest1"."public"."customer_payments__dbt_backup" cascade
2021-02-23 03:09:43.437923 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-02-23 03:09:43.440859 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customer_payments"
2021-02-23 03:09:43.441424 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2021-02-23 03:09:43.441542 (Thread-1): On model.jaffle_shop.customer_payments: BEGIN
2021-02-23 03:09:43.442986 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:09:43.443137 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2021-02-23 03:09:43.443231 (Thread-1): On model.jaffle_shop.customer_payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_payments"} */


  create  table "dbttest1"."public"."customer_payments__dbt_tmp"
  as (
    with payments as (

    select * from "dbttest1"."public"."stg_payments"

),

orders as (

    select * from "dbttest1"."public"."stg_orders"

),

final as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders using (order_id)

    group by 1

)

select * from final
  );
2021-02-23 03:09:43.480826 (Thread-1): SQL status: SELECT 62 in 0.04 seconds
2021-02-23 03:09:43.483278 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2021-02-23 03:09:43.483425 (Thread-1): On model.jaffle_shop.customer_payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_payments"} */
alter table "dbttest1"."public"."customer_payments__dbt_tmp" rename to "customer_payments"
2021-02-23 03:09:43.485417 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-02-23 03:09:43.486605 (Thread-1): On model.jaffle_shop.customer_payments: COMMIT
2021-02-23 03:09:43.486721 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2021-02-23 03:09:43.486811 (Thread-1): On model.jaffle_shop.customer_payments: COMMIT
2021-02-23 03:09:43.489891 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-02-23 03:09:43.491617 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2021-02-23 03:09:43.491729 (Thread-1): On model.jaffle_shop.customer_payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_payments"} */
drop table if exists "dbttest1"."public"."customer_payments__dbt_backup" cascade
2021-02-23 03:09:43.492835 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-02-23 03:09:43.495144 (Thread-1): finished collecting timing info
2021-02-23 03:09:43.495751 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c8e8b35-1b66-4987-b88b-22341b34ac8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adbc3d0>]}
2021-02-23 03:09:43.496790 (Thread-1): 22:09:43 | 5 of 8 OK created table model public.customer_payments............... [SELECT 62 in 0.08s]
2021-02-23 03:09:43.496929 (Thread-1): Finished running node model.jaffle_shop.customer_payments
2021-02-23 03:09:43.497064 (Thread-1): Began running node model.jaffle_shop.order_payments
2021-02-23 03:09:43.498126 (Thread-1): 22:09:43 | 6 of 8 START table model public.order_payments....................... [RUN]
2021-02-23 03:09:43.498491 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2021-02-23 03:09:43.498585 (Thread-1): Re-using an available connection from the pool (formerly model.jaffle_shop.customer_payments).
2021-02-23 03:09:43.498677 (Thread-1): Compiling model.jaffle_shop.order_payments
2021-02-23 03:09:43.506415 (Thread-1): Writing injected SQL for node "model.jaffle_shop.order_payments"
2021-02-23 03:09:43.506867 (Thread-1): finished collecting timing info
2021-02-23 03:09:43.514270 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2021-02-23 03:09:43.514428 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */
drop table if exists "dbttest1"."public"."order_payments__dbt_tmp" cascade
2021-02-23 03:09:43.516302 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-02-23 03:09:43.518950 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2021-02-23 03:09:43.519096 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */
drop table if exists "dbttest1"."public"."order_payments__dbt_backup" cascade
2021-02-23 03:09:43.522325 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-02-23 03:09:43.523874 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.order_payments"
2021-02-23 03:09:43.524407 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2021-02-23 03:09:43.524559 (Thread-1): On model.jaffle_shop.order_payments: BEGIN
2021-02-23 03:09:43.526052 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:09:43.526212 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2021-02-23 03:09:43.526306 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */


  create  table "dbttest1"."public"."order_payments__dbt_tmp"
  as (
    

with payments as (

    select * from "dbttest1"."public"."stg_payments"

),

final as (

    select
        order_id,

        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,
        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,
        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,
        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,
        sum(amount) as total_amount

    from payments

    group by 1

)

select * from final
  );
2021-02-23 03:09:43.530425 (Thread-1): SQL status: SELECT 99 in 0.00 seconds
2021-02-23 03:09:43.532979 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2021-02-23 03:09:43.533124 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */
alter table "dbttest1"."public"."order_payments__dbt_tmp" rename to "order_payments"
2021-02-23 03:09:43.541453 (Thread-1): SQL status: ALTER TABLE in 0.01 seconds
2021-02-23 03:09:43.543087 (Thread-1): On model.jaffle_shop.order_payments: COMMIT
2021-02-23 03:09:43.543222 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2021-02-23 03:09:43.543323 (Thread-1): On model.jaffle_shop.order_payments: COMMIT
2021-02-23 03:09:43.546257 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-02-23 03:09:43.547950 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2021-02-23 03:09:43.548209 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */
drop table if exists "dbttest1"."public"."order_payments__dbt_backup" cascade
2021-02-23 03:09:43.549602 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-02-23 03:09:43.552005 (Thread-1): finished collecting timing info
2021-02-23 03:09:43.552619 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c8e8b35-1b66-4987-b88b-22341b34ac8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adbcb90>]}
2021-02-23 03:09:43.553636 (Thread-1): 22:09:43 | 6 of 8 OK created table model public.order_payments.................. [SELECT 99 in 0.05s]
2021-02-23 03:09:43.553774 (Thread-1): Finished running node model.jaffle_shop.order_payments
2021-02-23 03:09:43.553985 (Thread-1): Began running node model.jaffle_shop.dim_customers
2021-02-23 03:09:43.554330 (Thread-1): 22:09:43 | 7 of 8 SKIP relation public.dim_customers............................ [SKIP]
2021-02-23 03:09:43.554478 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2021-02-23 03:09:43.554604 (Thread-1): Began running node model.jaffle_shop.fct_orders
2021-02-23 03:09:43.555637 (Thread-1): 22:09:43 | 8 of 8 START table model public.fct_orders........................... [RUN]
2021-02-23 03:09:43.555924 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2021-02-23 03:09:43.556015 (Thread-1): Re-using an available connection from the pool (formerly model.jaffle_shop.order_payments).
2021-02-23 03:09:43.556107 (Thread-1): Compiling model.jaffle_shop.fct_orders
2021-02-23 03:09:43.570721 (Thread-1): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-02-23 03:09:43.571174 (Thread-1): finished collecting timing info
2021-02-23 03:09:43.577757 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2021-02-23 03:09:43.577896 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "dbttest1"."public"."fct_orders__dbt_tmp" cascade
2021-02-23 03:09:43.579688 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-02-23 03:09:43.582133 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2021-02-23 03:09:43.582278 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "dbttest1"."public"."fct_orders__dbt_backup" cascade
2021-02-23 03:09:43.583867 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-02-23 03:09:43.585119 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.fct_orders"
2021-02-23 03:09:43.585541 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2021-02-23 03:09:43.585658 (Thread-1): On model.jaffle_shop.fct_orders: BEGIN
2021-02-23 03:09:43.586873 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:09:43.587019 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2021-02-23 03:09:43.587110 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */


  create  table "dbttest1"."public"."fct_orders__dbt_tmp"
  as (
    

with orders as (

    select * from "dbttest1"."public"."stg_orders"

),

order_payments as (

    select * from "dbttest1"."public"."order_payments"

),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.status,

        order_payments.credit_card_amount,

        order_payments.coupon_amount,

        order_payments.bank_transfer_amount,

        order_payments.gift_card_amount,

        order_payments.total_amount as amount

    from orders

    left join order_payments using (order_id)

)

select * from final
  );
2021-02-23 03:09:43.598198 (Thread-1): SQL status: SELECT 99 in 0.01 seconds
2021-02-23 03:09:43.600834 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2021-02-23 03:09:43.600981 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbttest1"."public"."fct_orders__dbt_tmp" rename to "fct_orders"
2021-02-23 03:09:43.602326 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-02-23 03:09:43.603433 (Thread-1): On model.jaffle_shop.fct_orders: COMMIT
2021-02-23 03:09:43.603545 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2021-02-23 03:09:43.603630 (Thread-1): On model.jaffle_shop.fct_orders: COMMIT
2021-02-23 03:09:43.609013 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-02-23 03:09:43.610670 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2021-02-23 03:09:43.610938 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "dbttest1"."public"."fct_orders__dbt_backup" cascade
2021-02-23 03:09:43.612175 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-02-23 03:09:43.614598 (Thread-1): finished collecting timing info
2021-02-23 03:09:43.615423 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c8e8b35-1b66-4987-b88b-22341b34ac8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa2c650>]}
2021-02-23 03:09:43.616962 (Thread-1): 22:09:43 | 8 of 8 OK created table model public.fct_orders...................... [SELECT 99 in 0.06s]
2021-02-23 03:09:43.617148 (Thread-1): Finished running node model.jaffle_shop.fct_orders
2021-02-23 03:09:43.703713 (MainThread): Using postgres connection "master".
2021-02-23 03:09:43.703886 (MainThread): On master: BEGIN
2021-02-23 03:09:43.705170 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:09:43.705330 (MainThread): On master: COMMIT
2021-02-23 03:09:43.705427 (MainThread): Using postgres connection "master".
2021-02-23 03:09:43.705512 (MainThread): On master: COMMIT
2021-02-23 03:09:43.706486 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-02-23 03:09:43.706864 (MainThread): 22:09:43 | 
2021-02-23 03:09:43.707017 (MainThread): 22:09:43 | Finished running 3 view models, 5 table models in 0.85s.
2021-02-23 03:09:43.707226 (MainThread): Connection 'master' was left open.
2021-02-23 03:09:43.707351 (MainThread): On master: Close
2021-02-23 03:09:43.707537 (MainThread): Connection 'model.jaffle_shop.fct_orders' was left open.
2021-02-23 03:09:43.707712 (MainThread): On model.jaffle_shop.fct_orders: Close
2021-02-23 03:09:43.733223 (MainThread): 
2021-02-23 03:09:43.733441 (MainThread): Completed with 1 error and 0 warnings:
2021-02-23 03:09:43.733582 (MainThread): 
2021-02-23 03:09:43.733763 (MainThread): Database Error in model customer_orders (models/marts/core/intermediate/customer_orders.sql)
2021-02-23 03:09:43.733934 (MainThread):   syntax error at or near ")"
2021-02-23 03:09:43.734111 (MainThread):   LINE 34:   );
2021-02-23 03:09:43.734239 (MainThread):              ^
2021-02-23 03:09:43.734342 (MainThread):   compiled SQL at target/run/jaffle_shop/models/marts/core/intermediate/customer_orders.sql
2021-02-23 03:09:43.734452 (MainThread): 
Done. PASS=6 WARN=0 ERROR=1 SKIP=1 TOTAL=8
2021-02-23 03:09:43.734623 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad2add0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae3a790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae3ac90>]}
2021-02-23 03:09:43.734808 (MainThread): Flushing usage events
2021-02-23 03:10:47.398575 (MainThread): Running with dbt=0.17.0
2021-02-23 03:10:47.481307 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['customer_orders'], partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-23 03:10:47.482812 (MainThread): Tracking: tracking
2021-02-23 03:10:47.516740 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f473b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f85ab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f85aad0>]}
2021-02-23 03:10:47.569231 (MainThread): Partial parsing not enabled
2021-02-23 03:10:47.574232 (MainThread): Parsing macros/core.sql
2021-02-23 03:10:47.586140 (MainThread): Parsing macros/materializations/helpers.sql
2021-02-23 03:10:47.597250 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-02-23 03:10:47.602479 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-02-23 03:10:47.628294 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-02-23 03:10:47.664989 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-02-23 03:10:47.689637 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-02-23 03:10:47.692026 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-02-23 03:10:47.702587 (MainThread): Parsing macros/materializations/common/merge.sql
2021-02-23 03:10:47.728930 (MainThread): Parsing macros/materializations/table/table.sql
2021-02-23 03:10:47.739870 (MainThread): Parsing macros/materializations/view/view.sql
2021-02-23 03:10:47.748702 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-02-23 03:10:47.756448 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-02-23 03:10:47.757846 (MainThread): Parsing macros/etc/query.sql
2021-02-23 03:10:47.759327 (MainThread): Parsing macros/etc/is_incremental.sql
2021-02-23 03:10:47.761557 (MainThread): Parsing macros/etc/datetime.sql
2021-02-23 03:10:47.777092 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-02-23 03:10:47.779745 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-02-23 03:10:47.781790 (MainThread): Parsing macros/adapters/common.sql
2021-02-23 03:10:47.842086 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-02-23 03:10:47.843856 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-02-23 03:10:47.845362 (MainThread): Parsing macros/schema_tests/unique.sql
2021-02-23 03:10:47.846716 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-02-23 03:10:47.849719 (MainThread): Parsing macros/catalog.sql
2021-02-23 03:10:47.853199 (MainThread): Parsing macros/relations.sql
2021-02-23 03:10:47.855541 (MainThread): Parsing macros/adapters.sql
2021-02-23 03:10:47.888015 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-02-23 03:10:47.914599 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0
2021-02-23 03:10:47.915233 (MainThread): Partial parsing not enabled
2021-02-23 03:10:47.955151 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2021-02-23 03:10:47.955313 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:10:47.985041 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2021-02-23 03:10:47.985186 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:10:47.992260 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2021-02-23 03:10:47.992401 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:10:47.999256 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2021-02-23 03:10:47.999386 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:10:48.018071 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2021-02-23 03:10:48.018275 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:10:48.055956 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2021-02-23 03:10:48.056099 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:10:48.063442 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2021-02-23 03:10:48.063575 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:10:48.071688 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:10:48.071835 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:10:48.558356 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 134 macros, 0 operations, 3 seed files, 0 sources
2021-02-23 03:10:48.560511 (MainThread): 
2021-02-23 03:10:48.560931 (MainThread): Acquiring new postgres connection "master".
2021-02-23 03:10:48.561053 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:10:48.562952 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dbttest1".
2021-02-23 03:10:48.563144 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-23 03:10:48.573761 (ThreadPoolExecutor-0_0): Using postgres connection "list_dbttest1".
2021-02-23 03:10:48.573913 (ThreadPoolExecutor-0_0): On list_dbttest1: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1"} */

    select distinct nspname from pg_namespace
  
2021-02-23 03:10:48.584969 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-02-23 03:10:48.633415 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dbttest1_public".
2021-02-23 03:10:48.633632 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_dbttest1).
2021-02-23 03:10:48.644360 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2021-02-23 03:10:48.644579 (ThreadPoolExecutor-1_0): On list_dbttest1_public: BEGIN
2021-02-23 03:10:48.646829 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:10:48.647163 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2021-02-23 03:10:48.647440 (ThreadPoolExecutor-1_0): On list_dbttest1_public: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1_public"} */
select
      'dbttest1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbttest1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-02-23 03:10:48.655945 (ThreadPoolExecutor-1_0): SQL status: SELECT 9 in 0.01 seconds
2021-02-23 03:10:48.669299 (ThreadPoolExecutor-1_0): On list_dbttest1_public: ROLLBACK
2021-02-23 03:10:48.750158 (MainThread): Using postgres connection "master".
2021-02-23 03:10:48.750315 (MainThread): On master: BEGIN
2021-02-23 03:10:48.760217 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-02-23 03:10:48.760389 (MainThread): Using postgres connection "master".
2021-02-23 03:10:48.760481 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-02-23 03:10:48.766322 (MainThread): SQL status: SELECT 3 in 0.01 seconds
2021-02-23 03:10:48.770462 (MainThread): On master: ROLLBACK
2021-02-23 03:10:48.771781 (MainThread): Using postgres connection "master".
2021-02-23 03:10:48.771929 (MainThread): On master: BEGIN
2021-02-23 03:10:48.773978 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:10:48.774211 (MainThread): On master: COMMIT
2021-02-23 03:10:48.774325 (MainThread): Using postgres connection "master".
2021-02-23 03:10:48.774410 (MainThread): On master: COMMIT
2021-02-23 03:10:48.775142 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-02-23 03:10:48.775463 (MainThread): 22:10:48 | Concurrency: 1 threads (target='dev')
2021-02-23 03:10:48.775600 (MainThread): 22:10:48 | 
2021-02-23 03:10:48.776745 (Thread-1): Began running node model.jaffle_shop.customer_orders
2021-02-23 03:10:48.777782 (Thread-1): 22:10:48 | 1 of 1 START table model public.customer_orders...................... [RUN]
2021-02-23 03:10:48.778065 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:10:48.778152 (Thread-1): Re-using an available connection from the pool (formerly list_dbttest1_public).
2021-02-23 03:10:48.778247 (Thread-1): Compiling model.jaffle_shop.customer_orders
2021-02-23 03:10:48.802850 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customer_orders"
2021-02-23 03:10:48.803509 (Thread-1): finished collecting timing info
2021-02-23 03:10:48.832455 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:10:48.832648 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
drop table if exists "dbttest1"."public"."customer_orders__dbt_tmp" cascade
2021-02-23 03:10:48.835126 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-02-23 03:10:48.837541 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:10:48.837671 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
drop table if exists "dbttest1"."public"."customer_orders__dbt_backup" cascade
2021-02-23 03:10:48.838886 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-02-23 03:10:48.850794 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customer_orders"
2021-02-23 03:10:48.851309 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:10:48.851414 (Thread-1): On model.jaffle_shop.customer_orders: BEGIN
2021-02-23 03:10:48.853173 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:10:48.853374 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:10:48.853469 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */


  create  table "dbttest1"."public"."customer_orders__dbt_tmp"
  as (
    with orders as (

    select * from "dbttest1"."public"."stg_orders"

),

final as (

    select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by 1

),

delay_ as (
    select pg_sleep(10)
)

select
    *
from final
left join delay_
  );
2021-02-23 03:10:48.855016 (Thread-1): Postgres error: syntax error at or near ")"
LINE 34:   );
           ^

2021-02-23 03:10:48.855172 (Thread-1): On model.jaffle_shop.customer_orders: ROLLBACK
2021-02-23 03:10:48.856136 (Thread-1): finished collecting timing info
2021-02-23 03:10:48.856607 (Thread-1): Database Error in model customer_orders (models/marts/core/intermediate/customer_orders.sql)
  syntax error at or near ")"
  LINE 34:   );
             ^
  compiled SQL at target/run/jaffle_shop/models/marts/core/intermediate/customer_orders.sql
Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near ")"
LINE 34:   );
           ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 119, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/Users/naveen/.pyenv/versions/3.7.4/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model customer_orders (models/marts/core/intermediate/customer_orders.sql)
  syntax error at or near ")"
  LINE 34:   );
             ^
  compiled SQL at target/run/jaffle_shop/models/marts/core/intermediate/customer_orders.sql
2021-02-23 03:10:48.858626 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc7ceee-9a1e-40e7-a58f-f9c0f99d8202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd0dad0>]}
2021-02-23 03:10:48.859768 (Thread-1): 22:10:48 | 1 of 1 ERROR creating table model public.customer_orders............. [ERROR in 0.08s]
2021-02-23 03:10:48.859920 (Thread-1): Finished running node model.jaffle_shop.customer_orders
2021-02-23 03:10:48.883071 (MainThread): Using postgres connection "master".
2021-02-23 03:10:48.883231 (MainThread): On master: BEGIN
2021-02-23 03:10:48.884433 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:10:48.884599 (MainThread): On master: COMMIT
2021-02-23 03:10:48.884690 (MainThread): Using postgres connection "master".
2021-02-23 03:10:48.884794 (MainThread): On master: COMMIT
2021-02-23 03:10:48.885908 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-02-23 03:10:48.886246 (MainThread): 22:10:48 | 
2021-02-23 03:10:48.886383 (MainThread): 22:10:48 | Finished running 1 table model in 0.33s.
2021-02-23 03:10:48.886499 (MainThread): Connection 'master' was left open.
2021-02-23 03:10:48.886589 (MainThread): On master: Close
2021-02-23 03:10:48.886699 (MainThread): Connection 'model.jaffle_shop.customer_orders' was left open.
2021-02-23 03:10:48.886838 (MainThread): On model.jaffle_shop.customer_orders: Close
2021-02-23 03:10:48.890945 (MainThread): 
2021-02-23 03:10:48.891152 (MainThread): Completed with 1 error and 0 warnings:
2021-02-23 03:10:48.891313 (MainThread): 
2021-02-23 03:10:48.891465 (MainThread): Database Error in model customer_orders (models/marts/core/intermediate/customer_orders.sql)
2021-02-23 03:10:48.891585 (MainThread):   syntax error at or near ")"
2021-02-23 03:10:48.891705 (MainThread):   LINE 34:   );
2021-02-23 03:10:48.891807 (MainThread):              ^
2021-02-23 03:10:48.891897 (MainThread):   compiled SQL at target/run/jaffle_shop/models/marts/core/intermediate/customer_orders.sql
2021-02-23 03:10:48.892005 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-02-23 03:10:48.892176 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd536d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd5eed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fdab510>]}
2021-02-23 03:10:48.892390 (MainThread): Flushing usage events
2021-02-23 03:12:33.583362 (MainThread): Running with dbt=0.17.0
2021-02-23 03:12:33.674371 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['customer_orders'], partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-23 03:12:33.675084 (MainThread): Tracking: tracking
2021-02-23 03:12:33.692295 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e75ea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb4ed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb4ec90>]}
2021-02-23 03:12:33.714314 (MainThread): Partial parsing not enabled
2021-02-23 03:12:33.716539 (MainThread): Parsing macros/core.sql
2021-02-23 03:12:33.721873 (MainThread): Parsing macros/materializations/helpers.sql
2021-02-23 03:12:33.730822 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-02-23 03:12:33.732977 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-02-23 03:12:33.753418 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-02-23 03:12:33.787835 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-02-23 03:12:33.812311 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-02-23 03:12:33.814505 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-02-23 03:12:33.822387 (MainThread): Parsing macros/materializations/common/merge.sql
2021-02-23 03:12:33.838781 (MainThread): Parsing macros/materializations/table/table.sql
2021-02-23 03:12:33.847225 (MainThread): Parsing macros/materializations/view/view.sql
2021-02-23 03:12:33.855330 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-02-23 03:12:33.861654 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-02-23 03:12:33.862944 (MainThread): Parsing macros/etc/query.sql
2021-02-23 03:12:33.864370 (MainThread): Parsing macros/etc/is_incremental.sql
2021-02-23 03:12:33.866537 (MainThread): Parsing macros/etc/datetime.sql
2021-02-23 03:12:33.877869 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-02-23 03:12:33.880235 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-02-23 03:12:33.882774 (MainThread): Parsing macros/adapters/common.sql
2021-02-23 03:12:33.943032 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-02-23 03:12:33.944425 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-02-23 03:12:33.945535 (MainThread): Parsing macros/schema_tests/unique.sql
2021-02-23 03:12:33.946845 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-02-23 03:12:33.949563 (MainThread): Parsing macros/catalog.sql
2021-02-23 03:12:33.952472 (MainThread): Parsing macros/relations.sql
2021-02-23 03:12:33.954319 (MainThread): Parsing macros/adapters.sql
2021-02-23 03:12:33.978565 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-02-23 03:12:34.000331 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0
2021-02-23 03:12:34.001149 (MainThread): Partial parsing not enabled
2021-02-23 03:12:34.042055 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2021-02-23 03:12:34.042227 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:12:34.069337 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2021-02-23 03:12:34.069664 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:12:34.076802 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2021-02-23 03:12:34.076977 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:12:34.083943 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2021-02-23 03:12:34.084125 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:12:34.093567 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2021-02-23 03:12:34.093713 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:12:34.129022 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2021-02-23 03:12:34.129167 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:12:34.137037 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2021-02-23 03:12:34.137190 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:12:34.144865 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:12:34.145005 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:12:34.590614 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 134 macros, 0 operations, 3 seed files, 0 sources
2021-02-23 03:12:34.593081 (MainThread): 
2021-02-23 03:12:34.593567 (MainThread): Acquiring new postgres connection "master".
2021-02-23 03:12:34.593682 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:12:34.595601 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dbttest1".
2021-02-23 03:12:34.595881 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-23 03:12:34.619668 (ThreadPoolExecutor-0_0): Using postgres connection "list_dbttest1".
2021-02-23 03:12:34.619928 (ThreadPoolExecutor-0_0): On list_dbttest1: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1"} */

    select distinct nspname from pg_namespace
  
2021-02-23 03:12:34.631524 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-02-23 03:12:34.680329 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dbttest1_public".
2021-02-23 03:12:34.680605 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_dbttest1).
2021-02-23 03:12:34.686653 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2021-02-23 03:12:34.686804 (ThreadPoolExecutor-1_0): On list_dbttest1_public: BEGIN
2021-02-23 03:12:34.688256 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:12:34.688402 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2021-02-23 03:12:34.688495 (ThreadPoolExecutor-1_0): On list_dbttest1_public: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1_public"} */
select
      'dbttest1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbttest1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-02-23 03:12:34.692725 (ThreadPoolExecutor-1_0): SQL status: SELECT 9 in 0.00 seconds
2021-02-23 03:12:34.700548 (ThreadPoolExecutor-1_0): On list_dbttest1_public: ROLLBACK
2021-02-23 03:12:34.766953 (MainThread): Using postgres connection "master".
2021-02-23 03:12:34.767172 (MainThread): On master: BEGIN
2021-02-23 03:12:34.776448 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-02-23 03:12:34.776678 (MainThread): Using postgres connection "master".
2021-02-23 03:12:34.776798 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-02-23 03:12:34.789058 (MainThread): SQL status: SELECT 3 in 0.01 seconds
2021-02-23 03:12:34.793627 (MainThread): On master: ROLLBACK
2021-02-23 03:12:34.795022 (MainThread): Using postgres connection "master".
2021-02-23 03:12:34.795161 (MainThread): On master: BEGIN
2021-02-23 03:12:34.796928 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:12:34.797089 (MainThread): On master: COMMIT
2021-02-23 03:12:34.797191 (MainThread): Using postgres connection "master".
2021-02-23 03:12:34.797275 (MainThread): On master: COMMIT
2021-02-23 03:12:34.798285 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-02-23 03:12:34.798651 (MainThread): 22:12:34 | Concurrency: 1 threads (target='dev')
2021-02-23 03:12:34.798816 (MainThread): 22:12:34 | 
2021-02-23 03:12:34.800427 (Thread-1): Began running node model.jaffle_shop.customer_orders
2021-02-23 03:12:34.801510 (Thread-1): 22:12:34 | 1 of 1 START table model public.customer_orders...................... [RUN]
2021-02-23 03:12:34.801810 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:12:34.801908 (Thread-1): Re-using an available connection from the pool (formerly list_dbttest1_public).
2021-02-23 03:12:34.802012 (Thread-1): Compiling model.jaffle_shop.customer_orders
2021-02-23 03:12:34.817345 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customer_orders"
2021-02-23 03:12:34.817900 (Thread-1): finished collecting timing info
2021-02-23 03:12:34.843572 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:12:34.843877 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
drop table if exists "dbttest1"."public"."customer_orders__dbt_tmp" cascade
2021-02-23 03:12:34.847121 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-02-23 03:12:34.849770 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:12:34.849917 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
drop table if exists "dbttest1"."public"."customer_orders__dbt_backup" cascade
2021-02-23 03:12:34.851270 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-02-23 03:12:34.862172 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customer_orders"
2021-02-23 03:12:34.862668 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:12:34.862779 (Thread-1): On model.jaffle_shop.customer_orders: BEGIN
2021-02-23 03:12:34.864105 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:12:34.864270 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:12:34.864369 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */


  create  table "dbttest1"."public"."customer_orders__dbt_tmp"
  as (
    with orders as (

    select * from "dbttest1"."public"."stg_orders"

),

final as (

    select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by 1

)
select
    *,
    pg_sleep(5)
from final
  );
2021-02-23 03:12:34.886283 (Thread-1): Postgres error: column "pg_sleep" has pseudo-type void

2021-02-23 03:12:34.886483 (Thread-1): On model.jaffle_shop.customer_orders: ROLLBACK
2021-02-23 03:12:34.887573 (Thread-1): finished collecting timing info
2021-02-23 03:12:34.888101 (Thread-1): Database Error in model customer_orders (models/marts/core/intermediate/customer_orders.sql)
  column "pg_sleep" has pseudo-type void
  compiled SQL at target/run/jaffle_shop/models/marts/core/intermediate/customer_orders.sql
Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.InvalidTableDefinition: column "pg_sleep" has pseudo-type void


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 119, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/Users/naveen/.pyenv/versions/3.7.4/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model customer_orders (models/marts/core/intermediate/customer_orders.sql)
  column "pg_sleep" has pseudo-type void
  compiled SQL at target/run/jaffle_shop/models/marts/core/intermediate/customer_orders.sql
2021-02-23 03:12:34.890164 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ee34ae4-b2c7-457d-a44f-5db93d15561f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f006f50>]}
2021-02-23 03:12:34.891367 (Thread-1): 22:12:34 | 1 of 1 ERROR creating table model public.customer_orders............. [ERROR in 0.09s]
2021-02-23 03:12:34.891573 (Thread-1): Finished running node model.jaffle_shop.customer_orders
2021-02-23 03:12:34.900889 (MainThread): Using postgres connection "master".
2021-02-23 03:12:34.901202 (MainThread): On master: BEGIN
2021-02-23 03:12:34.903180 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:12:34.904370 (MainThread): On master: COMMIT
2021-02-23 03:12:34.904588 (MainThread): Using postgres connection "master".
2021-02-23 03:12:34.904795 (MainThread): On master: COMMIT
2021-02-23 03:12:34.906536 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-02-23 03:12:34.907125 (MainThread): 22:12:34 | 
2021-02-23 03:12:34.907356 (MainThread): 22:12:34 | Finished running 1 table model in 0.31s.
2021-02-23 03:12:34.907540 (MainThread): Connection 'master' was left open.
2021-02-23 03:12:34.907666 (MainThread): On master: Close
2021-02-23 03:12:34.907809 (MainThread): Connection 'model.jaffle_shop.customer_orders' was left open.
2021-02-23 03:12:34.908030 (MainThread): On model.jaffle_shop.customer_orders: Close
2021-02-23 03:12:34.913299 (MainThread): 
2021-02-23 03:12:34.913634 (MainThread): Completed with 1 error and 0 warnings:
2021-02-23 03:12:34.913857 (MainThread): 
2021-02-23 03:12:34.914012 (MainThread): Database Error in model customer_orders (models/marts/core/intermediate/customer_orders.sql)
2021-02-23 03:12:34.914162 (MainThread):   column "pg_sleep" has pseudo-type void
2021-02-23 03:12:34.914305 (MainThread):   compiled SQL at target/run/jaffle_shop/models/marts/core/intermediate/customer_orders.sql
2021-02-23 03:12:34.914457 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-02-23 03:12:34.914746 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f09f1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef5d590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f026890>]}
2021-02-23 03:12:34.915049 (MainThread): Flushing usage events
2021-02-23 03:14:05.922465 (MainThread): Running with dbt=0.17.0
2021-02-23 03:14:06.001778 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['customer_orders'], partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-23 03:14:06.002493 (MainThread): Tracking: tracking
2021-02-23 03:14:06.022610 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107123350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10750abd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10750ab10>]}
2021-02-23 03:14:06.049548 (MainThread): Partial parsing not enabled
2021-02-23 03:14:06.051596 (MainThread): Parsing macros/core.sql
2021-02-23 03:14:06.057459 (MainThread): Parsing macros/materializations/helpers.sql
2021-02-23 03:14:06.066253 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-02-23 03:14:06.068281 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-02-23 03:14:06.098735 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-02-23 03:14:06.161116 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-02-23 03:14:06.212179 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-02-23 03:14:06.218766 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-02-23 03:14:06.239080 (MainThread): Parsing macros/materializations/common/merge.sql
2021-02-23 03:14:06.261211 (MainThread): Parsing macros/materializations/table/table.sql
2021-02-23 03:14:06.271598 (MainThread): Parsing macros/materializations/view/view.sql
2021-02-23 03:14:06.282736 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-02-23 03:14:06.290047 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-02-23 03:14:06.291607 (MainThread): Parsing macros/etc/query.sql
2021-02-23 03:14:06.293252 (MainThread): Parsing macros/etc/is_incremental.sql
2021-02-23 03:14:06.295251 (MainThread): Parsing macros/etc/datetime.sql
2021-02-23 03:14:06.307262 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-02-23 03:14:06.310797 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-02-23 03:14:06.312885 (MainThread): Parsing macros/adapters/common.sql
2021-02-23 03:14:06.370715 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-02-23 03:14:06.372326 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-02-23 03:14:06.373558 (MainThread): Parsing macros/schema_tests/unique.sql
2021-02-23 03:14:06.374906 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-02-23 03:14:06.377595 (MainThread): Parsing macros/catalog.sql
2021-02-23 03:14:06.380491 (MainThread): Parsing macros/relations.sql
2021-02-23 03:14:06.382116 (MainThread): Parsing macros/adapters.sql
2021-02-23 03:14:06.409664 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-02-23 03:14:06.434881 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0
2021-02-23 03:14:06.435445 (MainThread): Partial parsing not enabled
2021-02-23 03:14:06.473375 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2021-02-23 03:14:06.473565 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:14:06.501209 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2021-02-23 03:14:06.501363 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:14:06.508341 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2021-02-23 03:14:06.508484 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:14:06.515245 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2021-02-23 03:14:06.515379 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:14:06.524757 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2021-02-23 03:14:06.524892 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:14:06.556588 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2021-02-23 03:14:06.556741 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:14:06.564956 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2021-02-23 03:14:06.565098 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:14:06.572901 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:14:06.573045 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:14:07.027586 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 134 macros, 0 operations, 3 seed files, 0 sources
2021-02-23 03:14:07.030643 (MainThread): 
2021-02-23 03:14:07.031400 (MainThread): Acquiring new postgres connection "master".
2021-02-23 03:14:07.031594 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:14:07.035152 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dbttest1".
2021-02-23 03:14:07.035619 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-23 03:14:07.048138 (ThreadPoolExecutor-0_0): Using postgres connection "list_dbttest1".
2021-02-23 03:14:07.048339 (ThreadPoolExecutor-0_0): On list_dbttest1: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1"} */

    select distinct nspname from pg_namespace
  
2021-02-23 03:14:07.064010 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.02 seconds
2021-02-23 03:14:07.106056 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dbttest1_public".
2021-02-23 03:14:07.106276 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_dbttest1).
2021-02-23 03:14:07.112207 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2021-02-23 03:14:07.112344 (ThreadPoolExecutor-1_0): On list_dbttest1_public: BEGIN
2021-02-23 03:14:07.113886 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:14:07.114038 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2021-02-23 03:14:07.114128 (ThreadPoolExecutor-1_0): On list_dbttest1_public: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1_public"} */
select
      'dbttest1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbttest1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-02-23 03:14:07.119451 (ThreadPoolExecutor-1_0): SQL status: SELECT 9 in 0.01 seconds
2021-02-23 03:14:07.127409 (ThreadPoolExecutor-1_0): On list_dbttest1_public: ROLLBACK
2021-02-23 03:14:07.174788 (MainThread): Using postgres connection "master".
2021-02-23 03:14:07.175001 (MainThread): On master: BEGIN
2021-02-23 03:14:07.184853 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-02-23 03:14:07.185041 (MainThread): Using postgres connection "master".
2021-02-23 03:14:07.185141 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-02-23 03:14:07.191290 (MainThread): SQL status: SELECT 3 in 0.01 seconds
2021-02-23 03:14:07.195029 (MainThread): On master: ROLLBACK
2021-02-23 03:14:07.196248 (MainThread): Using postgres connection "master".
2021-02-23 03:14:07.196393 (MainThread): On master: BEGIN
2021-02-23 03:14:07.198259 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:14:07.198449 (MainThread): On master: COMMIT
2021-02-23 03:14:07.198563 (MainThread): Using postgres connection "master".
2021-02-23 03:14:07.198656 (MainThread): On master: COMMIT
2021-02-23 03:14:07.199932 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-02-23 03:14:07.200276 (MainThread): 22:14:07 | Concurrency: 1 threads (target='dev')
2021-02-23 03:14:07.200420 (MainThread): 22:14:07 | 
2021-02-23 03:14:07.201652 (Thread-1): Began running node model.jaffle_shop.customer_orders
2021-02-23 03:14:07.202718 (Thread-1): 22:14:07 | 1 of 1 START table model public.customer_orders...................... [RUN]
2021-02-23 03:14:07.203030 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:14:07.203127 (Thread-1): Re-using an available connection from the pool (formerly list_dbttest1_public).
2021-02-23 03:14:07.203229 (Thread-1): Compiling model.jaffle_shop.customer_orders
2021-02-23 03:14:07.230594 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customer_orders"
2021-02-23 03:14:07.231236 (Thread-1): finished collecting timing info
2021-02-23 03:14:07.257252 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:14:07.257423 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
drop table if exists "dbttest1"."public"."customer_orders__dbt_tmp" cascade
2021-02-23 03:14:07.259873 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-02-23 03:14:07.262201 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:14:07.262329 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
drop table if exists "dbttest1"."public"."customer_orders__dbt_backup" cascade
2021-02-23 03:14:07.263564 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-02-23 03:14:07.275192 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customer_orders"
2021-02-23 03:14:07.275673 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:14:07.275775 (Thread-1): On model.jaffle_shop.customer_orders: BEGIN
2021-02-23 03:14:07.276983 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:14:07.277189 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:14:07.277283 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */


  create  table "dbttest1"."public"."customer_orders__dbt_tmp"
  as (
    with orders as (

    select *, pg_sleep(5) from "dbttest1"."public"."stg_orders"

),

final as (

    select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by 1

)

select * from final
  );
2021-02-23 03:14:43.240499 (MainThread): Cancelling query 'model.jaffle_shop.customer_orders' (16720)
2021-02-23 03:14:43.240918 (MainThread): Using postgres connection "master".
2021-02-23 03:14:43.241103 (MainThread): On master: BEGIN
2021-02-23 03:14:43.243638 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:14:43.243851 (MainThread): Using postgres connection "master".
2021-02-23 03:14:43.243977 (MainThread): On master: select pg_terminate_backend(16720)
2021-02-23 03:14:43.250548 (MainThread): SQL status: SELECT 1 in 0.01 seconds
2021-02-23 03:14:43.250829 (MainThread): Cancel query 'model.jaffle_shop.customer_orders': (True,)
2021-02-23 03:14:43.251088 (MainThread): 22:14:43 | CANCEL query model.jaffle_shop.customer_orders....................... [CANCEL]
2021-02-23 03:14:43.271753 (Thread-1): Postgres error: terminating connection due to administrator command
server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

2021-02-23 03:14:43.272015 (Thread-1): On model.jaffle_shop.customer_orders: ROLLBACK
2021-02-23 03:14:43.272140 (Thread-1): Failed to rollback model.jaffle_shop.customer_orders
Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.AdminShutdown: terminating connection due to administrator command
server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/base/connections.py", line 221, in _rollback_handle
    connection.handle.rollback()
psycopg2.InterfaceError: connection already closed
2021-02-23 03:14:43.273877 (Thread-1): finished collecting timing info
2021-02-23 03:14:43.274784 (Thread-1): Database Error in model customer_orders (models/marts/core/intermediate/customer_orders.sql)
  terminating connection due to administrator command
  server closed the connection unexpectedly
  	This probably means the server terminated abnormally
  	before or while processing the request.
  compiled SQL at target/run/jaffle_shop/models/marts/core/intermediate/customer_orders.sql
Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.AdminShutdown: terminating connection due to administrator command
server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 119, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/Users/naveen/.pyenv/versions/3.7.4/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model customer_orders (models/marts/core/intermediate/customer_orders.sql)
  terminating connection due to administrator command
  server closed the connection unexpectedly
  	This probably means the server terminated abnormally
  	before or while processing the request.
  compiled SQL at target/run/jaffle_shop/models/marts/core/intermediate/customer_orders.sql
2021-02-23 03:14:43.278364 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6faba64b-d732-4844-9e74-87c24f514fa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10797f0d0>]}
2021-02-23 03:14:43.280102 (Thread-1): 22:14:43 | 1 of 1 ERROR creating table model public.customer_orders............. [ERROR in 36.08s]
2021-02-23 03:14:43.280370 (Thread-1): Finished running node model.jaffle_shop.customer_orders
2021-02-23 03:14:43.280802 (MainThread): 
2021-02-23 03:14:43.281058 (MainThread): Exited because of keyboard interrupt.
2021-02-23 03:14:43.281207 (MainThread): 
Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
2021-02-23 03:14:43.281390 (MainThread): Connection 'master' was left open.
2021-02-23 03:14:43.283004 (MainThread): On master: Close
2021-02-23 03:14:43.283232 (MainThread): Connection 'model.jaffle_shop.customer_orders' was left open.
2021-02-23 03:14:43.283373 (MainThread): On model.jaffle_shop.customer_orders: Close
2021-02-23 03:14:43.283505 (MainThread): Flushing usage events
2021-02-23 03:14:43.465675 (MainThread): ctrl-c
2021-02-23 03:16:22.654418 (MainThread): Running with dbt=0.17.0
2021-02-23 03:16:22.731002 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['customer_orders'], partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-23 03:16:22.732274 (MainThread): Tracking: tracking
2021-02-23 03:16:22.751276 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085b9ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085ce950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089cbb90>]}
2021-02-23 03:16:22.775075 (MainThread): Partial parsing not enabled
2021-02-23 03:16:22.777578 (MainThread): Parsing macros/core.sql
2021-02-23 03:16:22.782860 (MainThread): Parsing macros/materializations/helpers.sql
2021-02-23 03:16:22.793100 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-02-23 03:16:22.795361 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-02-23 03:16:22.816925 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-02-23 03:16:22.864789 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-02-23 03:16:22.891177 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-02-23 03:16:22.893516 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-02-23 03:16:22.901611 (MainThread): Parsing macros/materializations/common/merge.sql
2021-02-23 03:16:22.918284 (MainThread): Parsing macros/materializations/table/table.sql
2021-02-23 03:16:22.927835 (MainThread): Parsing macros/materializations/view/view.sql
2021-02-23 03:16:22.935588 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-02-23 03:16:22.941810 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-02-23 03:16:22.943015 (MainThread): Parsing macros/etc/query.sql
2021-02-23 03:16:22.944316 (MainThread): Parsing macros/etc/is_incremental.sql
2021-02-23 03:16:22.946413 (MainThread): Parsing macros/etc/datetime.sql
2021-02-23 03:16:22.958070 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-02-23 03:16:22.960568 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-02-23 03:16:22.962764 (MainThread): Parsing macros/adapters/common.sql
2021-02-23 03:16:23.028072 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-02-23 03:16:23.029599 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-02-23 03:16:23.030833 (MainThread): Parsing macros/schema_tests/unique.sql
2021-02-23 03:16:23.032416 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-02-23 03:16:23.035521 (MainThread): Parsing macros/catalog.sql
2021-02-23 03:16:23.038476 (MainThread): Parsing macros/relations.sql
2021-02-23 03:16:23.040124 (MainThread): Parsing macros/adapters.sql
2021-02-23 03:16:23.064403 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-02-23 03:16:23.085344 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0
2021-02-23 03:16:23.086176 (MainThread): Partial parsing not enabled
2021-02-23 03:16:23.125836 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2021-02-23 03:16:23.126003 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:16:23.153037 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2021-02-23 03:16:23.153197 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:16:23.160045 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2021-02-23 03:16:23.160183 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:16:23.167335 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2021-02-23 03:16:23.167666 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:16:23.178377 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2021-02-23 03:16:23.178525 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:16:23.217815 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2021-02-23 03:16:23.218099 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:16:23.227701 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2021-02-23 03:16:23.227843 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:16:23.236070 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:16:23.236210 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:16:23.833727 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 134 macros, 0 operations, 3 seed files, 0 sources
2021-02-23 03:16:23.836295 (MainThread): 
2021-02-23 03:16:23.837210 (MainThread): Acquiring new postgres connection "master".
2021-02-23 03:16:23.837554 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:16:23.842424 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dbttest1".
2021-02-23 03:16:23.842765 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-23 03:16:23.860225 (ThreadPoolExecutor-0_0): Using postgres connection "list_dbttest1".
2021-02-23 03:16:23.860379 (ThreadPoolExecutor-0_0): On list_dbttest1: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1"} */

    select distinct nspname from pg_namespace
  
2021-02-23 03:16:23.874041 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-02-23 03:16:23.918637 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dbttest1_public".
2021-02-23 03:16:23.918835 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_dbttest1).
2021-02-23 03:16:23.924630 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2021-02-23 03:16:23.924788 (ThreadPoolExecutor-1_0): On list_dbttest1_public: BEGIN
2021-02-23 03:16:23.926240 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:16:23.926379 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2021-02-23 03:16:23.926467 (ThreadPoolExecutor-1_0): On list_dbttest1_public: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1_public"} */
select
      'dbttest1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbttest1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-02-23 03:16:23.929549 (ThreadPoolExecutor-1_0): SQL status: SELECT 9 in 0.00 seconds
2021-02-23 03:16:23.936675 (ThreadPoolExecutor-1_0): On list_dbttest1_public: ROLLBACK
2021-02-23 03:16:23.979006 (MainThread): Using postgres connection "master".
2021-02-23 03:16:23.979149 (MainThread): On master: BEGIN
2021-02-23 03:16:23.987830 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-02-23 03:16:23.988001 (MainThread): Using postgres connection "master".
2021-02-23 03:16:23.988125 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-02-23 03:16:23.995773 (MainThread): SQL status: SELECT 3 in 0.01 seconds
2021-02-23 03:16:23.999910 (MainThread): On master: ROLLBACK
2021-02-23 03:16:24.001365 (MainThread): Using postgres connection "master".
2021-02-23 03:16:24.001623 (MainThread): On master: BEGIN
2021-02-23 03:16:24.005331 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:16:24.005518 (MainThread): On master: COMMIT
2021-02-23 03:16:24.005624 (MainThread): Using postgres connection "master".
2021-02-23 03:16:24.005710 (MainThread): On master: COMMIT
2021-02-23 03:16:24.006844 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-02-23 03:16:24.007198 (MainThread): 22:16:24 | Concurrency: 1 threads (target='dev')
2021-02-23 03:16:24.007343 (MainThread): 22:16:24 | 
2021-02-23 03:16:24.008537 (Thread-1): Began running node model.jaffle_shop.customer_orders
2021-02-23 03:16:24.009565 (Thread-1): 22:16:24 | 1 of 1 START table model public.customer_orders...................... [RUN]
2021-02-23 03:16:24.009856 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:16:24.009944 (Thread-1): Re-using an available connection from the pool (formerly list_dbttest1_public).
2021-02-23 03:16:24.010045 (Thread-1): Compiling model.jaffle_shop.customer_orders
2021-02-23 03:16:24.026557 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customer_orders"
2021-02-23 03:16:24.027121 (Thread-1): finished collecting timing info
2021-02-23 03:16:24.053764 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:16:24.053909 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
drop table if exists "dbttest1"."public"."customer_orders__dbt_tmp" cascade
2021-02-23 03:16:24.056301 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-02-23 03:16:24.058690 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:16:24.058858 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
drop table if exists "dbttest1"."public"."customer_orders__dbt_backup" cascade
2021-02-23 03:16:24.060088 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-02-23 03:16:24.076529 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customer_orders"
2021-02-23 03:16:24.077465 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:16:24.077658 (Thread-1): On model.jaffle_shop.customer_orders: BEGIN
2021-02-23 03:16:24.079450 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:16:24.079663 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:16:24.079762 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */


  create  table "dbttest1"."public"."customer_orders__dbt_tmp"
  as (
    with orders as (

    select * from "dbttest1"."public"."stg_orders"

),

final as (

    select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by 1

),

delay_ as (
    select
        null as customer_id,
        null as first_order,
        null as most_recent_order,
        null as number_of_orders,
        pg_sleep(5) as nothing
)

select * from final
  );
2021-02-23 03:16:24.085589 (Thread-1): SQL status: SELECT 62 in 0.01 seconds
2021-02-23 03:16:24.093794 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:16:24.093939 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
alter table "dbttest1"."public"."customer_orders__dbt_tmp" rename to "customer_orders"
2021-02-23 03:16:24.095868 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-02-23 03:16:24.104541 (Thread-1): On model.jaffle_shop.customer_orders: COMMIT
2021-02-23 03:16:24.104862 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:16:24.105247 (Thread-1): On model.jaffle_shop.customer_orders: COMMIT
2021-02-23 03:16:24.109453 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-02-23 03:16:24.116296 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:16:24.116465 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
drop table if exists "dbttest1"."public"."customer_orders__dbt_backup" cascade
2021-02-23 03:16:24.118438 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-02-23 03:16:24.121310 (Thread-1): finished collecting timing info
2021-02-23 03:16:24.122111 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea8ec9ef-454d-45f4-bd25-144f22e49699', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a0ced0>]}
2021-02-23 03:16:24.123252 (Thread-1): 22:16:24 | 1 of 1 OK created table model public.customer_orders................. [SELECT 62 in 0.11s]
2021-02-23 03:16:24.123530 (Thread-1): Finished running node model.jaffle_shop.customer_orders
2021-02-23 03:16:24.221289 (MainThread): Using postgres connection "master".
2021-02-23 03:16:24.221773 (MainThread): On master: BEGIN
2021-02-23 03:16:24.225539 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:16:24.225752 (MainThread): On master: COMMIT
2021-02-23 03:16:24.225913 (MainThread): Using postgres connection "master".
2021-02-23 03:16:24.226004 (MainThread): On master: COMMIT
2021-02-23 03:16:24.227088 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-02-23 03:16:24.227526 (MainThread): 22:16:24 | 
2021-02-23 03:16:24.227757 (MainThread): 22:16:24 | Finished running 1 table model in 0.39s.
2021-02-23 03:16:24.227959 (MainThread): Connection 'master' was left open.
2021-02-23 03:16:24.228145 (MainThread): On master: Close
2021-02-23 03:16:24.228440 (MainThread): Connection 'model.jaffle_shop.customer_orders' was left open.
2021-02-23 03:16:24.228592 (MainThread): On model.jaffle_shop.customer_orders: Close
2021-02-23 03:16:24.234344 (MainThread): 
2021-02-23 03:16:24.234652 (MainThread): Completed successfully
2021-02-23 03:16:24.234894 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-02-23 03:16:24.235135 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b93d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ebb190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ebbd10>]}
2021-02-23 03:16:24.235347 (MainThread): Flushing usage events
2021-02-23 03:16:57.601126 (MainThread): Running with dbt=0.17.0
2021-02-23 03:16:57.761486 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['customer_orders'], partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-23 03:16:57.765309 (MainThread): Tracking: tracking
2021-02-23 03:16:57.801561 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b502f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b512a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8f9b50>]}
2021-02-23 03:16:57.838886 (MainThread): Partial parsing not enabled
2021-02-23 03:16:57.846930 (MainThread): Parsing macros/core.sql
2021-02-23 03:16:57.862648 (MainThread): Parsing macros/materializations/helpers.sql
2021-02-23 03:16:57.893022 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-02-23 03:16:57.900543 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-02-23 03:16:57.937546 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-02-23 03:16:57.974818 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-02-23 03:16:58.004784 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-02-23 03:16:58.007349 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-02-23 03:16:58.015437 (MainThread): Parsing macros/materializations/common/merge.sql
2021-02-23 03:16:58.032607 (MainThread): Parsing macros/materializations/table/table.sql
2021-02-23 03:16:58.041950 (MainThread): Parsing macros/materializations/view/view.sql
2021-02-23 03:16:58.049929 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-02-23 03:16:58.055911 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-02-23 03:16:58.057391 (MainThread): Parsing macros/etc/query.sql
2021-02-23 03:16:58.058947 (MainThread): Parsing macros/etc/is_incremental.sql
2021-02-23 03:16:58.061262 (MainThread): Parsing macros/etc/datetime.sql
2021-02-23 03:16:58.072752 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-02-23 03:16:58.075377 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-02-23 03:16:58.077605 (MainThread): Parsing macros/adapters/common.sql
2021-02-23 03:16:58.138803 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-02-23 03:16:58.140589 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-02-23 03:16:58.142227 (MainThread): Parsing macros/schema_tests/unique.sql
2021-02-23 03:16:58.145324 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-02-23 03:16:58.149344 (MainThread): Parsing macros/catalog.sql
2021-02-23 03:16:58.152936 (MainThread): Parsing macros/relations.sql
2021-02-23 03:16:58.154740 (MainThread): Parsing macros/adapters.sql
2021-02-23 03:16:58.187034 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-02-23 03:16:58.219535 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0
2021-02-23 03:16:58.220509 (MainThread): Partial parsing not enabled
2021-02-23 03:16:58.264595 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2021-02-23 03:16:58.264769 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:16:58.295094 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2021-02-23 03:16:58.295255 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:16:58.303096 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2021-02-23 03:16:58.303238 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:16:58.310705 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2021-02-23 03:16:58.310848 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:16:58.321045 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2021-02-23 03:16:58.321204 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:16:58.354954 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2021-02-23 03:16:58.355117 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:16:58.364109 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2021-02-23 03:16:58.364330 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:16:58.381351 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:16:58.381581 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:16:58.873318 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 134 macros, 0 operations, 3 seed files, 0 sources
2021-02-23 03:16:58.876905 (MainThread): 
2021-02-23 03:16:58.877519 (MainThread): Acquiring new postgres connection "master".
2021-02-23 03:16:58.877674 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:16:58.880589 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dbttest1".
2021-02-23 03:16:58.881057 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-23 03:16:58.899726 (ThreadPoolExecutor-0_0): Using postgres connection "list_dbttest1".
2021-02-23 03:16:58.899987 (ThreadPoolExecutor-0_0): On list_dbttest1: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1"} */

    select distinct nspname from pg_namespace
  
2021-02-23 03:16:58.911444 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-02-23 03:16:58.955765 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dbttest1_public".
2021-02-23 03:16:58.955985 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_dbttest1).
2021-02-23 03:16:58.961745 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2021-02-23 03:16:58.961875 (ThreadPoolExecutor-1_0): On list_dbttest1_public: BEGIN
2021-02-23 03:16:58.963383 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:16:58.963526 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2021-02-23 03:16:58.963616 (ThreadPoolExecutor-1_0): On list_dbttest1_public: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1_public"} */
select
      'dbttest1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbttest1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-02-23 03:16:58.967130 (ThreadPoolExecutor-1_0): SQL status: SELECT 10 in 0.00 seconds
2021-02-23 03:16:58.975088 (ThreadPoolExecutor-1_0): On list_dbttest1_public: ROLLBACK
2021-02-23 03:16:59.018648 (MainThread): Using postgres connection "master".
2021-02-23 03:16:59.018798 (MainThread): On master: BEGIN
2021-02-23 03:16:59.026861 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-02-23 03:16:59.027034 (MainThread): Using postgres connection "master".
2021-02-23 03:16:59.027131 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-02-23 03:16:59.033586 (MainThread): SQL status: SELECT 3 in 0.01 seconds
2021-02-23 03:16:59.037407 (MainThread): On master: ROLLBACK
2021-02-23 03:16:59.038849 (MainThread): Using postgres connection "master".
2021-02-23 03:16:59.038980 (MainThread): On master: BEGIN
2021-02-23 03:16:59.041089 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:16:59.041287 (MainThread): On master: COMMIT
2021-02-23 03:16:59.041403 (MainThread): Using postgres connection "master".
2021-02-23 03:16:59.041492 (MainThread): On master: COMMIT
2021-02-23 03:16:59.042463 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-02-23 03:16:59.042755 (MainThread): 22:16:59 | Concurrency: 1 threads (target='dev')
2021-02-23 03:16:59.042892 (MainThread): 22:16:59 | 
2021-02-23 03:16:59.044856 (Thread-1): Began running node model.jaffle_shop.customer_orders
2021-02-23 03:16:59.045895 (Thread-1): 22:16:59 | 1 of 1 START table model public.customer_orders...................... [RUN]
2021-02-23 03:16:59.046176 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:16:59.046266 (Thread-1): Re-using an available connection from the pool (formerly list_dbttest1_public).
2021-02-23 03:16:59.046363 (Thread-1): Compiling model.jaffle_shop.customer_orders
2021-02-23 03:16:59.062877 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customer_orders"
2021-02-23 03:16:59.063760 (Thread-1): finished collecting timing info
2021-02-23 03:16:59.088750 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:16:59.088924 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
drop table if exists "dbttest1"."public"."customer_orders__dbt_tmp" cascade
2021-02-23 03:16:59.091793 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-02-23 03:16:59.094095 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:16:59.094217 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
drop table if exists "dbttest1"."public"."customer_orders__dbt_backup" cascade
2021-02-23 03:16:59.095408 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-02-23 03:16:59.106292 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customer_orders"
2021-02-23 03:16:59.106801 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:16:59.106905 (Thread-1): On model.jaffle_shop.customer_orders: BEGIN
2021-02-23 03:16:59.108523 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:16:59.108679 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:16:59.108772 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */


  create  table "dbttest1"."public"."customer_orders__dbt_tmp"
  as (
    with orders as (

    select * from "dbttest1"."public"."stg_orders"

),

final as (

    select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by 1

),

delay_ as (
    select
        null as customer_id,
        null as first_order,
        null as most_recent_order,
        null as number_of_orders,
        pg_sleep(5) as nothing
)

select * from final
union
select
    customer_id,
    first_order,
    most_recent_order,
    number_of_orders
from
    delay_
  );
2021-02-23 03:16:59.111534 (Thread-1): Postgres error: UNION types integer and text cannot be matched
LINE 38:     customer_id,
             ^

2021-02-23 03:16:59.111703 (Thread-1): On model.jaffle_shop.customer_orders: ROLLBACK
2021-02-23 03:16:59.112806 (Thread-1): finished collecting timing info
2021-02-23 03:16:59.113277 (Thread-1): Database Error in model customer_orders (models/marts/core/intermediate/customer_orders.sql)
  UNION types integer and text cannot be matched
  LINE 38:     customer_id,
               ^
  compiled SQL at target/run/jaffle_shop/models/marts/core/intermediate/customer_orders.sql
Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.DatatypeMismatch: UNION types integer and text cannot be matched
LINE 38:     customer_id,
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 119, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/Users/naveen/.pyenv/versions/3.7.4/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model customer_orders (models/marts/core/intermediate/customer_orders.sql)
  UNION types integer and text cannot be matched
  LINE 38:     customer_id,
               ^
  compiled SQL at target/run/jaffle_shop/models/marts/core/intermediate/customer_orders.sql
2021-02-23 03:16:59.120171 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ccc8701-7ced-4e87-b819-0510032c34d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd9a690>]}
2021-02-23 03:16:59.121303 (Thread-1): 22:16:59 | 1 of 1 ERROR creating table model public.customer_orders............. [ERROR in 0.07s]
2021-02-23 03:16:59.121449 (Thread-1): Finished running node model.jaffle_shop.customer_orders
2021-02-23 03:16:59.149626 (MainThread): Using postgres connection "master".
2021-02-23 03:16:59.149804 (MainThread): On master: BEGIN
2021-02-23 03:16:59.151571 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:16:59.151773 (MainThread): On master: COMMIT
2021-02-23 03:16:59.151922 (MainThread): Using postgres connection "master".
2021-02-23 03:16:59.152060 (MainThread): On master: COMMIT
2021-02-23 03:16:59.153433 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-02-23 03:16:59.153933 (MainThread): 22:16:59 | 
2021-02-23 03:16:59.154111 (MainThread): 22:16:59 | Finished running 1 table model in 0.28s.
2021-02-23 03:16:59.154242 (MainThread): Connection 'master' was left open.
2021-02-23 03:16:59.154363 (MainThread): On master: Close
2021-02-23 03:16:59.154497 (MainThread): Connection 'model.jaffle_shop.customer_orders' was left open.
2021-02-23 03:16:59.154613 (MainThread): On model.jaffle_shop.customer_orders: Close
2021-02-23 03:16:59.158499 (MainThread): 
2021-02-23 03:16:59.158697 (MainThread): Completed with 1 error and 0 warnings:
2021-02-23 03:16:59.158875 (MainThread): 
2021-02-23 03:16:59.159045 (MainThread): Database Error in model customer_orders (models/marts/core/intermediate/customer_orders.sql)
2021-02-23 03:16:59.159250 (MainThread):   UNION types integer and text cannot be matched
2021-02-23 03:16:59.159380 (MainThread):   LINE 38:     customer_id,
2021-02-23 03:16:59.159550 (MainThread):                ^
2021-02-23 03:16:59.159707 (MainThread):   compiled SQL at target/run/jaffle_shop/models/marts/core/intermediate/customer_orders.sql
2021-02-23 03:16:59.159894 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-02-23 03:16:59.160249 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdaeed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be00b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdf9bd0>]}
2021-02-23 03:16:59.160623 (MainThread): Flushing usage events
2021-02-23 03:17:19.090679 (MainThread): Running with dbt=0.17.0
2021-02-23 03:17:19.227210 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['customer_orders'], partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-23 03:17:19.229220 (MainThread): Tracking: tracking
2021-02-23 03:17:19.268229 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a882d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036cd090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ab3bd0>]}
2021-02-23 03:17:19.312123 (MainThread): Partial parsing not enabled
2021-02-23 03:17:19.315216 (MainThread): Parsing macros/core.sql
2021-02-23 03:17:19.322321 (MainThread): Parsing macros/materializations/helpers.sql
2021-02-23 03:17:19.333920 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-02-23 03:17:19.336954 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-02-23 03:17:19.362381 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-02-23 03:17:19.412119 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-02-23 03:17:19.439590 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-02-23 03:17:19.442089 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-02-23 03:17:19.449586 (MainThread): Parsing macros/materializations/common/merge.sql
2021-02-23 03:17:19.467526 (MainThread): Parsing macros/materializations/table/table.sql
2021-02-23 03:17:19.476057 (MainThread): Parsing macros/materializations/view/view.sql
2021-02-23 03:17:19.486034 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-02-23 03:17:19.494064 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-02-23 03:17:19.495560 (MainThread): Parsing macros/etc/query.sql
2021-02-23 03:17:19.496881 (MainThread): Parsing macros/etc/is_incremental.sql
2021-02-23 03:17:19.498916 (MainThread): Parsing macros/etc/datetime.sql
2021-02-23 03:17:19.510048 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-02-23 03:17:19.512374 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-02-23 03:17:19.514425 (MainThread): Parsing macros/adapters/common.sql
2021-02-23 03:17:19.573737 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-02-23 03:17:19.575146 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-02-23 03:17:19.576236 (MainThread): Parsing macros/schema_tests/unique.sql
2021-02-23 03:17:19.577582 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-02-23 03:17:19.580299 (MainThread): Parsing macros/catalog.sql
2021-02-23 03:17:19.583002 (MainThread): Parsing macros/relations.sql
2021-02-23 03:17:19.584780 (MainThread): Parsing macros/adapters.sql
2021-02-23 03:17:19.610651 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-02-23 03:17:19.633039 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0
2021-02-23 03:17:19.633606 (MainThread): Partial parsing not enabled
2021-02-23 03:17:19.671501 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2021-02-23 03:17:19.671663 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:17:19.700342 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2021-02-23 03:17:19.700501 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:17:19.707803 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2021-02-23 03:17:19.707953 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:17:19.714687 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2021-02-23 03:17:19.714819 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:17:19.724256 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2021-02-23 03:17:19.724399 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:17:19.760078 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2021-02-23 03:17:19.760259 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:17:19.769351 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2021-02-23 03:17:19.769497 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:17:19.777839 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:17:19.777978 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:17:20.275474 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 134 macros, 0 operations, 3 seed files, 0 sources
2021-02-23 03:17:20.278339 (MainThread): 
2021-02-23 03:17:20.278768 (MainThread): Acquiring new postgres connection "master".
2021-02-23 03:17:20.278881 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:17:20.280829 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dbttest1".
2021-02-23 03:17:20.280959 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-23 03:17:20.292815 (ThreadPoolExecutor-0_0): Using postgres connection "list_dbttest1".
2021-02-23 03:17:20.295884 (ThreadPoolExecutor-0_0): On list_dbttest1: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1"} */

    select distinct nspname from pg_namespace
  
2021-02-23 03:17:20.307127 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-02-23 03:17:20.349135 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dbttest1_public".
2021-02-23 03:17:20.349340 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_dbttest1).
2021-02-23 03:17:20.355472 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2021-02-23 03:17:20.355626 (ThreadPoolExecutor-1_0): On list_dbttest1_public: BEGIN
2021-02-23 03:17:20.356982 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:17:20.357134 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2021-02-23 03:17:20.357227 (ThreadPoolExecutor-1_0): On list_dbttest1_public: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1_public"} */
select
      'dbttest1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbttest1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-02-23 03:17:20.360168 (ThreadPoolExecutor-1_0): SQL status: SELECT 10 in 0.00 seconds
2021-02-23 03:17:20.368060 (ThreadPoolExecutor-1_0): On list_dbttest1_public: ROLLBACK
2021-02-23 03:17:20.424506 (MainThread): Using postgres connection "master".
2021-02-23 03:17:20.424669 (MainThread): On master: BEGIN
2021-02-23 03:17:20.436243 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-02-23 03:17:20.436438 (MainThread): Using postgres connection "master".
2021-02-23 03:17:20.436596 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-02-23 03:17:20.443910 (MainThread): SQL status: SELECT 3 in 0.01 seconds
2021-02-23 03:17:20.447708 (MainThread): On master: ROLLBACK
2021-02-23 03:17:20.449113 (MainThread): Using postgres connection "master".
2021-02-23 03:17:20.449250 (MainThread): On master: BEGIN
2021-02-23 03:17:20.451427 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:17:20.451599 (MainThread): On master: COMMIT
2021-02-23 03:17:20.451709 (MainThread): Using postgres connection "master".
2021-02-23 03:17:20.451853 (MainThread): On master: COMMIT
2021-02-23 03:17:20.453223 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-02-23 03:17:20.453569 (MainThread): 22:17:20 | Concurrency: 1 threads (target='dev')
2021-02-23 03:17:20.453714 (MainThread): 22:17:20 | 
2021-02-23 03:17:20.454901 (Thread-1): Began running node model.jaffle_shop.customer_orders
2021-02-23 03:17:20.455973 (Thread-1): 22:17:20 | 1 of 1 START table model public.customer_orders...................... [RUN]
2021-02-23 03:17:20.456320 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:17:20.456419 (Thread-1): Re-using an available connection from the pool (formerly list_dbttest1_public).
2021-02-23 03:17:20.456520 (Thread-1): Compiling model.jaffle_shop.customer_orders
2021-02-23 03:17:20.472966 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customer_orders"
2021-02-23 03:17:20.473467 (Thread-1): finished collecting timing info
2021-02-23 03:17:20.500107 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:17:20.500320 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
drop table if exists "dbttest1"."public"."customer_orders__dbt_tmp" cascade
2021-02-23 03:17:20.503291 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-02-23 03:17:20.506486 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:17:20.506641 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
drop table if exists "dbttest1"."public"."customer_orders__dbt_backup" cascade
2021-02-23 03:17:20.508223 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-02-23 03:17:20.520050 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customer_orders"
2021-02-23 03:17:20.520565 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:17:20.520674 (Thread-1): On model.jaffle_shop.customer_orders: BEGIN
2021-02-23 03:17:20.522308 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:17:20.522490 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:17:20.522593 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */


  create  table "dbttest1"."public"."customer_orders__dbt_tmp"
  as (
    with orders as (

    select * from "dbttest1"."public"."stg_orders"

),

final as (

    select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by 1

),

delay_ as (
    select
        null as customer_id,
        null as first_order,
        null as most_recent_order,
        null as number_of_orders,
        pg_sleep(5) as nothing
)

select
    customer_id,
    first_order,
    most_recent_order,
    number_of_orders
from final
union
select
    customer_id,
    first_order,
    most_recent_order,
    number_of_orders
from
    delay_
  );
2021-02-23 03:17:20.524490 (Thread-1): Postgres error: UNION types integer and text cannot be matched
LINE 43:     customer_id,
             ^

2021-02-23 03:17:20.524639 (Thread-1): On model.jaffle_shop.customer_orders: ROLLBACK
2021-02-23 03:17:20.525756 (Thread-1): finished collecting timing info
2021-02-23 03:17:20.526215 (Thread-1): Database Error in model customer_orders (models/marts/core/intermediate/customer_orders.sql)
  UNION types integer and text cannot be matched
  LINE 43:     customer_id,
               ^
  compiled SQL at target/run/jaffle_shop/models/marts/core/intermediate/customer_orders.sql
Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.DatatypeMismatch: UNION types integer and text cannot be matched
LINE 43:     customer_id,
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 119, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/Users/naveen/.pyenv/versions/3.7.4/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model customer_orders (models/marts/core/intermediate/customer_orders.sql)
  UNION types integer and text cannot be matched
  LINE 43:     customer_id,
               ^
  compiled SQL at target/run/jaffle_shop/models/marts/core/intermediate/customer_orders.sql
2021-02-23 03:17:20.528237 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f44aefe-f5c6-475a-9237-d8eb59f3aa72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f5ae10>]}
2021-02-23 03:17:20.529360 (Thread-1): 22:17:20 | 1 of 1 ERROR creating table model public.customer_orders............. [ERROR in 0.07s]
2021-02-23 03:17:20.529505 (Thread-1): Finished running node model.jaffle_shop.customer_orders
2021-02-23 03:17:20.556821 (MainThread): Using postgres connection "master".
2021-02-23 03:17:20.556994 (MainThread): On master: BEGIN
2021-02-23 03:17:20.558263 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:17:20.558425 (MainThread): On master: COMMIT
2021-02-23 03:17:20.558525 (MainThread): Using postgres connection "master".
2021-02-23 03:17:20.558613 (MainThread): On master: COMMIT
2021-02-23 03:17:20.559902 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-02-23 03:17:20.560385 (MainThread): 22:17:20 | 
2021-02-23 03:17:20.560583 (MainThread): 22:17:20 | Finished running 1 table model in 0.28s.
2021-02-23 03:17:20.560772 (MainThread): Connection 'master' was left open.
2021-02-23 03:17:20.560947 (MainThread): On master: Close
2021-02-23 03:17:20.561122 (MainThread): Connection 'model.jaffle_shop.customer_orders' was left open.
2021-02-23 03:17:20.561278 (MainThread): On model.jaffle_shop.customer_orders: Close
2021-02-23 03:17:20.566380 (MainThread): 
2021-02-23 03:17:20.566807 (MainThread): Completed with 1 error and 0 warnings:
2021-02-23 03:17:20.567054 (MainThread): 
2021-02-23 03:17:20.567320 (MainThread): Database Error in model customer_orders (models/marts/core/intermediate/customer_orders.sql)
2021-02-23 03:17:20.567544 (MainThread):   UNION types integer and text cannot be matched
2021-02-23 03:17:20.567737 (MainThread):   LINE 43:     customer_id,
2021-02-23 03:17:20.567906 (MainThread):                ^
2021-02-23 03:17:20.568053 (MainThread):   compiled SQL at target/run/jaffle_shop/models/marts/core/intermediate/customer_orders.sql
2021-02-23 03:17:20.568213 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-02-23 03:17:20.568527 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fb8090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103eb61d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d493d0>]}
2021-02-23 03:17:20.568886 (MainThread): Flushing usage events
2021-02-23 03:17:43.325739 (MainThread): Running with dbt=0.17.0
2021-02-23 03:17:43.414490 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['customer_orders'], partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-23 03:17:43.415868 (MainThread): Tracking: tracking
2021-02-23 03:17:43.435997 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091c0d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095b0d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095b0cd0>]}
2021-02-23 03:17:43.460079 (MainThread): Partial parsing not enabled
2021-02-23 03:17:43.462897 (MainThread): Parsing macros/core.sql
2021-02-23 03:17:43.469087 (MainThread): Parsing macros/materializations/helpers.sql
2021-02-23 03:17:43.479128 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-02-23 03:17:43.481537 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-02-23 03:17:43.503352 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-02-23 03:17:43.538143 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-02-23 03:17:43.565620 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-02-23 03:17:43.567910 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-02-23 03:17:43.575787 (MainThread): Parsing macros/materializations/common/merge.sql
2021-02-23 03:17:43.592970 (MainThread): Parsing macros/materializations/table/table.sql
2021-02-23 03:17:43.601086 (MainThread): Parsing macros/materializations/view/view.sql
2021-02-23 03:17:43.608880 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-02-23 03:17:43.614589 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-02-23 03:17:43.615730 (MainThread): Parsing macros/etc/query.sql
2021-02-23 03:17:43.616978 (MainThread): Parsing macros/etc/is_incremental.sql
2021-02-23 03:17:43.618942 (MainThread): Parsing macros/etc/datetime.sql
2021-02-23 03:17:43.629881 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-02-23 03:17:43.632242 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-02-23 03:17:43.634221 (MainThread): Parsing macros/adapters/common.sql
2021-02-23 03:17:43.693301 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-02-23 03:17:43.694762 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-02-23 03:17:43.695865 (MainThread): Parsing macros/schema_tests/unique.sql
2021-02-23 03:17:43.697198 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-02-23 03:17:43.700379 (MainThread): Parsing macros/catalog.sql
2021-02-23 03:17:43.703104 (MainThread): Parsing macros/relations.sql
2021-02-23 03:17:43.705021 (MainThread): Parsing macros/adapters.sql
2021-02-23 03:17:43.730839 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-02-23 03:17:43.752929 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0
2021-02-23 03:17:43.753634 (MainThread): Partial parsing not enabled
2021-02-23 03:17:43.797949 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2021-02-23 03:17:43.798197 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:17:43.825823 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2021-02-23 03:17:43.825980 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:17:43.832837 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2021-02-23 03:17:43.832975 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:17:43.840063 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2021-02-23 03:17:43.840304 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:17:43.852417 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2021-02-23 03:17:43.852562 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:17:43.884785 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2021-02-23 03:17:43.884933 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:17:43.893159 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2021-02-23 03:17:43.893322 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:17:43.904527 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:17:43.904697 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:17:44.345315 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 134 macros, 0 operations, 3 seed files, 0 sources
2021-02-23 03:17:44.348793 (MainThread): 
2021-02-23 03:17:44.349316 (MainThread): Acquiring new postgres connection "master".
2021-02-23 03:17:44.349487 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:17:44.353326 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dbttest1".
2021-02-23 03:17:44.353638 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-23 03:17:44.375017 (ThreadPoolExecutor-0_0): Using postgres connection "list_dbttest1".
2021-02-23 03:17:44.375306 (ThreadPoolExecutor-0_0): On list_dbttest1: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1"} */

    select distinct nspname from pg_namespace
  
2021-02-23 03:17:44.387498 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-02-23 03:17:44.451895 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dbttest1_public".
2021-02-23 03:17:44.452139 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_dbttest1).
2021-02-23 03:17:44.460268 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2021-02-23 03:17:44.460409 (ThreadPoolExecutor-1_0): On list_dbttest1_public: BEGIN
2021-02-23 03:17:44.462412 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:17:44.462574 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2021-02-23 03:17:44.462693 (ThreadPoolExecutor-1_0): On list_dbttest1_public: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1_public"} */
select
      'dbttest1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbttest1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-02-23 03:17:44.467313 (ThreadPoolExecutor-1_0): SQL status: SELECT 10 in 0.00 seconds
2021-02-23 03:17:44.476575 (ThreadPoolExecutor-1_0): On list_dbttest1_public: ROLLBACK
2021-02-23 03:17:44.522655 (MainThread): Using postgres connection "master".
2021-02-23 03:17:44.522858 (MainThread): On master: BEGIN
2021-02-23 03:17:44.533531 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-02-23 03:17:44.568264 (MainThread): Using postgres connection "master".
2021-02-23 03:17:44.568678 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-02-23 03:17:44.580950 (MainThread): SQL status: SELECT 3 in 0.01 seconds
2021-02-23 03:17:44.617666 (MainThread): On master: ROLLBACK
2021-02-23 03:17:44.621358 (MainThread): Using postgres connection "master".
2021-02-23 03:17:44.621647 (MainThread): On master: BEGIN
2021-02-23 03:17:44.626241 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:17:44.626479 (MainThread): On master: COMMIT
2021-02-23 03:17:44.626603 (MainThread): Using postgres connection "master".
2021-02-23 03:17:44.626842 (MainThread): On master: COMMIT
2021-02-23 03:17:44.630506 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-02-23 03:17:44.630948 (MainThread): 22:17:44 | Concurrency: 1 threads (target='dev')
2021-02-23 03:17:44.631105 (MainThread): 22:17:44 | 
2021-02-23 03:17:44.632695 (Thread-1): Began running node model.jaffle_shop.customer_orders
2021-02-23 03:17:44.634093 (Thread-1): 22:17:44 | 1 of 1 START table model public.customer_orders...................... [RUN]
2021-02-23 03:17:44.634555 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:17:44.634721 (Thread-1): Re-using an available connection from the pool (formerly list_dbttest1_public).
2021-02-23 03:17:44.634888 (Thread-1): Compiling model.jaffle_shop.customer_orders
2021-02-23 03:17:44.661994 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customer_orders"
2021-02-23 03:17:44.662526 (Thread-1): finished collecting timing info
2021-02-23 03:17:44.689604 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:17:44.689819 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
drop table if exists "dbttest1"."public"."customer_orders__dbt_tmp" cascade
2021-02-23 03:17:44.692724 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-02-23 03:17:44.695268 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:17:44.695403 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
drop table if exists "dbttest1"."public"."customer_orders__dbt_backup" cascade
2021-02-23 03:17:44.696498 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-02-23 03:17:44.707621 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customer_orders"
2021-02-23 03:17:44.708218 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:17:44.708342 (Thread-1): On model.jaffle_shop.customer_orders: BEGIN
2021-02-23 03:17:44.709775 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:17:44.709935 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:17:44.710027 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */


  create  table "dbttest1"."public"."customer_orders__dbt_tmp"
  as (
    with orders as (

    select * from "dbttest1"."public"."stg_orders"

),

final as (

    select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by 1

),

delay_ as (
    select
        '' as customer_id,
        null as first_order,
        null as most_recent_order,
        null as number_of_orders,
        pg_sleep(5) as nothing
)

select
    customer_id,
    first_order,
    most_recent_order,
    number_of_orders
from final
union
select
    customer_id,
    first_order,
    most_recent_order,
    number_of_orders
from
    delay_
  );
2021-02-23 03:17:44.713086 (Thread-1): Postgres error: UNION types integer and text cannot be matched
LINE 43:     customer_id,
             ^

2021-02-23 03:17:44.713275 (Thread-1): On model.jaffle_shop.customer_orders: ROLLBACK
2021-02-23 03:17:44.714297 (Thread-1): finished collecting timing info
2021-02-23 03:17:44.714762 (Thread-1): Database Error in model customer_orders (models/marts/core/intermediate/customer_orders.sql)
  UNION types integer and text cannot be matched
  LINE 43:     customer_id,
               ^
  compiled SQL at target/run/jaffle_shop/models/marts/core/intermediate/customer_orders.sql
Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.DatatypeMismatch: UNION types integer and text cannot be matched
LINE 43:     customer_id,
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 119, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/Users/naveen/.pyenv/versions/3.7.4/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model customer_orders (models/marts/core/intermediate/customer_orders.sql)
  UNION types integer and text cannot be matched
  LINE 43:     customer_id,
               ^
  compiled SQL at target/run/jaffle_shop/models/marts/core/intermediate/customer_orders.sql
2021-02-23 03:17:44.716666 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b69f787-e253-454a-ab5c-9eb61238d0c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099acdd0>]}
2021-02-23 03:17:44.717763 (Thread-1): 22:17:44 | 1 of 1 ERROR creating table model public.customer_orders............. [ERROR in 0.08s]
2021-02-23 03:17:44.717904 (Thread-1): Finished running node model.jaffle_shop.customer_orders
2021-02-23 03:17:44.735701 (MainThread): Using postgres connection "master".
2021-02-23 03:17:44.735875 (MainThread): On master: BEGIN
2021-02-23 03:17:44.738387 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:17:44.738564 (MainThread): On master: COMMIT
2021-02-23 03:17:44.738662 (MainThread): Using postgres connection "master".
2021-02-23 03:17:44.738747 (MainThread): On master: COMMIT
2021-02-23 03:17:44.740119 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-02-23 03:17:44.740531 (MainThread): 22:17:44 | 
2021-02-23 03:17:44.740687 (MainThread): 22:17:44 | Finished running 1 table model in 0.39s.
2021-02-23 03:17:44.740801 (MainThread): Connection 'master' was left open.
2021-02-23 03:17:44.740887 (MainThread): On master: Close
2021-02-23 03:17:44.741000 (MainThread): Connection 'model.jaffle_shop.customer_orders' was left open.
2021-02-23 03:17:44.741095 (MainThread): On model.jaffle_shop.customer_orders: Close
2021-02-23 03:17:44.745564 (MainThread): 
2021-02-23 03:17:44.745776 (MainThread): Completed with 1 error and 0 warnings:
2021-02-23 03:17:44.746002 (MainThread): 
2021-02-23 03:17:44.746205 (MainThread): Database Error in model customer_orders (models/marts/core/intermediate/customer_orders.sql)
2021-02-23 03:17:44.746430 (MainThread):   UNION types integer and text cannot be matched
2021-02-23 03:17:44.746589 (MainThread):   LINE 43:     customer_id,
2021-02-23 03:17:44.746774 (MainThread):                ^
2021-02-23 03:17:44.746933 (MainThread):   compiled SQL at target/run/jaffle_shop/models/marts/core/intermediate/customer_orders.sql
2021-02-23 03:17:44.747048 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-02-23 03:17:44.747240 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a3bf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109aacd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a88850>]}
2021-02-23 03:17:44.747450 (MainThread): Flushing usage events
2021-02-23 03:18:32.947436 (MainThread): Running with dbt=0.17.0
2021-02-23 03:18:33.035234 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['customer_orders'], partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-23 03:18:33.036328 (MainThread): Tracking: tracking
2021-02-23 03:18:33.055558 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111733d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11156bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11156ba10>]}
2021-02-23 03:18:33.078341 (MainThread): Partial parsing not enabled
2021-02-23 03:18:33.081250 (MainThread): Parsing macros/core.sql
2021-02-23 03:18:33.087540 (MainThread): Parsing macros/materializations/helpers.sql
2021-02-23 03:18:33.096929 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-02-23 03:18:33.099317 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-02-23 03:18:33.119527 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-02-23 03:18:33.154657 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-02-23 03:18:33.179770 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-02-23 03:18:33.182305 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-02-23 03:18:33.190186 (MainThread): Parsing macros/materializations/common/merge.sql
2021-02-23 03:18:33.206853 (MainThread): Parsing macros/materializations/table/table.sql
2021-02-23 03:18:33.215597 (MainThread): Parsing macros/materializations/view/view.sql
2021-02-23 03:18:33.223647 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-02-23 03:18:33.230133 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-02-23 03:18:33.231865 (MainThread): Parsing macros/etc/query.sql
2021-02-23 03:18:33.233605 (MainThread): Parsing macros/etc/is_incremental.sql
2021-02-23 03:18:33.236038 (MainThread): Parsing macros/etc/datetime.sql
2021-02-23 03:18:33.247651 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-02-23 03:18:33.250280 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-02-23 03:18:33.252504 (MainThread): Parsing macros/adapters/common.sql
2021-02-23 03:18:33.311948 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-02-23 03:18:33.313845 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-02-23 03:18:33.315454 (MainThread): Parsing macros/schema_tests/unique.sql
2021-02-23 03:18:33.317013 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-02-23 03:18:33.319996 (MainThread): Parsing macros/catalog.sql
2021-02-23 03:18:33.323103 (MainThread): Parsing macros/relations.sql
2021-02-23 03:18:33.324965 (MainThread): Parsing macros/adapters.sql
2021-02-23 03:18:33.350282 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-02-23 03:18:33.371890 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0
2021-02-23 03:18:33.372522 (MainThread): Partial parsing not enabled
2021-02-23 03:18:33.416558 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2021-02-23 03:18:33.416738 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:18:33.451404 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2021-02-23 03:18:33.451549 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:18:33.458817 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2021-02-23 03:18:33.458977 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:18:33.467031 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2021-02-23 03:18:33.467182 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:18:33.477853 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2021-02-23 03:18:33.478092 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:18:33.514918 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2021-02-23 03:18:33.515098 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:18:33.524002 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2021-02-23 03:18:33.524152 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:18:33.534645 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:18:33.534790 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:18:33.981423 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 134 macros, 0 operations, 3 seed files, 0 sources
2021-02-23 03:18:33.983912 (MainThread): 
2021-02-23 03:18:33.984344 (MainThread): Acquiring new postgres connection "master".
2021-02-23 03:18:33.984447 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:18:33.986653 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dbttest1".
2021-02-23 03:18:33.986799 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-23 03:18:33.998314 (ThreadPoolExecutor-0_0): Using postgres connection "list_dbttest1".
2021-02-23 03:18:33.998499 (ThreadPoolExecutor-0_0): On list_dbttest1: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1"} */

    select distinct nspname from pg_namespace
  
2021-02-23 03:18:34.012929 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-02-23 03:18:34.057240 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dbttest1_public".
2021-02-23 03:18:34.057451 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_dbttest1).
2021-02-23 03:18:34.063591 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2021-02-23 03:18:34.063743 (ThreadPoolExecutor-1_0): On list_dbttest1_public: BEGIN
2021-02-23 03:18:34.065083 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:18:34.065272 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2021-02-23 03:18:34.065392 (ThreadPoolExecutor-1_0): On list_dbttest1_public: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1_public"} */
select
      'dbttest1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbttest1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-02-23 03:18:34.068619 (ThreadPoolExecutor-1_0): SQL status: SELECT 10 in 0.00 seconds
2021-02-23 03:18:34.076480 (ThreadPoolExecutor-1_0): On list_dbttest1_public: ROLLBACK
2021-02-23 03:18:34.119907 (MainThread): Using postgres connection "master".
2021-02-23 03:18:34.120054 (MainThread): On master: BEGIN
2021-02-23 03:18:34.127659 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-02-23 03:18:34.127846 (MainThread): Using postgres connection "master".
2021-02-23 03:18:34.127970 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-02-23 03:18:34.135197 (MainThread): SQL status: SELECT 3 in 0.01 seconds
2021-02-23 03:18:34.139263 (MainThread): On master: ROLLBACK
2021-02-23 03:18:34.140875 (MainThread): Using postgres connection "master".
2021-02-23 03:18:34.141027 (MainThread): On master: BEGIN
2021-02-23 03:18:34.143418 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:18:34.143599 (MainThread): On master: COMMIT
2021-02-23 03:18:34.143706 (MainThread): Using postgres connection "master".
2021-02-23 03:18:34.143800 (MainThread): On master: COMMIT
2021-02-23 03:18:34.145224 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-02-23 03:18:34.145635 (MainThread): 22:18:34 | Concurrency: 1 threads (target='dev')
2021-02-23 03:18:34.145831 (MainThread): 22:18:34 | 
2021-02-23 03:18:34.147783 (Thread-1): Began running node model.jaffle_shop.customer_orders
2021-02-23 03:18:34.148909 (Thread-1): 22:18:34 | 1 of 1 START table model public.customer_orders...................... [RUN]
2021-02-23 03:18:34.149282 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:18:34.149406 (Thread-1): Re-using an available connection from the pool (formerly list_dbttest1_public).
2021-02-23 03:18:34.149514 (Thread-1): Compiling model.jaffle_shop.customer_orders
2021-02-23 03:18:34.166154 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customer_orders"
2021-02-23 03:18:34.166658 (Thread-1): finished collecting timing info
2021-02-23 03:18:34.193462 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:18:34.193632 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
drop table if exists "dbttest1"."public"."customer_orders__dbt_tmp" cascade
2021-02-23 03:18:34.196591 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-02-23 03:18:34.198893 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:18:34.199018 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
drop table if exists "dbttest1"."public"."customer_orders__dbt_backup" cascade
2021-02-23 03:18:34.200124 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-02-23 03:18:34.211293 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customer_orders"
2021-02-23 03:18:34.211897 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:18:34.212023 (Thread-1): On model.jaffle_shop.customer_orders: BEGIN
2021-02-23 03:18:34.213589 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:18:34.213756 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:18:34.213852 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */


  create  table "dbttest1"."public"."customer_orders__dbt_tmp"
  as (
    with orders as (

    select * from "dbttest1"."public"."stg_orders"

),

final as (

    select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by 1

),

delay_ as (
    select
        null as customer_id,
        null as first_order,
        null as most_recent_order,
        null as number_of_orders,
        pg_sleep(5) as nothing
)

select
    customer_id,
    first_order,
    most_recent_order,
    number_of_orders
from final
union
select
    cast(customer_id as text) as customer_id,
    first_order,
    most_recent_order,
    number_of_orders
from
    delay_
  );
2021-02-23 03:18:34.217453 (Thread-1): Postgres error: UNION types integer and text cannot be matched
LINE 43:     cast(customer_id as text) as customer_id,
                  ^

2021-02-23 03:18:34.217610 (Thread-1): On model.jaffle_shop.customer_orders: ROLLBACK
2021-02-23 03:18:34.218722 (Thread-1): finished collecting timing info
2021-02-23 03:18:34.219193 (Thread-1): Database Error in model customer_orders (models/marts/core/intermediate/customer_orders.sql)
  UNION types integer and text cannot be matched
  LINE 43:     cast(customer_id as text) as customer_id,
                    ^
  compiled SQL at target/run/jaffle_shop/models/marts/core/intermediate/customer_orders.sql
Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.DatatypeMismatch: UNION types integer and text cannot be matched
LINE 43:     cast(customer_id as text) as customer_id,
                  ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 119, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/Users/naveen/.pyenv/versions/3.7.4/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model customer_orders (models/marts/core/intermediate/customer_orders.sql)
  UNION types integer and text cannot be matched
  LINE 43:     cast(customer_id as text) as customer_id,
                    ^
  compiled SQL at target/run/jaffle_shop/models/marts/core/intermediate/customer_orders.sql
2021-02-23 03:18:34.225896 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5710aa20-1c90-43c5-aa45-e6c035b92842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a3b150>]}
2021-02-23 03:18:34.227026 (Thread-1): 22:18:34 | 1 of 1 ERROR creating table model public.customer_orders............. [ERROR in 0.08s]
2021-02-23 03:18:34.227172 (Thread-1): Finished running node model.jaffle_shop.customer_orders
2021-02-23 03:18:34.252874 (MainThread): Using postgres connection "master".
2021-02-23 03:18:34.253218 (MainThread): On master: BEGIN
2021-02-23 03:18:34.258530 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-02-23 03:18:34.259036 (MainThread): On master: COMMIT
2021-02-23 03:18:34.259182 (MainThread): Using postgres connection "master".
2021-02-23 03:18:34.259291 (MainThread): On master: COMMIT
2021-02-23 03:18:34.260714 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-02-23 03:18:34.261127 (MainThread): 22:18:34 | 
2021-02-23 03:18:34.261290 (MainThread): 22:18:34 | Finished running 1 table model in 0.28s.
2021-02-23 03:18:34.261402 (MainThread): Connection 'master' was left open.
2021-02-23 03:18:34.261491 (MainThread): On master: Close
2021-02-23 03:18:34.261615 (MainThread): Connection 'model.jaffle_shop.customer_orders' was left open.
2021-02-23 03:18:34.261801 (MainThread): On model.jaffle_shop.customer_orders: Close
2021-02-23 03:18:34.266215 (MainThread): 
2021-02-23 03:18:34.266414 (MainThread): Completed with 1 error and 0 warnings:
2021-02-23 03:18:34.266567 (MainThread): 
2021-02-23 03:18:34.266749 (MainThread): Database Error in model customer_orders (models/marts/core/intermediate/customer_orders.sql)
2021-02-23 03:18:34.266925 (MainThread):   UNION types integer and text cannot be matched
2021-02-23 03:18:34.267042 (MainThread):   LINE 43:     cast(customer_id as text) as customer_id,
2021-02-23 03:18:34.267210 (MainThread):                     ^
2021-02-23 03:18:34.267367 (MainThread):   compiled SQL at target/run/jaffle_shop/models/marts/core/intermediate/customer_orders.sql
2021-02-23 03:18:34.267504 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-02-23 03:18:34.267754 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119f36d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111abc490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a5e410>]}
2021-02-23 03:18:34.267996 (MainThread): Flushing usage events
2021-02-23 03:18:56.786368 (MainThread): Running with dbt=0.17.0
2021-02-23 03:18:56.863436 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['customer_orders'], partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-23 03:18:56.864493 (MainThread): Tracking: tracking
2021-02-23 03:18:56.881434 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060b3cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064a3c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064a3bd0>]}
2021-02-23 03:18:56.904533 (MainThread): Partial parsing not enabled
2021-02-23 03:18:56.906578 (MainThread): Parsing macros/core.sql
2021-02-23 03:18:56.912739 (MainThread): Parsing macros/materializations/helpers.sql
2021-02-23 03:18:56.922012 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-02-23 03:18:56.924159 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-02-23 03:18:56.950450 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-02-23 03:18:56.988179 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-02-23 03:18:57.013741 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-02-23 03:18:57.015967 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-02-23 03:18:57.026928 (MainThread): Parsing macros/materializations/common/merge.sql
2021-02-23 03:18:57.045784 (MainThread): Parsing macros/materializations/table/table.sql
2021-02-23 03:18:57.054067 (MainThread): Parsing macros/materializations/view/view.sql
2021-02-23 03:18:57.061799 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-02-23 03:18:57.067824 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-02-23 03:18:57.068979 (MainThread): Parsing macros/etc/query.sql
2021-02-23 03:18:57.070269 (MainThread): Parsing macros/etc/is_incremental.sql
2021-02-23 03:18:57.072207 (MainThread): Parsing macros/etc/datetime.sql
2021-02-23 03:18:57.083337 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-02-23 03:18:57.085815 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-02-23 03:18:57.087806 (MainThread): Parsing macros/adapters/common.sql
2021-02-23 03:18:57.147536 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-02-23 03:18:57.149180 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-02-23 03:18:57.150467 (MainThread): Parsing macros/schema_tests/unique.sql
2021-02-23 03:18:57.151944 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-02-23 03:18:57.154765 (MainThread): Parsing macros/catalog.sql
2021-02-23 03:18:57.158061 (MainThread): Parsing macros/relations.sql
2021-02-23 03:18:57.160739 (MainThread): Parsing macros/adapters.sql
2021-02-23 03:18:57.185620 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-02-23 03:18:57.206800 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0
2021-02-23 03:18:57.207391 (MainThread): Partial parsing not enabled
2021-02-23 03:18:57.248337 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2021-02-23 03:18:57.248524 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:18:57.277344 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2021-02-23 03:18:57.277586 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:18:57.284562 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2021-02-23 03:18:57.284696 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:18:57.291601 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2021-02-23 03:18:57.291750 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:18:57.301599 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2021-02-23 03:18:57.301750 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:18:57.333530 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2021-02-23 03:18:57.333673 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:18:57.341299 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2021-02-23 03:18:57.341490 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:18:57.349088 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:18:57.349223 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:18:57.795333 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 134 macros, 0 operations, 3 seed files, 0 sources
2021-02-23 03:18:57.797417 (MainThread): 
2021-02-23 03:18:57.797794 (MainThread): Acquiring new postgres connection "master".
2021-02-23 03:18:57.797899 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:18:57.800095 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dbttest1".
2021-02-23 03:18:57.800331 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-23 03:18:57.814175 (ThreadPoolExecutor-0_0): Using postgres connection "list_dbttest1".
2021-02-23 03:18:57.814335 (ThreadPoolExecutor-0_0): On list_dbttest1: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1"} */

    select distinct nspname from pg_namespace
  
2021-02-23 03:18:57.823584 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-02-23 03:18:57.872864 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dbttest1_public".
2021-02-23 03:18:57.873192 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_dbttest1).
2021-02-23 03:18:57.879369 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2021-02-23 03:18:57.879516 (ThreadPoolExecutor-1_0): On list_dbttest1_public: BEGIN
2021-02-23 03:18:57.881193 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:18:57.881392 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2021-02-23 03:18:57.881492 (ThreadPoolExecutor-1_0): On list_dbttest1_public: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1_public"} */
select
      'dbttest1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbttest1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-02-23 03:18:57.884565 (ThreadPoolExecutor-1_0): SQL status: SELECT 10 in 0.00 seconds
2021-02-23 03:18:57.892441 (ThreadPoolExecutor-1_0): On list_dbttest1_public: ROLLBACK
2021-02-23 03:18:57.934998 (MainThread): Using postgres connection "master".
2021-02-23 03:18:57.935149 (MainThread): On master: BEGIN
2021-02-23 03:18:57.944220 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-02-23 03:18:57.944393 (MainThread): Using postgres connection "master".
2021-02-23 03:18:57.944489 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-02-23 03:18:57.960648 (MainThread): SQL status: SELECT 3 in 0.02 seconds
2021-02-23 03:18:57.964601 (MainThread): On master: ROLLBACK
2021-02-23 03:18:57.966080 (MainThread): Using postgres connection "master".
2021-02-23 03:18:57.966217 (MainThread): On master: BEGIN
2021-02-23 03:18:57.968486 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:18:57.968714 (MainThread): On master: COMMIT
2021-02-23 03:18:57.968823 (MainThread): Using postgres connection "master".
2021-02-23 03:18:57.968908 (MainThread): On master: COMMIT
2021-02-23 03:18:57.969994 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-02-23 03:18:57.970280 (MainThread): 22:18:57 | Concurrency: 1 threads (target='dev')
2021-02-23 03:18:57.970414 (MainThread): 22:18:57 | 
2021-02-23 03:18:57.971571 (Thread-1): Began running node model.jaffle_shop.customer_orders
2021-02-23 03:18:57.972627 (Thread-1): 22:18:57 | 1 of 1 START table model public.customer_orders...................... [RUN]
2021-02-23 03:18:57.972921 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:18:57.973015 (Thread-1): Re-using an available connection from the pool (formerly list_dbttest1_public).
2021-02-23 03:18:57.973115 (Thread-1): Compiling model.jaffle_shop.customer_orders
2021-02-23 03:18:57.989619 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customer_orders"
2021-02-23 03:18:57.990111 (Thread-1): finished collecting timing info
2021-02-23 03:18:58.013824 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:18:58.013980 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
drop table if exists "dbttest1"."public"."customer_orders__dbt_tmp" cascade
2021-02-23 03:18:58.017599 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-02-23 03:18:58.021019 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:18:58.021161 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
drop table if exists "dbttest1"."public"."customer_orders__dbt_backup" cascade
2021-02-23 03:18:58.023002 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-02-23 03:18:58.036874 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customer_orders"
2021-02-23 03:18:58.037384 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:18:58.037485 (Thread-1): On model.jaffle_shop.customer_orders: BEGIN
2021-02-23 03:18:58.038998 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:18:58.039148 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:18:58.039240 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */


  create  table "dbttest1"."public"."customer_orders__dbt_tmp"
  as (
    with orders as (

    select * from "dbttest1"."public"."stg_orders"

),

final as (

    select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by 1

),

delay_ as (
    select
        null as customer_id,
        null as first_order,
        null as most_recent_order,
        null as number_of_orders,
        pg_sleep(5) as nothing
)

select
    customer_id,
    first_order,
    most_recent_order,
    number_of_orders
from final
union
select
    cast(customer_id as int) as customer_id,
    first_order,
    most_recent_order,
    number_of_orders
from
    delay_
  );
2021-02-23 03:18:58.042167 (Thread-1): Postgres error: UNION types date and text cannot be matched
LINE 44:     first_order,
             ^

2021-02-23 03:18:58.042342 (Thread-1): On model.jaffle_shop.customer_orders: ROLLBACK
2021-02-23 03:18:58.043831 (Thread-1): finished collecting timing info
2021-02-23 03:18:58.044345 (Thread-1): Database Error in model customer_orders (models/marts/core/intermediate/customer_orders.sql)
  UNION types date and text cannot be matched
  LINE 44:     first_order,
               ^
  compiled SQL at target/run/jaffle_shop/models/marts/core/intermediate/customer_orders.sql
Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.DatatypeMismatch: UNION types date and text cannot be matched
LINE 44:     first_order,
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 119, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/Users/naveen/.pyenv/versions/3.7.4/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model customer_orders (models/marts/core/intermediate/customer_orders.sql)
  UNION types date and text cannot be matched
  LINE 44:     first_order,
               ^
  compiled SQL at target/run/jaffle_shop/models/marts/core/intermediate/customer_orders.sql
2021-02-23 03:18:58.046439 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3be752f3-d8af-4e74-a0ab-068253d071ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106970090>]}
2021-02-23 03:18:58.047592 (Thread-1): 22:18:58 | 1 of 1 ERROR creating table model public.customer_orders............. [ERROR in 0.07s]
2021-02-23 03:18:58.047746 (Thread-1): Finished running node model.jaffle_shop.customer_orders
2021-02-23 03:18:58.075712 (MainThread): Using postgres connection "master".
2021-02-23 03:18:58.075910 (MainThread): On master: BEGIN
2021-02-23 03:18:58.078044 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:18:58.078314 (MainThread): On master: COMMIT
2021-02-23 03:18:58.078464 (MainThread): Using postgres connection "master".
2021-02-23 03:18:58.078590 (MainThread): On master: COMMIT
2021-02-23 03:18:58.080126 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-02-23 03:18:58.080534 (MainThread): 22:18:58 | 
2021-02-23 03:18:58.080718 (MainThread): 22:18:58 | Finished running 1 table model in 0.28s.
2021-02-23 03:18:58.080869 (MainThread): Connection 'master' was left open.
2021-02-23 03:18:58.080988 (MainThread): On master: Close
2021-02-23 03:18:58.081131 (MainThread): Connection 'model.jaffle_shop.customer_orders' was left open.
2021-02-23 03:18:58.081253 (MainThread): On model.jaffle_shop.customer_orders: Close
2021-02-23 03:18:58.088572 (MainThread): 
2021-02-23 03:18:58.089045 (MainThread): Completed with 1 error and 0 warnings:
2021-02-23 03:18:58.089264 (MainThread): 
2021-02-23 03:18:58.089527 (MainThread): Database Error in model customer_orders (models/marts/core/intermediate/customer_orders.sql)
2021-02-23 03:18:58.089744 (MainThread):   UNION types date and text cannot be matched
2021-02-23 03:18:58.090086 (MainThread):   LINE 44:     first_order,
2021-02-23 03:18:58.090473 (MainThread):                ^
2021-02-23 03:18:58.090912 (MainThread):   compiled SQL at target/run/jaffle_shop/models/marts/core/intermediate/customer_orders.sql
2021-02-23 03:18:58.091368 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-02-23 03:18:58.092005 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a7810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106931350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069a2290>]}
2021-02-23 03:18:58.092621 (MainThread): Flushing usage events
2021-02-23 03:19:41.954979 (MainThread): Running with dbt=0.17.0
2021-02-23 03:19:42.072278 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['customer_orders'], partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-23 03:19:42.082160 (MainThread): Tracking: tracking
2021-02-23 03:19:42.118875 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7ce950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7bbed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abbfb50>]}
2021-02-23 03:19:42.142607 (MainThread): Partial parsing not enabled
2021-02-23 03:19:42.144841 (MainThread): Parsing macros/core.sql
2021-02-23 03:19:42.150808 (MainThread): Parsing macros/materializations/helpers.sql
2021-02-23 03:19:42.160102 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-02-23 03:19:42.162561 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-02-23 03:19:42.183106 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-02-23 03:19:42.216853 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-02-23 03:19:42.241605 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-02-23 03:19:42.244098 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-02-23 03:19:42.252695 (MainThread): Parsing macros/materializations/common/merge.sql
2021-02-23 03:19:42.271000 (MainThread): Parsing macros/materializations/table/table.sql
2021-02-23 03:19:42.279816 (MainThread): Parsing macros/materializations/view/view.sql
2021-02-23 03:19:42.288352 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-02-23 03:19:42.294541 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-02-23 03:19:42.295949 (MainThread): Parsing macros/etc/query.sql
2021-02-23 03:19:42.297539 (MainThread): Parsing macros/etc/is_incremental.sql
2021-02-23 03:19:42.301198 (MainThread): Parsing macros/etc/datetime.sql
2021-02-23 03:19:42.312481 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-02-23 03:19:42.315782 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-02-23 03:19:42.318897 (MainThread): Parsing macros/adapters/common.sql
2021-02-23 03:19:42.409083 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-02-23 03:19:42.411110 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-02-23 03:19:42.412522 (MainThread): Parsing macros/schema_tests/unique.sql
2021-02-23 03:19:42.414176 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-02-23 03:19:42.417495 (MainThread): Parsing macros/catalog.sql
2021-02-23 03:19:42.420887 (MainThread): Parsing macros/relations.sql
2021-02-23 03:19:42.422839 (MainThread): Parsing macros/adapters.sql
2021-02-23 03:19:42.447698 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-02-23 03:19:42.471653 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0
2021-02-23 03:19:42.472236 (MainThread): Partial parsing not enabled
2021-02-23 03:19:42.531846 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2021-02-23 03:19:42.532019 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:19:42.561145 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2021-02-23 03:19:42.561289 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:19:42.568959 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2021-02-23 03:19:42.569161 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:19:42.576161 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2021-02-23 03:19:42.576299 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:19:42.586021 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2021-02-23 03:19:42.586165 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:19:42.620511 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2021-02-23 03:19:42.620655 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:19:42.628563 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2021-02-23 03:19:42.628704 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:19:42.636693 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:19:42.636834 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:19:43.086625 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 134 macros, 0 operations, 3 seed files, 0 sources
2021-02-23 03:19:43.089174 (MainThread): 
2021-02-23 03:19:43.089646 (MainThread): Acquiring new postgres connection "master".
2021-02-23 03:19:43.089833 (MainThread): Opening a new connection, currently in state init
2021-02-23 03:19:43.092416 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dbttest1".
2021-02-23 03:19:43.092761 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-23 03:19:43.107891 (ThreadPoolExecutor-0_0): Using postgres connection "list_dbttest1".
2021-02-23 03:19:43.108058 (ThreadPoolExecutor-0_0): On list_dbttest1: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1"} */

    select distinct nspname from pg_namespace
  
2021-02-23 03:19:43.119922 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-02-23 03:19:43.161949 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dbttest1_public".
2021-02-23 03:19:43.162160 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_dbttest1).
2021-02-23 03:19:43.168311 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2021-02-23 03:19:43.168465 (ThreadPoolExecutor-1_0): On list_dbttest1_public: BEGIN
2021-02-23 03:19:43.169825 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:19:43.169988 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2021-02-23 03:19:43.170089 (ThreadPoolExecutor-1_0): On list_dbttest1_public: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1_public"} */
select
      'dbttest1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbttest1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-02-23 03:19:43.173033 (ThreadPoolExecutor-1_0): SQL status: SELECT 10 in 0.00 seconds
2021-02-23 03:19:43.181022 (ThreadPoolExecutor-1_0): On list_dbttest1_public: ROLLBACK
2021-02-23 03:19:43.223274 (MainThread): Using postgres connection "master".
2021-02-23 03:19:43.223417 (MainThread): On master: BEGIN
2021-02-23 03:19:43.231566 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-02-23 03:19:43.231739 (MainThread): Using postgres connection "master".
2021-02-23 03:19:43.231838 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-02-23 03:19:43.237885 (MainThread): SQL status: SELECT 3 in 0.01 seconds
2021-02-23 03:19:43.241649 (MainThread): On master: ROLLBACK
2021-02-23 03:19:43.243249 (MainThread): Using postgres connection "master".
2021-02-23 03:19:43.243375 (MainThread): On master: BEGIN
2021-02-23 03:19:43.244937 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:19:43.245082 (MainThread): On master: COMMIT
2021-02-23 03:19:43.245181 (MainThread): Using postgres connection "master".
2021-02-23 03:19:43.245261 (MainThread): On master: COMMIT
2021-02-23 03:19:43.246160 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-02-23 03:19:43.246464 (MainThread): 22:19:43 | Concurrency: 1 threads (target='dev')
2021-02-23 03:19:43.246620 (MainThread): 22:19:43 | 
2021-02-23 03:19:43.248130 (Thread-1): Began running node model.jaffle_shop.customer_orders
2021-02-23 03:19:43.249154 (Thread-1): 22:19:43 | 1 of 1 START table model public.customer_orders...................... [RUN]
2021-02-23 03:19:43.249429 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:19:43.249515 (Thread-1): Re-using an available connection from the pool (formerly list_dbttest1_public).
2021-02-23 03:19:43.249608 (Thread-1): Compiling model.jaffle_shop.customer_orders
2021-02-23 03:19:43.266701 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customer_orders"
2021-02-23 03:19:43.267996 (Thread-1): finished collecting timing info
2021-02-23 03:19:43.291914 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:19:43.292151 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
drop table if exists "dbttest1"."public"."customer_orders__dbt_tmp" cascade
2021-02-23 03:19:43.296134 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-02-23 03:19:43.298849 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:19:43.298967 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
drop table if exists "dbttest1"."public"."customer_orders__dbt_backup" cascade
2021-02-23 03:19:43.300336 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-02-23 03:19:43.311470 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customer_orders"
2021-02-23 03:19:43.311964 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:19:43.312073 (Thread-1): On model.jaffle_shop.customer_orders: BEGIN
2021-02-23 03:19:43.313565 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:19:43.313736 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:19:43.313828 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */


  create  table "dbttest1"."public"."customer_orders__dbt_tmp"
  as (
    with orders as (

    select * from "dbttest1"."public"."stg_orders"

),

final as (

    select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by 1

),

delay_ as (
    select
        null as customer_id,
        null as first_order,
        null as most_recent_order,
        null as number_of_orders,
        pg_sleep(5) as nothing
)

select
    customer_id,
    first_order,
    most_recent_order,
    number_of_orders
from final
union
select
    cast(customer_id as int) as customer_id,
    cast(first_order as date) as first_order,
    cast(most_recent_order as date) as most_recent_order,
    cast(number_of_orders as int) as number_of_orders
from
    delay_
  );
2021-02-23 03:19:48.321991 (Thread-1): SQL status: SELECT 63 in 5.01 seconds
2021-02-23 03:19:48.337497 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:19:48.337704 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
alter table "dbttest1"."public"."customer_orders" rename to "customer_orders__dbt_backup"
2021-02-23 03:19:48.340872 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-02-23 03:19:48.344446 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:19:48.344622 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
alter table "dbttest1"."public"."customer_orders__dbt_tmp" rename to "customer_orders"
2021-02-23 03:19:48.346566 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-02-23 03:19:48.355268 (Thread-1): On model.jaffle_shop.customer_orders: COMMIT
2021-02-23 03:19:48.355459 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:19:48.355556 (Thread-1): On model.jaffle_shop.customer_orders: COMMIT
2021-02-23 03:19:48.358948 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-02-23 03:19:48.362824 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-02-23 03:19:48.362980 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
drop table if exists "dbttest1"."public"."customer_orders__dbt_backup" cascade
2021-02-23 03:19:48.381881 (Thread-1): SQL status: DROP TABLE in 0.02 seconds
2021-02-23 03:19:48.384392 (Thread-1): finished collecting timing info
2021-02-23 03:19:48.385026 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b91e39b-8a92-4762-9d70-2c98f5b93b5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae47050>]}
2021-02-23 03:19:48.386087 (Thread-1): 22:19:48 | 1 of 1 OK created table model public.customer_orders................. [SELECT 63 in 5.14s]
2021-02-23 03:19:48.386226 (Thread-1): Finished running node model.jaffle_shop.customer_orders
2021-02-23 03:19:48.391421 (MainThread): Using postgres connection "master".
2021-02-23 03:19:48.391590 (MainThread): On master: BEGIN
2021-02-23 03:19:48.392972 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-02-23 03:19:48.393160 (MainThread): On master: COMMIT
2021-02-23 03:19:48.393257 (MainThread): Using postgres connection "master".
2021-02-23 03:19:48.393342 (MainThread): On master: COMMIT
2021-02-23 03:19:48.394480 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-02-23 03:19:48.394831 (MainThread): 22:19:48 | 
2021-02-23 03:19:48.394972 (MainThread): 22:19:48 | Finished running 1 table model in 5.31s.
2021-02-23 03:19:48.395080 (MainThread): Connection 'master' was left open.
2021-02-23 03:19:48.395164 (MainThread): On master: Close
2021-02-23 03:19:48.395278 (MainThread): Connection 'model.jaffle_shop.customer_orders' was left open.
2021-02-23 03:19:48.395387 (MainThread): On model.jaffle_shop.customer_orders: Close
2021-02-23 03:19:48.400951 (MainThread): 
2021-02-23 03:19:48.401316 (MainThread): Completed successfully
2021-02-23 03:19:48.401625 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-02-23 03:19:48.402058 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b07f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b07f0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0b4810>]}
2021-02-23 03:19:48.402344 (MainThread): Flushing usage events
2021-03-05 02:59:20.129198 (MainThread): Running with dbt=0.17.0
2021-03-05 02:59:20.371100 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['test'], partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-05 02:59:20.372474 (MainThread): Tracking: tracking
2021-03-05 02:59:20.406182 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f85e8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc62b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc62ad0>]}
2021-03-05 02:59:20.442871 (MainThread): Partial parsing not enabled
2021-03-05 02:59:20.446326 (MainThread): Parsing macros/core.sql
2021-03-05 02:59:20.458454 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-05 02:59:20.474908 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-05 02:59:20.478267 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-05 02:59:20.502331 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-05 02:59:20.546856 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-05 02:59:20.580834 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-05 02:59:20.583374 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-05 02:59:20.592860 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-05 02:59:20.610768 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-05 02:59:20.619046 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-05 02:59:20.627424 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-05 02:59:20.633918 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-05 02:59:20.635418 (MainThread): Parsing macros/etc/query.sql
2021-03-05 02:59:20.636985 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-05 02:59:20.639410 (MainThread): Parsing macros/etc/datetime.sql
2021-03-05 02:59:20.651555 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-05 02:59:20.654274 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-05 02:59:20.656681 (MainThread): Parsing macros/adapters/common.sql
2021-03-05 02:59:20.717502 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-05 02:59:20.719060 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-05 02:59:20.720303 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-05 02:59:20.721752 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-05 02:59:20.725220 (MainThread): Parsing macros/catalog.sql
2021-03-05 02:59:20.728245 (MainThread): Parsing macros/relations.sql
2021-03-05 02:59:20.730081 (MainThread): Parsing macros/adapters.sql
2021-03-05 02:59:20.755118 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-03-05 02:59:20.777662 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0
2021-03-05 02:59:20.778429 (MainThread): Partial parsing not enabled
2021-03-05 02:59:20.826557 (MainThread): Acquiring new postgres connection "model.jaffle_shop.test".
2021-03-05 02:59:20.826725 (MainThread): Opening a new connection, currently in state init
2021-03-05 02:59:20.855940 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2021-03-05 02:59:20.856122 (MainThread): Opening a new connection, currently in state init
2021-03-05 02:59:20.864783 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2021-03-05 02:59:20.864931 (MainThread): Opening a new connection, currently in state init
2021-03-05 02:59:20.874108 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2021-03-05 02:59:20.874309 (MainThread): Opening a new connection, currently in state init
2021-03-05 02:59:20.883051 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2021-03-05 02:59:20.883315 (MainThread): Opening a new connection, currently in state init
2021-03-05 02:59:20.917366 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2021-03-05 02:59:20.917531 (MainThread): Opening a new connection, currently in state init
2021-03-05 02:59:20.927105 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2021-03-05 02:59:20.927245 (MainThread): Opening a new connection, currently in state init
2021-03-05 02:59:20.935611 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2021-03-05 02:59:20.935808 (MainThread): Opening a new connection, currently in state init
2021-03-05 02:59:20.944250 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2021-03-05 02:59:20.944400 (MainThread): Opening a new connection, currently in state init
2021-03-05 02:59:21.418861 (MainThread): Found 9 models, 20 tests, 0 snapshots, 0 analyses, 134 macros, 0 operations, 3 seed files, 0 sources
2021-03-05 02:59:21.421131 (MainThread): 
2021-03-05 02:59:21.421531 (MainThread): Acquiring new postgres connection "master".
2021-03-05 02:59:21.421648 (MainThread): Opening a new connection, currently in state init
2021-03-05 02:59:21.424327 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dbttest1".
2021-03-05 02:59:21.424582 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-05 02:59:21.436079 (ThreadPoolExecutor-0_0): Using postgres connection "list_dbttest1".
2021-03-05 02:59:21.436254 (ThreadPoolExecutor-0_0): On list_dbttest1: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1"} */

    select distinct nspname from pg_namespace
  
2021-03-05 02:59:21.447037 (ThreadPoolExecutor-0_0): Got an error when attempting to open a postgres connection: 'FATAL:  database "dbttest1" does not exist
'
2021-03-05 02:59:21.447318 (ThreadPoolExecutor-0_0): Error running SQL: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1"} */

    select distinct nspname from pg_namespace
  
2021-03-05 02:59:21.447429 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-03-05 02:59:21.447617 (ThreadPoolExecutor-0_0): On list_dbttest1: No close available on handle
2021-03-05 02:59:21.447905 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2021-03-05 02:59:21.448088 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-03-05 02:59:21.449170 (MainThread): Connection 'master' was properly closed.
2021-03-05 02:59:21.449390 (MainThread): Connection 'list_dbttest1' was properly closed.
2021-03-05 02:59:21.449537 (MainThread): ERROR: Database Error
  FATAL:  database "dbttest1" does not exist
  
2021-03-05 02:59:21.449827 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11004ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11004c110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fdfac50>]}
2021-03-05 02:59:21.450182 (MainThread): Flushing usage events
2021-03-05 02:59:55.281895 (MainThread): Running with dbt=0.17.0
2021-03-05 02:59:55.438785 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['test'], partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-05 02:59:55.443488 (MainThread): Tracking: tracking
2021-03-05 02:59:55.570668 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128e5210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128dac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ccbad0>]}
2021-03-05 02:59:55.610719 (MainThread): Partial parsing not enabled
2021-03-05 02:59:55.614717 (MainThread): Parsing macros/core.sql
2021-03-05 02:59:55.624327 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-05 02:59:55.641057 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-05 02:59:55.643729 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-05 02:59:55.666527 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-05 02:59:55.702533 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-05 02:59:55.728025 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-05 02:59:55.730494 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-05 02:59:55.738900 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-05 02:59:55.755911 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-05 02:59:55.766448 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-05 02:59:55.774756 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-05 02:59:55.781905 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-05 02:59:55.784350 (MainThread): Parsing macros/etc/query.sql
2021-03-05 02:59:55.786945 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-05 02:59:55.789722 (MainThread): Parsing macros/etc/datetime.sql
2021-03-05 02:59:55.802962 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-05 02:59:55.806852 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-05 02:59:55.809838 (MainThread): Parsing macros/adapters/common.sql
2021-03-05 02:59:55.869778 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-05 02:59:55.871519 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-05 02:59:55.872908 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-05 02:59:55.874394 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-05 02:59:55.877327 (MainThread): Parsing macros/catalog.sql
2021-03-05 02:59:55.880223 (MainThread): Parsing macros/relations.sql
2021-03-05 02:59:55.882156 (MainThread): Parsing macros/adapters.sql
2021-03-05 02:59:55.907450 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-03-05 02:59:55.929316 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0
2021-03-05 02:59:55.929925 (MainThread): Partial parsing not enabled
2021-03-05 02:59:55.973982 (MainThread): Acquiring new postgres connection "model.jaffle_shop.test".
2021-03-05 02:59:55.974161 (MainThread): Opening a new connection, currently in state init
2021-03-05 02:59:56.001570 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2021-03-05 02:59:56.001717 (MainThread): Opening a new connection, currently in state init
2021-03-05 02:59:56.009138 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2021-03-05 02:59:56.009280 (MainThread): Opening a new connection, currently in state init
2021-03-05 02:59:56.017466 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2021-03-05 02:59:56.017608 (MainThread): Opening a new connection, currently in state init
2021-03-05 02:59:56.026090 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2021-03-05 02:59:56.026246 (MainThread): Opening a new connection, currently in state init
2021-03-05 02:59:56.058770 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2021-03-05 02:59:56.058918 (MainThread): Opening a new connection, currently in state init
2021-03-05 02:59:56.068245 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2021-03-05 02:59:56.068387 (MainThread): Opening a new connection, currently in state init
2021-03-05 02:59:56.076661 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2021-03-05 02:59:56.076800 (MainThread): Opening a new connection, currently in state init
2021-03-05 02:59:56.085008 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2021-03-05 02:59:56.085151 (MainThread): Opening a new connection, currently in state init
2021-03-05 02:59:56.544055 (MainThread): Found 9 models, 20 tests, 0 snapshots, 0 analyses, 134 macros, 0 operations, 3 seed files, 0 sources
2021-03-05 02:59:56.546180 (MainThread): 
2021-03-05 02:59:56.546617 (MainThread): Acquiring new postgres connection "master".
2021-03-05 02:59:56.546727 (MainThread): Opening a new connection, currently in state init
2021-03-05 02:59:56.548805 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dbttest1".
2021-03-05 02:59:56.548938 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-05 02:59:56.561255 (ThreadPoolExecutor-0_0): Using postgres connection "list_dbttest1".
2021-03-05 02:59:56.561428 (ThreadPoolExecutor-0_0): On list_dbttest1: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1"} */

    select distinct nspname from pg_namespace
  
2021-03-05 02:59:56.577537 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.02 seconds
2021-03-05 02:59:56.628594 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dbttest1_public".
2021-03-05 02:59:56.628943 (ThreadPoolExecutor-1_0): Re-using an available connection from the pool (formerly list_dbttest1).
2021-03-05 02:59:56.635335 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2021-03-05 02:59:56.635513 (ThreadPoolExecutor-1_0): On list_dbttest1_public: BEGIN
2021-03-05 02:59:56.638213 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-03-05 02:59:56.638424 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2021-03-05 02:59:56.638581 (ThreadPoolExecutor-1_0): On list_dbttest1_public: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1_public"} */
select
      'dbttest1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbttest1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-03-05 02:59:56.661349 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.02 seconds
2021-03-05 02:59:56.661736 (ThreadPoolExecutor-1_0): On list_dbttest1_public: ROLLBACK
2021-03-05 02:59:56.709165 (MainThread): Using postgres connection "master".
2021-03-05 02:59:56.709336 (MainThread): On master: BEGIN
2021-03-05 02:59:56.718689 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-03-05 02:59:56.718894 (MainThread): Using postgres connection "master".
2021-03-05 02:59:56.718999 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-03-05 02:59:56.733146 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-03-05 02:59:56.733511 (MainThread): On master: ROLLBACK
2021-03-05 02:59:56.735030 (MainThread): Using postgres connection "master".
2021-03-05 02:59:56.735169 (MainThread): On master: BEGIN
2021-03-05 02:59:56.737618 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-03-05 02:59:56.737856 (MainThread): On master: COMMIT
2021-03-05 02:59:56.738028 (MainThread): Using postgres connection "master".
2021-03-05 02:59:56.738134 (MainThread): On master: COMMIT
2021-03-05 02:59:56.739395 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-03-05 02:59:56.739736 (MainThread): 21:59:56 | Concurrency: 1 threads (target='dev')
2021-03-05 02:59:56.739872 (MainThread): 21:59:56 | 
2021-03-05 02:59:56.742325 (Thread-1): Began running node model.jaffle_shop.test
2021-03-05 02:59:56.743845 (Thread-1): 21:59:56 | 1 of 1 START view model public.test.................................. [RUN]
2021-03-05 02:59:56.744195 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.test".
2021-03-05 02:59:56.744296 (Thread-1): Re-using an available connection from the pool (formerly list_dbttest1_public).
2021-03-05 02:59:56.744400 (Thread-1): Compiling model.jaffle_shop.test
2021-03-05 02:59:56.758451 (Thread-1): Writing injected SQL for node "model.jaffle_shop.test"
2021-03-05 02:59:56.759970 (Thread-1): finished collecting timing info
2021-03-05 02:59:56.790976 (Thread-1): Using postgres connection "model.jaffle_shop.test".
2021-03-05 02:59:56.791148 (Thread-1): On model.jaffle_shop.test: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.test"} */
drop view if exists "dbttest1"."public"."test__dbt_tmp" cascade
2021-03-05 02:59:56.797952 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-03-05 02:59:56.800240 (Thread-1): Using postgres connection "model.jaffle_shop.test".
2021-03-05 02:59:56.800360 (Thread-1): On model.jaffle_shop.test: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.test"} */
drop view if exists "dbttest1"."public"."test__dbt_backup" cascade
2021-03-05 02:59:56.801643 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-03-05 02:59:56.806436 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.test"
2021-03-05 02:59:56.807224 (Thread-1): Using postgres connection "model.jaffle_shop.test".
2021-03-05 02:59:56.807337 (Thread-1): On model.jaffle_shop.test: BEGIN
2021-03-05 02:59:56.809320 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-03-05 02:59:56.809480 (Thread-1): Using postgres connection "model.jaffle_shop.test".
2021-03-05 02:59:56.809571 (Thread-1): On model.jaffle_shop.test: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.test"} */

  create view "dbttest1"."public"."test__dbt_tmp" as (
    select 1 as a, 2 as b, 3 as a, 4 as d
  );

2021-03-05 02:59:56.812155 (Thread-1): Postgres error: column "a" specified more than once

2021-03-05 02:59:56.812291 (Thread-1): On model.jaffle_shop.test: ROLLBACK
2021-03-05 02:59:56.813463 (Thread-1): finished collecting timing info
2021-03-05 02:59:56.813908 (Thread-1): Database Error in model test (models/staging/test.sql)
  column "a" specified more than once
  compiled SQL at target/run/jaffle_shop/models/staging/test.sql
Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 74, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.DuplicateColumn: column "a" specified more than once


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 119, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 82, in add_query
    return connection, cursor
  File "/Users/naveen/.pyenv/versions/3.7.4/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model test (models/staging/test.sql)
  column "a" specified more than once
  compiled SQL at target/run/jaffle_shop/models/staging/test.sql
2021-03-05 02:59:56.820073 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2384dcfd-e9e0-46e5-a9bd-fca840cc3131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113169e10>]}
2021-03-05 02:59:56.821454 (Thread-1): 21:59:56 | 1 of 1 ERROR creating view model public.test......................... [ERROR in 0.08s]
2021-03-05 02:59:56.821649 (Thread-1): Finished running node model.jaffle_shop.test
2021-03-05 02:59:56.847744 (MainThread): Using postgres connection "master".
2021-03-05 02:59:56.848052 (MainThread): On master: BEGIN
2021-03-05 02:59:56.850828 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-03-05 02:59:56.851127 (MainThread): On master: COMMIT
2021-03-05 02:59:56.851334 (MainThread): Using postgres connection "master".
2021-03-05 02:59:56.851517 (MainThread): On master: COMMIT
2021-03-05 02:59:56.853908 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-03-05 02:59:56.854572 (MainThread): 21:59:56 | 
2021-03-05 02:59:56.854822 (MainThread): 21:59:56 | Finished running 1 view model in 0.31s.
2021-03-05 02:59:56.855120 (MainThread): Connection 'master' was left open.
2021-03-05 02:59:56.855444 (MainThread): On master: Close
2021-03-05 02:59:56.855680 (MainThread): Connection 'model.jaffle_shop.test' was left open.
2021-03-05 02:59:56.855870 (MainThread): On model.jaffle_shop.test: Close
2021-03-05 02:59:56.865387 (MainThread): 
2021-03-05 02:59:56.865686 (MainThread): Completed with 1 error and 0 warnings:
2021-03-05 02:59:56.865939 (MainThread): 
2021-03-05 02:59:56.866251 (MainThread): Database Error in model test (models/staging/test.sql)
2021-03-05 02:59:56.866495 (MainThread):   column "a" specified more than once
2021-03-05 02:59:56.866752 (MainThread):   compiled SQL at target/run/jaffle_shop/models/staging/test.sql
2021-03-05 02:59:56.866914 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-03-05 02:59:56.867179 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112dee310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f6a1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113169790>]}
2021-03-05 02:59:56.867411 (MainThread): Flushing usage events
2021-03-05 03:15:25.809028 (MainThread): Running with dbt=0.17.0
2021-03-05 03:15:25.993917 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.rpc.server.RPCServerTask'>, debug=False, exclude=None, host='0.0.0.0', log_cache_events=False, log_format='default', models=None, partial_parse=None, port=8580, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='rpc', write_json=True)
2021-03-05 03:15:26.032037 (Thread-1): Partial parsing not enabled
2021-03-05 03:15:26.034016 (MainThread): Tracking: tracking
2021-03-05 03:15:26.047178 (Thread-1): Parsing macros/core.sql
2021-03-05 03:15:26.060289 (Thread-1): Parsing macros/materializations/helpers.sql
2021-03-05 03:15:26.087339 (Thread-1): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-05 03:15:26.093421 (Thread-1): Parsing macros/materializations/snapshot/strategies.sql
2021-03-05 03:15:26.148743 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bb2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bb2750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bb2810>]}
2021-03-05 03:15:26.158490 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=44386
2021-03-05 03:15:26.164837 (MainThread): Supported methods: ['cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'status', 'test']
2021-03-05 03:15:26.165299 (MainThread): Send requests to http://localhost:8580/jsonrpc
2021-03-05 03:15:26.177726 (Thread-1): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-05 03:15:26.320388 (Thread-1): Parsing macros/materializations/seed/seed.sql
2021-03-05 03:15:26.382898 (Thread-1): Parsing macros/materializations/incremental/helpers.sql
2021-03-05 03:15:26.388765 (Thread-1): Parsing macros/materializations/incremental/incremental.sql
2021-03-05 03:15:26.403737 (Thread-1): Parsing macros/materializations/common/merge.sql
2021-03-05 03:15:26.441947 (Thread-1): Parsing macros/materializations/table/table.sql
2021-03-05 03:15:26.459694 (Thread-1): Parsing macros/materializations/view/view.sql
2021-03-05 03:15:26.474768 (Thread-1): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-05 03:15:26.485472 (Thread-1): Parsing macros/etc/get_custom_alias.sql
2021-03-05 03:15:26.487688 (Thread-1): Parsing macros/etc/query.sql
2021-03-05 03:15:26.490426 (Thread-1): Parsing macros/etc/is_incremental.sql
2021-03-05 03:15:26.494526 (Thread-1): Parsing macros/etc/datetime.sql
2021-03-05 03:15:26.517996 (Thread-1): Parsing macros/etc/get_custom_schema.sql
2021-03-05 03:15:26.525108 (Thread-1): Parsing macros/etc/get_custom_database.sql
2021-03-05 03:15:26.528984 (Thread-1): Parsing macros/adapters/common.sql
2021-03-05 03:15:26.672608 (Thread-1): Parsing macros/schema_tests/relationships.sql
2021-03-05 03:15:26.674855 (Thread-1): Parsing macros/schema_tests/not_null.sql
2021-03-05 03:15:26.676575 (Thread-1): Parsing macros/schema_tests/unique.sql
2021-03-05 03:15:26.678123 (Thread-1): Parsing macros/schema_tests/accepted_values.sql
2021-03-05 03:15:26.683797 (Thread-1): Parsing macros/catalog.sql
2021-03-05 03:15:26.692351 (Thread-1): Parsing macros/relations.sql
2021-03-05 03:15:26.694411 (Thread-1): Parsing macros/adapters.sql
2021-03-05 03:15:26.737730 (Thread-1): Parsing macros/materializations/snapshot_merge.sql
2021-03-05 03:15:26.766226 (Thread-1): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0
2021-03-05 03:15:26.767294 (Thread-1): Partial parsing not enabled
2021-03-05 03:15:26.814626 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.test".
2021-03-05 03:15:26.814972 (Thread-1): Opening a new connection, currently in state init
2021-03-05 03:15:26.841140 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2021-03-05 03:15:26.841310 (Thread-1): Opening a new connection, currently in state init
2021-03-05 03:15:26.849382 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2021-03-05 03:15:26.849542 (Thread-1): Opening a new connection, currently in state init
2021-03-05 03:15:26.857236 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2021-03-05 03:15:26.857395 (Thread-1): Opening a new connection, currently in state init
2021-03-05 03:15:26.866423 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2021-03-05 03:15:26.866580 (Thread-1): Opening a new connection, currently in state init
2021-03-05 03:15:26.899695 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2021-03-05 03:15:26.899861 (Thread-1): Opening a new connection, currently in state init
2021-03-05 03:15:26.911968 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2021-03-05 03:15:26.912172 (Thread-1): Opening a new connection, currently in state init
2021-03-05 03:15:26.921068 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2021-03-05 03:15:26.921230 (Thread-1): Opening a new connection, currently in state init
2021-03-05 03:15:26.930073 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2021-03-05 03:15:26.930233 (Thread-1): Opening a new connection, currently in state init
2021-03-05 03:27:58.448816 (Thread-3): sending response (<Response 83 bytes [200 OK]>) to 127.0.0.1
2021-03-05 03:29:50.083874 (Thread-4): sending response (<Response 83 bytes [200 OK]>) to 127.0.0.1
2021-03-05 03:31:41.632971 (Thread-5): sending response (<Response 83 bytes [200 OK]>) to 127.0.0.1
2021-03-05 03:31:52.596597 (Thread-6): handling run_sql request
2021-03-05 03:31:52.609749 (Thread-6): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '3c0abddc-25e3-4a13-b0ab-9babe3ae0c4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d506d0>]}
2021-03-05 03:31:52.802998 (Thread-6): Connection 'model.jaffle_shop.customer_orders' was properly closed.
2021-03-05 03:31:56.417239 (Thread-6): sending response (<Response 130 bytes [200 OK]>) to 127.0.0.1
2021-03-05 03:31:56.520250 (MainThread): Acquiring new postgres connection "rpc.jaffle_shop.request".
2021-03-05 03:31:56.521706 (MainThread): Opening a new connection, currently in state init
2021-03-05 03:31:56.742011 (MainThread): Found 9 models, 20 tests, 0 snapshots, 0 analyses, 134 macros, 0 operations, 3 seed files, 0 sources
2021-03-05 03:31:56.750085 (Thread-1): Acquiring new postgres connection "rpc.jaffle_shop.request".
2021-03-05 03:31:56.750401 (Thread-1): Opening a new connection, currently in state init
2021-03-05 03:31:56.750733 (Thread-1): Compiling rpc.jaffle_shop.request
2021-03-05 03:31:56.819289 (Thread-1): finished collecting timing info
2021-03-05 03:31:56.820213 (Thread-1): Using postgres connection "rpc.jaffle_shop.request".
2021-03-05 03:31:56.820462 (Thread-1): On rpc.jaffle_shop.request: select 1 as a, 2 as b, 3 as a, 4 as d
limit 500
/* limit added automatically by dbt cloud */
2021-03-05 03:31:56.955482 (Thread-1): SQL status: SELECT 1 in 0.13 seconds
2021-03-05 03:31:56.956067 (Thread-1): Column name "a" already exists in Table. Column will be renamed to "a_2".
2021-03-05 03:31:56.957618 (Thread-1): finished collecting timing info
2021-03-05 03:32:52.394809 (Thread-7): handling run_sql request
2021-03-05 03:32:52.400060 (Thread-7): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '3c0abddc-25e3-4a13-b0ab-9babe3ae0c4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e00d90>]}
2021-03-05 03:32:56.199254 (Thread-7): sending response (<Response 130 bytes [200 OK]>) to 127.0.0.1
2021-03-05 03:32:56.306224 (MainThread): Acquiring new postgres connection "rpc.jaffle_shop.request".
2021-03-05 03:32:56.307371 (MainThread): Opening a new connection, currently in state init
2021-03-05 03:32:56.445844 (MainThread): Found 9 models, 20 tests, 0 snapshots, 0 analyses, 134 macros, 0 operations, 3 seed files, 0 sources
2021-03-05 03:32:56.517013 (Thread-1): Acquiring new postgres connection "rpc.jaffle_shop.request".
2021-03-05 03:32:56.517297 (Thread-1): Opening a new connection, currently in state init
2021-03-05 03:32:56.517557 (Thread-1): Compiling rpc.jaffle_shop.request
2021-03-05 03:32:56.567036 (Thread-1): finished collecting timing info
2021-03-05 03:32:56.567806 (Thread-1): Using postgres connection "rpc.jaffle_shop.request".
2021-03-05 03:32:56.568016 (Thread-1): On rpc.jaffle_shop.request: select 1 as a, 2 as b, 3 as a, 4 as d
limit 500
/* limit added automatically by dbt cloud */
2021-03-05 03:32:56.889270 (Thread-1): SQL status: SELECT 1 in 0.32 seconds
2021-03-05 03:32:56.890166 (Thread-1): Column name "a" already exists in Table. Column will be renamed to "a_2".
2021-03-05 03:32:56.891028 (Thread-1): finished collecting timing info
2021-03-05 03:41:02.601051 (Thread-8): handling poll request
2021-03-05 03:41:02.614089 (Thread-8): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '3c0abddc-25e3-4a13-b0ab-9babe3ae0c4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e8cfd0>]}
2021-03-05 03:41:02.671710 (Thread-8): API Exception: {'type': 'TypeError', 'args': (<ValidationError: "'0d4c77d2-7cb7-4301-9385-3874241987f' does not match '[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}'">,), 'message': "'0d4c77d2-7cb7-4301-9385-3874241987f' does not match '[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}'\n\nFailed validating 'pattern' in schema['properties']['request_token']:\n    {'pattern': '[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}',\n     'type': 'string'}\n\nOn instance['request_token']:\n    '0d4c77d2-7cb7-4301-9385-3874241987f'"}
jsonschema.exceptions.ValidationError: '0d4c77d2-7cb7-4301-9385-3874241987f' does not match '[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}'

Failed validating 'pattern' in schema['properties']['request_token']:
    {'pattern': '[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}',
     'type': 'string'}

On instance['request_token']:
    '0d4c77d2-7cb7-4301-9385-3874241987f'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/rpc/method.py", line 113, in __call__
    params = self.get_parameters().from_dict(kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/hologram/__init__.py", line 594, in from_dict
    cls.validate(data)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/hologram/__init__.py", line 937, in validate
    raise ValidationError.create_from(error) from error
hologram.ValidationError: '0d4c77d2-7cb7-4301-9385-3874241987f' does not match '[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}'

Failed validating 'pattern' in schema['properties']['request_token']:
    {'pattern': '[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}',
     'type': 'string'}

On instance['request_token']:
    '0d4c77d2-7cb7-4301-9385-3874241987f'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jsonrpc/manager.py", line 113, in _get_responses
    result = method(*request.args, **request.kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/rpc/method.py", line 115, in __call__
    raise TypeError(exc) from exc
TypeError: '0d4c77d2-7cb7-4301-9385-3874241987f' does not match '[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}'

Failed validating 'pattern' in schema['properties']['request_token']:
    {'pattern': '[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}',
     'type': 'string'}

On instance['request_token']:
    '0d4c77d2-7cb7-4301-9385-3874241987f'
2021-03-05 03:41:02.688022 (Thread-8): sending response (<Response 915 bytes [200 OK]>) to 127.0.0.1
2021-03-05 03:42:01.388227 (Thread-9): handling poll request
2021-03-05 03:42:01.390655 (Thread-9): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '3c0abddc-25e3-4a13-b0ab-9babe3ae0c4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ffb1d0>]}
2021-03-05 03:42:01.492879 (Thread-9): sending response (<Response 5668 bytes [200 OK]>) to 127.0.0.1
2021-03-05 03:42:27.476137 (Thread-10): handling run_sql request
2021-03-05 03:42:27.478234 (Thread-10): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '3c0abddc-25e3-4a13-b0ab-9babe3ae0c4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10402a990>]}
2021-03-05 03:42:31.271554 (Thread-10): sending response (<Response 130 bytes [200 OK]>) to 127.0.0.1
2021-03-05 03:42:31.382919 (MainThread): Acquiring new postgres connection "rpc.jaffle_shop.request".
2021-03-05 03:42:31.386685 (MainThread): Opening a new connection, currently in state init
2021-03-05 03:42:31.519722 (MainThread): Found 9 models, 20 tests, 0 snapshots, 0 analyses, 134 macros, 0 operations, 3 seed files, 0 sources
2021-03-05 03:42:31.530273 (Thread-1): Acquiring new postgres connection "rpc.jaffle_shop.request".
2021-03-05 03:42:31.530759 (Thread-1): Opening a new connection, currently in state init
2021-03-05 03:42:31.531035 (Thread-1): Compiling rpc.jaffle_shop.request
2021-03-05 03:42:31.595868 (Thread-1): finished collecting timing info
2021-03-05 03:42:31.597006 (Thread-1): Using postgres connection "rpc.jaffle_shop.request".
2021-03-05 03:42:31.597263 (Thread-1): On rpc.jaffle_shop.request: select 1 as a, 2 as b, 3 as a, 4 as d
limit 500
/* limit added automatically by dbt cloud */
2021-03-05 03:42:31.769552 (Thread-1): SQL status: SELECT 1 in 0.17 seconds
2021-03-05 03:42:31.770112 (Thread-1): Column name "a" already exists in Table. Column will be renamed to "a_2".
2021-03-05 03:42:31.770736 (Thread-1): finished collecting timing info
2021-03-05 04:04:23.630972 (MainThread): Running with dbt=0.17.0
2021-03-05 04:04:23.851328 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.rpc.server.RPCServerTask'>, debug=False, exclude=None, host='0.0.0.0', log_cache_events=False, log_format='default', models=None, partial_parse=None, port=8580, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='rpc', write_json=True)
2021-03-05 04:04:23.863640 (MainThread): Tracking: tracking
2021-03-05 04:04:23.889065 (Thread-1): Partial parsing not enabled
2021-03-05 04:04:23.894726 (Thread-1): Parsing macros/core.sql
2021-03-05 04:04:23.904146 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104593c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10459fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10459f690>]}
2021-03-05 04:04:23.904914 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=49227
2021-03-05 04:04:23.905691 (MainThread): Supported methods: ['cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'status', 'test']
2021-03-05 04:04:23.906243 (Thread-1): Parsing macros/materializations/helpers.sql
2021-03-05 04:04:23.906425 (MainThread): Send requests to http://localhost:8580/jsonrpc
2021-03-05 04:04:23.919806 (Thread-1): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-05 04:04:23.923521 (Thread-1): Parsing macros/materializations/snapshot/strategies.sql
2021-03-05 04:04:23.947682 (Thread-1): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-05 04:04:23.986074 (Thread-1): Parsing macros/materializations/seed/seed.sql
2021-03-05 04:04:24.010596 (Thread-1): Parsing macros/materializations/incremental/helpers.sql
2021-03-05 04:04:24.013145 (Thread-1): Parsing macros/materializations/incremental/incremental.sql
2021-03-05 04:04:24.020951 (Thread-1): Parsing macros/materializations/common/merge.sql
2021-03-05 04:04:24.037965 (Thread-1): Parsing macros/materializations/table/table.sql
2021-03-05 04:04:24.046391 (Thread-1): Parsing macros/materializations/view/view.sql
2021-03-05 04:04:24.054155 (Thread-1): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-05 04:04:24.060237 (Thread-1): Parsing macros/etc/get_custom_alias.sql
2021-03-05 04:04:24.062028 (Thread-1): Parsing macros/etc/query.sql
2021-03-05 04:04:24.063707 (Thread-1): Parsing macros/etc/is_incremental.sql
2021-03-05 04:04:24.066640 (Thread-1): Parsing macros/etc/datetime.sql
2021-03-05 04:04:24.078885 (Thread-1): Parsing macros/etc/get_custom_schema.sql
2021-03-05 04:04:24.081618 (Thread-1): Parsing macros/etc/get_custom_database.sql
2021-03-05 04:04:24.084003 (Thread-1): Parsing macros/adapters/common.sql
2021-03-05 04:04:24.144304 (Thread-1): Parsing macros/schema_tests/relationships.sql
2021-03-05 04:04:24.146225 (Thread-1): Parsing macros/schema_tests/not_null.sql
2021-03-05 04:04:24.147713 (Thread-1): Parsing macros/schema_tests/unique.sql
2021-03-05 04:04:24.149367 (Thread-1): Parsing macros/schema_tests/accepted_values.sql
2021-03-05 04:04:24.152513 (Thread-1): Parsing macros/catalog.sql
2021-03-05 04:04:24.155554 (Thread-1): Parsing macros/relations.sql
2021-03-05 04:04:24.157410 (Thread-1): Parsing macros/adapters.sql
2021-03-05 04:04:24.183037 (Thread-1): Parsing macros/materializations/snapshot_merge.sql
2021-03-05 04:04:24.207384 (Thread-1): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffle_shop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0
2021-03-05 04:04:24.208147 (Thread-1): Partial parsing not enabled
2021-03-05 04:04:24.249356 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.test".
2021-03-05 04:04:24.249559 (Thread-1): Opening a new connection, currently in state init
2021-03-05 04:04:24.274589 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2021-03-05 04:04:24.274763 (Thread-1): Opening a new connection, currently in state init
2021-03-05 04:04:24.282303 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2021-03-05 04:04:24.282458 (Thread-1): Opening a new connection, currently in state init
2021-03-05 04:04:24.290127 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2021-03-05 04:04:24.290284 (Thread-1): Opening a new connection, currently in state init
2021-03-05 04:04:24.298345 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2021-03-05 04:04:24.298499 (Thread-1): Opening a new connection, currently in state init
2021-03-05 04:04:24.333216 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2021-03-05 04:04:24.333377 (Thread-1): Opening a new connection, currently in state init
2021-03-05 04:04:24.342351 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2021-03-05 04:04:24.342505 (Thread-1): Opening a new connection, currently in state init
2021-03-05 04:04:24.351233 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2021-03-05 04:04:24.351388 (Thread-1): Opening a new connection, currently in state init
2021-03-05 04:04:24.359287 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2021-03-05 04:04:24.359449 (Thread-1): Opening a new connection, currently in state init
2021-03-05 04:04:28.941995 (Thread-2): handling run_sql request
2021-03-05 04:04:28.942507 (Thread-2): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '151d2f26-72ed-48f5-a699-0bc32e0ae30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10482ff50>]}
2021-03-05 04:04:28.949709 (Thread-2): Connection 'model.jaffle_shop.customer_orders' was properly closed.
2021-03-05 04:04:30.064092 (Thread-2): sending response (<Response 130 bytes [200 OK]>) to 127.0.0.1
2021-03-05 04:04:30.100248 (MainThread): Acquiring new postgres connection "rpc.jaffle_shop.request".
2021-03-05 04:04:30.101379 (MainThread): Opening a new connection, currently in state init
2021-03-05 04:04:30.159644 (MainThread): Found 9 models, 20 tests, 0 snapshots, 0 analyses, 134 macros, 0 operations, 3 seed files, 0 sources
2021-03-05 04:04:30.163364 (Thread-1): Acquiring new postgres connection "rpc.jaffle_shop.request".
2021-03-05 04:04:30.163504 (Thread-1): Opening a new connection, currently in state init
2021-03-05 04:04:30.163634 (Thread-1): Compiling rpc.jaffle_shop.request
2021-03-05 04:04:30.197744 (Thread-1): finished collecting timing info
2021-03-05 04:04:30.198598 (Thread-1): Using postgres connection "rpc.jaffle_shop.request".
2021-03-05 04:04:30.198778 (Thread-1): On rpc.jaffle_shop.request: select 1 as a, 2 as b, 3 as a, 4 as d
limit 500
/* limit added automatically by dbt cloud */
2021-03-05 04:04:30.208946 (Thread-1): Got an error when attempting to open a postgres connection: 'FATAL:  database "dbttest1" does not exist
'
2021-03-05 04:04:30.209224 (Thread-1): Error running SQL: select 1 as a, 2 as b, 3 as a, 4 as d
limit 500
/* limit added automatically by dbt cloud */
2021-03-05 04:04:30.209338 (Thread-1): Rolling back transaction.
2021-03-05 04:04:30.209466 (Thread-1): On rpc.jaffle_shop.request: No close available on handle
2021-03-05 04:04:30.209605 (Thread-1): finished collecting timing info
2021-03-05 04:04:30.210034 (Thread-1): Got an exception: Database Error
  FATAL:  database "dbttest1" does not exist
  
Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 104, in open
    **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/psycopg2/__init__.py", line 127, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: FATAL:  database "dbttest1" does not exist


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/rpc/node_runners.py", line 86, in execute
    compiled_node.injected_sql, fetch=True
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 119, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 73, in add_query
    cursor = connection.handle.cursor()
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/contracts/connection.py", line 69, in handle
    self._handle.resolve(self)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/contracts/connection.py", line 90, in resolve
    return self.opener(connection)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 119, in open
    raise dbt.exceptions.FailedToConnectException(str(e))
dbt.exceptions.FailedToConnectException: Database Error
  FATAL:  database "dbttest1" does not exist
2021-03-05 04:04:30.221785 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'FailedToConnectException', 'message': 'Database Error in rpc request (from remote system)\n  FATAL:  database "dbttest1" does not exist\n  ', 'raw_sql': 'select 1 as a, 2 as b, 3 as a, 4 as d\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_sql': 'select 1 as a, 2 as b, 3 as a, 4 as d\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/task/rpc/sql_commands.py", line 165, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/node_runners.py", line 244, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/rpc/node_runners.py", line 53, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'FailedToConnectException', 'message': 'Database Error in rpc request (from remote system)\n  FATAL:  database "dbttest1" does not exist\n  ', 'raw_sql': 'select 1 as a, 2 as b, 3 as a, 4 as d\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_sql': 'select 1 as a, 2 as b, 3 as a, 4 as d\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2021-03-05 04:05:34.927442 (Thread-3): sending response (<Response 83 bytes [200 OK]>) to 127.0.0.1
2021-03-05 04:05:47.197618 (Thread-4): sending response (<Response 87 bytes [200 OK]>) to 127.0.0.1
2021-03-05 04:13:44.241852 (Thread-5): sending response (<Response 83 bytes [200 OK]>) to 127.0.0.1
2021-03-05 04:14:28.891804 (Thread-6): sending response (<Response 83 bytes [200 OK]>) to 127.0.0.1
2021-03-05 04:15:05.443734 (Thread-7): handling poll request
2021-03-05 04:15:05.448554 (Thread-7): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '151d2f26-72ed-48f5-a699-0bc32e0ae30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049f0250>]}
2021-03-05 04:15:05.485554 (Thread-7): sending response (<Response 9501 bytes [200 OK]>) to 127.0.0.1
2021-03-05 04:15:38.930045 (Thread-8): handling poll request
2021-03-05 04:15:38.935570 (Thread-8): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '151d2f26-72ed-48f5-a699-0bc32e0ae30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049f5b50>]}
2021-03-05 04:15:38.938939 (Thread-8): sending response (<Response 9501 bytes [200 OK]>) to 127.0.0.1
2021-03-05 04:16:02.772931 (Thread-9): handling run_sql request
2021-03-05 04:16:02.778838 (Thread-9): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '151d2f26-72ed-48f5-a699-0bc32e0ae30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049fb250>]}
2021-03-05 04:16:04.092723 (Thread-9): sending response (<Response 130 bytes [200 OK]>) to 127.0.0.1
2021-03-05 04:16:04.129889 (MainThread): Acquiring new postgres connection "rpc.jaffle_shop.request".
2021-03-05 04:16:04.133098 (MainThread): Opening a new connection, currently in state init
2021-03-05 04:16:04.185038 (MainThread): Found 9 models, 20 tests, 0 snapshots, 0 analyses, 134 macros, 0 operations, 3 seed files, 0 sources
2021-03-05 04:16:04.189988 (Thread-1): Acquiring new postgres connection "rpc.jaffle_shop.request".
2021-03-05 04:16:04.190147 (Thread-1): Opening a new connection, currently in state init
2021-03-05 04:16:04.190283 (Thread-1): Compiling rpc.jaffle_shop.request
2021-03-05 04:16:04.214836 (Thread-1): finished collecting timing info
2021-03-05 04:16:04.215265 (Thread-1): Using postgres connection "rpc.jaffle_shop.request".
2021-03-05 04:16:04.215380 (Thread-1): On rpc.jaffle_shop.request: select 1 as a, 2 as b, 3 as a, 4 as d
limit 500
/* limit added automatically by dbt cloud */
2021-03-05 04:16:04.231435 (Thread-1): SQL status: SELECT 1 in 0.02 seconds
2021-03-05 04:16:04.231801 (Thread-1): Column name "a" already exists in Table. Column will be renamed to "a_2".
2021-03-05 04:16:04.232209 (Thread-1): finished collecting timing info
2021-03-05 04:16:42.417305 (Thread-10): handling poll request
2021-03-05 04:16:42.418261 (Thread-10): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '151d2f26-72ed-48f5-a699-0bc32e0ae30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049fb250>]}
2021-03-05 04:16:42.439183 (Thread-10): sending response (<Response 5668 bytes [200 OK]>) to 127.0.0.1
2021-03-05 04:17:59.117913 (Thread-11): handling poll request
2021-03-05 04:17:59.118823 (Thread-11): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '151d2f26-72ed-48f5-a699-0bc32e0ae30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049ed290>]}
2021-03-05 04:17:59.130503 (Thread-11): sending response (<Response 5668 bytes [200 OK]>) to 127.0.0.1
2021-03-05 22:40:18.268995 (Thread-12): Partial parsing not enabled
2021-03-05 22:40:18.327949 (Thread-12): Acquiring new postgres connection "model.jaffle_shop.test".
2021-03-05 22:40:18.328123 (Thread-12): Opening a new connection, currently in state init
2021-03-05 22:40:18.334905 (Thread-12): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2021-03-05 22:40:18.335062 (Thread-12): Opening a new connection, currently in state init
2021-03-05 22:40:18.342783 (Thread-12): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2021-03-05 22:40:18.342937 (Thread-12): Opening a new connection, currently in state init
2021-03-05 22:40:18.350135 (Thread-12): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2021-03-05 22:40:18.350294 (Thread-12): Opening a new connection, currently in state init
2021-03-05 22:40:18.357379 (Thread-12): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2021-03-05 22:40:18.357536 (Thread-12): Opening a new connection, currently in state init
2021-03-05 22:40:18.366468 (Thread-12): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2021-03-05 22:40:18.366658 (Thread-12): Opening a new connection, currently in state init
2021-03-05 22:40:18.375631 (Thread-12): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2021-03-05 22:40:18.375789 (Thread-12): Opening a new connection, currently in state init
2021-03-05 22:40:18.383491 (Thread-12): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2021-03-05 22:40:18.383652 (Thread-12): Opening a new connection, currently in state init
2021-03-05 22:40:18.391494 (Thread-12): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2021-03-05 22:40:18.391650 (Thread-12): Opening a new connection, currently in state init
2021-03-16 14:45:03.838957 (MainThread): Running with dbt=0.19.0
2021-03-16 14:45:03.918646 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-16 14:45:03.920396 (MainThread): Tracking: tracking
2021-03-16 14:45:03.942802 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3bd050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b797b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7ab350>]}
2021-03-16 14:45:03.968191 (MainThread): Partial parsing not enabled
2021-03-16 14:45:03.969546 (MainThread): Parsing macros/catalog.sql
2021-03-16 14:45:03.975414 (MainThread): Parsing macros/relations.sql
2021-03-16 14:45:03.977314 (MainThread): Parsing macros/adapters.sql
2021-03-16 14:45:04.001079 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-03-16 14:45:04.004900 (MainThread): Parsing macros/core.sql
2021-03-16 14:45:04.010335 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-16 14:45:04.021742 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-16 14:45:04.025482 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-16 14:45:04.053075 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-16 14:45:04.091830 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-16 14:45:04.116745 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-16 14:45:04.119235 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-16 14:45:04.127066 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-16 14:45:04.144146 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-16 14:45:04.152374 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-16 14:45:04.160260 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-16 14:45:04.166296 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-16 14:45:04.167691 (MainThread): Parsing macros/etc/query.sql
2021-03-16 14:45:04.169223 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-16 14:45:04.171444 (MainThread): Parsing macros/etc/datetime.sql
2021-03-16 14:45:04.182425 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-16 14:45:04.185529 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-16 14:45:04.188422 (MainThread): Parsing macros/adapters/common.sql
2021-03-16 14:45:04.243139 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-16 14:45:04.245953 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-16 14:45:04.248179 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-16 14:45:04.250527 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-16 14:45:04.260539 (MainThread): Partial parsing not enabled
2021-03-16 14:45:04.328887 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2021-03-16 14:45:04.354996 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2021-03-16 14:45:04.370131 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2021-03-16 14:45:04.383273 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2021-03-16 14:45:04.398525 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2021-03-16 14:45:04.413223 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2021-03-16 14:45:04.426684 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2021-03-16 14:45:04.442399 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2021-03-16 14:45:04.970941 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd111dd18-b70f-438a-8274-509e7c2b6f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8c0650>]}
2021-03-16 14:45:05.090369 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 3 seed files, 0 sources, 0 exposures
2021-03-16 14:45:05.093003 (MainThread): 
2021-03-16 14:45:05.093376 (MainThread): Acquiring new postgres connection "master".
2021-03-16 14:45:05.104444 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dbttest1".
2021-03-16 14:45:05.115582 (ThreadPoolExecutor-0_0): Using postgres connection "list_dbttest1".
2021-03-16 14:45:05.115735 (ThreadPoolExecutor-0_0): On list_dbttest1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1"} */

    select distinct nspname from pg_namespace
  
2021-03-16 14:45:05.115834 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-16 14:45:05.129543 (ThreadPoolExecutor-0_0): Got an error when attempting to open a postgres connection: 'FATAL:  database "dbttest1" does not exist
'
2021-03-16 14:45:05.129741 (ThreadPoolExecutor-0_0): Error running SQL: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1"} */

    select distinct nspname from pg_namespace
  
2021-03-16 14:45:05.129852 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-03-16 14:45:05.130004 (ThreadPoolExecutor-0_0): Error running SQL: macro list_schemas
2021-03-16 14:45:05.130095 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-03-16 14:45:05.130204 (ThreadPoolExecutor-0_0): On list_dbttest1: No close available on handle
2021-03-16 14:45:05.130706 (MainThread): Connection 'master' was properly closed.
2021-03-16 14:45:05.130825 (MainThread): Connection 'list_dbttest1' was properly closed.
2021-03-16 14:45:05.130970 (MainThread): ERROR: Database Error
  FATAL:  database "dbttest1" does not exist
  
2021-03-16 14:45:05.131190 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc0eb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b976d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc75c50>]}
2021-03-16 14:45:05.131414 (MainThread): Flushing usage events
2021-03-16 14:45:52.583555 (MainThread): Running with dbt=0.19.0
2021-03-16 14:45:52.707701 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-16 14:45:52.709977 (MainThread): Tracking: tracking
2021-03-16 14:45:52.733974 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f56e390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f590490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5903d0>]}
2021-03-16 14:45:52.781967 (MainThread): Partial parsing not enabled
2021-03-16 14:45:52.783995 (MainThread): Parsing macros/catalog.sql
2021-03-16 14:45:52.792168 (MainThread): Parsing macros/relations.sql
2021-03-16 14:45:52.796674 (MainThread): Parsing macros/adapters.sql
2021-03-16 14:45:52.822211 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-03-16 14:45:52.826426 (MainThread): Parsing macros/core.sql
2021-03-16 14:45:52.831430 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-16 14:45:52.855355 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-16 14:45:52.860994 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-16 14:45:52.899697 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-16 14:45:52.944993 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-16 14:45:52.977519 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-16 14:45:52.980163 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-16 14:45:52.988226 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-16 14:45:53.004955 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-16 14:45:53.013741 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-16 14:45:53.021814 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-16 14:45:53.028437 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-16 14:45:53.029966 (MainThread): Parsing macros/etc/query.sql
2021-03-16 14:45:53.031824 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-16 14:45:53.034043 (MainThread): Parsing macros/etc/datetime.sql
2021-03-16 14:45:53.046252 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-16 14:45:53.049049 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-16 14:45:53.051393 (MainThread): Parsing macros/adapters/common.sql
2021-03-16 14:45:53.105870 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-16 14:45:53.108753 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-16 14:45:53.111278 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-16 14:45:53.114747 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-16 14:45:53.127607 (MainThread): Partial parsing not enabled
2021-03-16 14:45:53.201796 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2021-03-16 14:45:53.228703 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2021-03-16 14:45:53.243553 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2021-03-16 14:45:53.256591 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2021-03-16 14:45:53.270804 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2021-03-16 14:45:53.286852 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2021-03-16 14:45:53.300616 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2021-03-16 14:45:53.314344 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2021-03-16 14:45:53.841471 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45bb5d38-b3dc-4ac0-bbcb-0384c05fa217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6c4390>]}
2021-03-16 14:45:53.951192 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 3 seed files, 0 sources, 0 exposures
2021-03-16 14:45:53.953797 (MainThread): 
2021-03-16 14:45:53.954237 (MainThread): Acquiring new postgres connection "master".
2021-03-16 14:45:53.964462 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dbttest1".
2021-03-16 14:45:53.980803 (ThreadPoolExecutor-0_0): Using postgres connection "list_dbttest1".
2021-03-16 14:45:53.980971 (ThreadPoolExecutor-0_0): On list_dbttest1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1"} */

    select distinct nspname from pg_namespace
  
2021-03-16 14:45:53.981069 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-16 14:45:54.027356 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.05 seconds
2021-03-16 14:45:54.030180 (ThreadPoolExecutor-0_0): On list_dbttest1: Close
2021-03-16 14:45:54.070747 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dbttest1_public".
2021-03-16 14:45:54.077349 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2021-03-16 14:45:54.090392 (ThreadPoolExecutor-1_0): On list_dbttest1_public: BEGIN
2021-03-16 14:45:54.090850 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-03-16 14:45:54.099268 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-03-16 14:45:54.099467 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2021-03-16 14:45:54.099583 (ThreadPoolExecutor-1_0): On list_dbttest1_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1_public"} */
select
      'dbttest1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbttest1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-03-16 14:45:54.118816 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.02 seconds
2021-03-16 14:45:54.119169 (ThreadPoolExecutor-1_0): On list_dbttest1_public: ROLLBACK
2021-03-16 14:45:54.120065 (ThreadPoolExecutor-1_0): On list_dbttest1_public: Close
2021-03-16 14:45:54.177484 (MainThread): Using postgres connection "master".
2021-03-16 14:45:54.177643 (MainThread): On master: BEGIN
2021-03-16 14:45:54.177739 (MainThread): Opening a new connection, currently in state init
2021-03-16 14:45:54.185172 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-03-16 14:45:54.185349 (MainThread): Using postgres connection "master".
2021-03-16 14:45:54.185448 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-03-16 14:45:54.211906 (MainThread): SQL status: SELECT 0 in 0.03 seconds
2021-03-16 14:45:54.212274 (MainThread): On master: ROLLBACK
2021-03-16 14:45:54.213481 (MainThread): Using postgres connection "master".
2021-03-16 14:45:54.213640 (MainThread): On master: BEGIN
2021-03-16 14:45:54.215499 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-03-16 14:45:54.215668 (MainThread): On master: COMMIT
2021-03-16 14:45:54.215772 (MainThread): Using postgres connection "master".
2021-03-16 14:45:54.215859 (MainThread): On master: COMMIT
2021-03-16 14:45:54.216712 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-03-16 14:45:54.216884 (MainThread): On master: Close
2021-03-16 14:45:54.217234 (MainThread): 10:45:54 | Concurrency: 1 threads (target='dev')
2021-03-16 14:45:54.217387 (MainThread): 10:45:54 | 
2021-03-16 14:45:54.219828 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-03-16 14:45:54.221601 (Thread-1): 10:45:54 | 1 of 8 START view model public.stg_orders............................ [RUN]
2021-03-16 14:45:54.221953 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2021-03-16 14:45:54.222161 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-03-16 14:45:54.247568 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-03-16 14:45:54.250225 (Thread-1): finished collecting timing info
2021-03-16 14:45:54.280534 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2021-03-16 14:45:54.280728 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbttest1"."public"."stg_orders__dbt_tmp" cascade
2021-03-16 14:45:54.280836 (Thread-1): Opening a new connection, currently in state closed
2021-03-16 14:45:54.292515 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-03-16 14:45:54.295406 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2021-03-16 14:45:54.295617 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbttest1"."public"."stg_orders__dbt_backup" cascade
2021-03-16 14:45:54.296858 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-03-16 14:45:54.302701 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-03-16 14:45:54.303220 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2021-03-16 14:45:54.303332 (Thread-1): On model.jaffle_shop.stg_orders: BEGIN
2021-03-16 14:45:54.304534 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-03-16 14:45:54.304801 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2021-03-16 14:45:54.304928 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "dbttest1"."public"."stg_orders__dbt_tmp" as (
    with source as (
    select * from "dbttest1"."public"."raw_orders"

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from renamed
  );

2021-03-16 14:45:54.307803 (Thread-1): Postgres error: relation "public.raw_orders" does not exist
LINE 5:     select * from "dbttest1"."public"."raw_orders"
                          ^

2021-03-16 14:45:54.307980 (Thread-1): On model.jaffle_shop.stg_orders: ROLLBACK
2021-03-16 14:45:54.308990 (Thread-1): finished collecting timing info
2021-03-16 14:45:54.309306 (Thread-1): On model.jaffle_shop.stg_orders: Close
2021-03-16 14:45:54.309720 (Thread-1): Database Error in model stg_orders (models/staging/stg_orders.sql)
  relation "public.raw_orders" does not exist
  LINE 5:     select * from "dbttest1"."public"."raw_orders"
                            ^
  compiled SQL at target/run/jaffle_shop/models/staging/stg_orders.sql
Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "public.raw_orders" does not exist
LINE 5:     select * from "dbttest1"."public"."raw_orders"
                          ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/naveen/.pyenv/versions/3.7.4/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model stg_orders (models/staging/stg_orders.sql)
  relation "public.raw_orders" does not exist
  LINE 5:     select * from "dbttest1"."public"."raw_orders"
                            ^
  compiled SQL at target/run/jaffle_shop/models/staging/stg_orders.sql
2021-03-16 14:45:54.316499 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45bb5d38-b3dc-4ac0-bbcb-0384c05fa217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10faeb450>]}
2021-03-16 14:45:54.317725 (Thread-1): 10:45:54 | 1 of 8 ERROR creating view model public.stg_orders................... [ERROR in 0.09s]
2021-03-16 14:45:54.317881 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-03-16 14:45:54.318030 (Thread-1): Began running node model.jaffle_shop.stg_payments
2021-03-16 14:45:54.319260 (Thread-1): 10:45:54 | 2 of 8 START view model public.stg_payments.......................... [RUN]
2021-03-16 14:45:54.319815 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2021-03-16 14:45:54.319973 (Thread-1): Compiling model.jaffle_shop.stg_payments
2021-03-16 14:45:54.330268 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-03-16 14:45:54.330803 (Thread-1): finished collecting timing info
2021-03-16 14:45:54.344119 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2021-03-16 14:45:54.344356 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbttest1"."public"."stg_payments__dbt_tmp" cascade
2021-03-16 14:45:54.344520 (Thread-1): Opening a new connection, currently in state closed
2021-03-16 14:45:54.362772 (Thread-1): SQL status: DROP VIEW in 0.02 seconds
2021-03-16 14:45:54.365853 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2021-03-16 14:45:54.366021 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbttest1"."public"."stg_payments__dbt_backup" cascade
2021-03-16 14:45:54.367356 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-03-16 14:45:54.368647 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2021-03-16 14:45:54.369243 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2021-03-16 14:45:54.369460 (Thread-1): On model.jaffle_shop.stg_payments: BEGIN
2021-03-16 14:45:54.371015 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-03-16 14:45:54.371269 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2021-03-16 14:45:54.371461 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "dbttest1"."public"."stg_payments__dbt_tmp" as (
    with source as (
    select * from "dbttest1"."public"."raw_payments"

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        --`amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed
  );

2021-03-16 14:45:54.376550 (Thread-1): Postgres error: relation "public.raw_payments" does not exist
LINE 5:     select * from "dbttest1"."public"."raw_payments"
                          ^

2021-03-16 14:45:54.376785 (Thread-1): On model.jaffle_shop.stg_payments: ROLLBACK
2021-03-16 14:45:54.378112 (Thread-1): finished collecting timing info
2021-03-16 14:45:54.378482 (Thread-1): On model.jaffle_shop.stg_payments: Close
2021-03-16 14:45:54.378872 (Thread-1): Database Error in model stg_payments (models/staging/stg_payments.sql)
  relation "public.raw_payments" does not exist
  LINE 5:     select * from "dbttest1"."public"."raw_payments"
                            ^
  compiled SQL at target/run/jaffle_shop/models/staging/stg_payments.sql
Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "public.raw_payments" does not exist
LINE 5:     select * from "dbttest1"."public"."raw_payments"
                          ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/naveen/.pyenv/versions/3.7.4/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model stg_payments (models/staging/stg_payments.sql)
  relation "public.raw_payments" does not exist
  LINE 5:     select * from "dbttest1"."public"."raw_payments"
                            ^
  compiled SQL at target/run/jaffle_shop/models/staging/stg_payments.sql
2021-03-16 14:45:54.380105 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45bb5d38-b3dc-4ac0-bbcb-0384c05fa217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fae7a50>]}
2021-03-16 14:45:54.381992 (Thread-1): 10:45:54 | 2 of 8 ERROR creating view model public.stg_payments................. [ERROR in 0.06s]
2021-03-16 14:45:54.382192 (Thread-1): Finished running node model.jaffle_shop.stg_payments
2021-03-16 14:45:54.382364 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-03-16 14:45:54.384562 (Thread-1): 10:45:54 | 3 of 8 START view model public.stg_customers......................... [RUN]
2021-03-16 14:45:54.385234 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2021-03-16 14:45:54.385418 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-03-16 14:45:54.397691 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-03-16 14:45:54.398207 (Thread-1): finished collecting timing info
2021-03-16 14:45:54.405727 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2021-03-16 14:45:54.405928 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbttest1"."public"."stg_customers__dbt_tmp" cascade
2021-03-16 14:45:54.406101 (Thread-1): Opening a new connection, currently in state closed
2021-03-16 14:45:54.414202 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-03-16 14:45:54.416759 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2021-03-16 14:45:54.416898 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbttest1"."public"."stg_customers__dbt_backup" cascade
2021-03-16 14:45:54.417884 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-03-16 14:45:54.419067 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-03-16 14:45:54.419567 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2021-03-16 14:45:54.419685 (Thread-1): On model.jaffle_shop.stg_customers: BEGIN
2021-03-16 14:45:54.421236 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-03-16 14:45:54.421408 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2021-03-16 14:45:54.421511 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "dbttest1"."public"."stg_customers__dbt_tmp" as (
    with source as (
    select * from "dbttest1"."public"."raw_customers"

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name,
        email

    from source

)

select * from renamed

--test customers
  );

2021-03-16 14:45:54.423066 (Thread-1): Postgres error: relation "public.raw_customers" does not exist
LINE 5:     select * from "dbttest1"."public"."raw_customers"
                          ^

2021-03-16 14:45:54.423246 (Thread-1): On model.jaffle_shop.stg_customers: ROLLBACK
2021-03-16 14:45:54.424304 (Thread-1): finished collecting timing info
2021-03-16 14:45:54.424666 (Thread-1): On model.jaffle_shop.stg_customers: Close
2021-03-16 14:45:54.425015 (Thread-1): Database Error in model stg_customers (models/staging/stg_customers.sql)
  relation "public.raw_customers" does not exist
  LINE 5:     select * from "dbttest1"."public"."raw_customers"
                            ^
  compiled SQL at target/run/jaffle_shop/models/staging/stg_customers.sql
Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "public.raw_customers" does not exist
LINE 5:     select * from "dbttest1"."public"."raw_customers"
                          ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/naveen/.pyenv/versions/3.7.4/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model stg_customers (models/staging/stg_customers.sql)
  relation "public.raw_customers" does not exist
  LINE 5:     select * from "dbttest1"."public"."raw_customers"
                            ^
  compiled SQL at target/run/jaffle_shop/models/staging/stg_customers.sql
2021-03-16 14:45:54.425614 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45bb5d38-b3dc-4ac0-bbcb-0384c05fa217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9fb410>]}
2021-03-16 14:45:54.426776 (Thread-1): 10:45:54 | 3 of 8 ERROR creating view model public.stg_customers................ [ERROR in 0.04s]
2021-03-16 14:45:54.426942 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-03-16 14:45:54.427088 (Thread-1): Began running node model.jaffle_shop.customer_orders
2021-03-16 14:45:54.427444 (Thread-1): 10:45:54 | 4 of 8 SKIP relation public.customer_orders.......................... [SKIP]
2021-03-16 14:45:54.427676 (Thread-1): Finished running node model.jaffle_shop.customer_orders
2021-03-16 14:45:54.427846 (Thread-1): Began running node model.jaffle_shop.customer_payments
2021-03-16 14:45:54.428020 (Thread-1): 10:45:54 | 5 of 8 SKIP relation public.customer_payments........................ [SKIP]
2021-03-16 14:45:54.428251 (Thread-1): Finished running node model.jaffle_shop.customer_payments
2021-03-16 14:45:54.428460 (Thread-1): Began running node model.jaffle_shop.order_payments
2021-03-16 14:45:54.428818 (Thread-1): 10:45:54 | 6 of 8 SKIP relation public.order_payments........................... [SKIP]
2021-03-16 14:45:54.429007 (Thread-1): Finished running node model.jaffle_shop.order_payments
2021-03-16 14:45:54.429211 (Thread-1): Began running node model.jaffle_shop.dim_customers
2021-03-16 14:45:54.429574 (Thread-1): 10:45:54 | 7 of 8 SKIP relation public.dim_customers............................ [SKIP]
2021-03-16 14:45:54.429796 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2021-03-16 14:45:54.430083 (Thread-1): Began running node model.jaffle_shop.fct_orders
2021-03-16 14:45:54.430339 (Thread-1): 10:45:54 | 8 of 8 SKIP relation public.fct_orders............................... [SKIP]
2021-03-16 14:45:54.430554 (Thread-1): Finished running node model.jaffle_shop.fct_orders
2021-03-16 14:45:54.431367 (MainThread): Acquiring new postgres connection "master".
2021-03-16 14:45:54.431598 (MainThread): Using postgres connection "master".
2021-03-16 14:45:54.431746 (MainThread): On master: BEGIN
2021-03-16 14:45:54.431875 (MainThread): Opening a new connection, currently in state closed
2021-03-16 14:45:54.440821 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-03-16 14:45:54.441123 (MainThread): On master: COMMIT
2021-03-16 14:45:54.441296 (MainThread): Using postgres connection "master".
2021-03-16 14:45:54.441421 (MainThread): On master: COMMIT
2021-03-16 14:45:54.442681 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-03-16 14:45:54.442886 (MainThread): On master: Close
2021-03-16 14:45:54.443382 (MainThread): 10:45:54 | 
2021-03-16 14:45:54.443622 (MainThread): 10:45:54 | Finished running 3 view models, 5 table models in 0.49s.
2021-03-16 14:45:54.443830 (MainThread): Connection 'master' was properly closed.
2021-03-16 14:45:54.443939 (MainThread): Connection 'model.jaffle_shop.stg_customers' was properly closed.
2021-03-16 14:45:54.542624 (MainThread): 
2021-03-16 14:45:54.542816 (MainThread): Completed with 3 errors and 0 warnings:
2021-03-16 14:45:54.542933 (MainThread): 
2021-03-16 14:45:54.543052 (MainThread): Database Error in model stg_orders (models/staging/stg_orders.sql)
2021-03-16 14:45:54.543163 (MainThread):   relation "public.raw_orders" does not exist
2021-03-16 14:45:54.543261 (MainThread):   LINE 5:     select * from "dbttest1"."public"."raw_orders"
2021-03-16 14:45:54.543374 (MainThread):                             ^
2021-03-16 14:45:54.543521 (MainThread):   compiled SQL at target/run/jaffle_shop/models/staging/stg_orders.sql
2021-03-16 14:45:54.543713 (MainThread): 
2021-03-16 14:45:54.543977 (MainThread): Database Error in model stg_payments (models/staging/stg_payments.sql)
2021-03-16 14:45:54.544094 (MainThread):   relation "public.raw_payments" does not exist
2021-03-16 14:45:54.544190 (MainThread):   LINE 5:     select * from "dbttest1"."public"."raw_payments"
2021-03-16 14:45:54.544294 (MainThread):                             ^
2021-03-16 14:45:54.544413 (MainThread):   compiled SQL at target/run/jaffle_shop/models/staging/stg_payments.sql
2021-03-16 14:45:54.544549 (MainThread): 
2021-03-16 14:45:54.544659 (MainThread): Database Error in model stg_customers (models/staging/stg_customers.sql)
2021-03-16 14:45:54.544753 (MainThread):   relation "public.raw_customers" does not exist
2021-03-16 14:45:54.544842 (MainThread):   LINE 5:     select * from "dbttest1"."public"."raw_customers"
2021-03-16 14:45:54.544943 (MainThread):                             ^
2021-03-16 14:45:54.545068 (MainThread):   compiled SQL at target/run/jaffle_shop/models/staging/stg_customers.sql
2021-03-16 14:45:54.545181 (MainThread): 
Done. PASS=0 WARN=0 ERROR=3 SKIP=5 TOTAL=8
2021-03-16 14:45:54.545350 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10facaf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb74950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5de8d0>]}
2021-03-16 14:45:54.545543 (MainThread): Flushing usage events
2021-03-16 14:45:58.294579 (MainThread): Running with dbt=0.19.0
2021-03-16 14:45:58.364726 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', selector_name=None, show=False, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-03-16 14:45:58.365678 (MainThread): Tracking: tracking
2021-03-16 14:45:58.385504 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4c1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4c1b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4d2350>]}
2021-03-16 14:45:58.411166 (MainThread): Partial parsing not enabled
2021-03-16 14:45:58.412275 (MainThread): Parsing macros/catalog.sql
2021-03-16 14:45:58.415980 (MainThread): Parsing macros/relations.sql
2021-03-16 14:45:58.417650 (MainThread): Parsing macros/adapters.sql
2021-03-16 14:45:58.441303 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-03-16 14:45:58.444728 (MainThread): Parsing macros/core.sql
2021-03-16 14:45:58.449605 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-16 14:45:58.460380 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-16 14:45:58.462571 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-16 14:45:58.486271 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-16 14:45:58.526161 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-16 14:45:58.551303 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-16 14:45:58.553532 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-16 14:45:58.561340 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-16 14:45:58.578085 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-16 14:45:58.587242 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-16 14:45:58.595843 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-16 14:45:58.602070 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-16 14:45:58.603273 (MainThread): Parsing macros/etc/query.sql
2021-03-16 14:45:58.604689 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-16 14:45:58.606999 (MainThread): Parsing macros/etc/datetime.sql
2021-03-16 14:45:58.618230 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-16 14:45:58.620756 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-16 14:45:58.623114 (MainThread): Parsing macros/adapters/common.sql
2021-03-16 14:45:58.682344 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-16 14:45:58.684747 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-16 14:45:58.686636 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-16 14:45:58.688787 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-16 14:45:58.698187 (MainThread): Partial parsing not enabled
2021-03-16 14:45:58.763177 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2021-03-16 14:45:58.790229 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2021-03-16 14:45:58.803708 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2021-03-16 14:45:58.816642 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2021-03-16 14:45:58.830832 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2021-03-16 14:45:58.845405 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2021-03-16 14:45:58.858405 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2021-03-16 14:45:58.871236 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2021-03-16 14:45:59.392859 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6d69041-5ce9-450c-b10f-47c34560471c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e923650>]}
2021-03-16 14:45:59.501735 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 3 seed files, 0 sources, 0 exposures
2021-03-16 14:45:59.504858 (MainThread): 
2021-03-16 14:45:59.505352 (MainThread): Acquiring new postgres connection "master".
2021-03-16 14:45:59.509925 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dbttest1".
2021-03-16 14:45:59.522181 (ThreadPoolExecutor-0_0): Using postgres connection "list_dbttest1".
2021-03-16 14:45:59.522333 (ThreadPoolExecutor-0_0): On list_dbttest1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1"} */

    select distinct nspname from pg_namespace
  
2021-03-16 14:45:59.522468 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-16 14:45:59.531355 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-03-16 14:45:59.533686 (ThreadPoolExecutor-0_0): On list_dbttest1: Close
2021-03-16 14:45:59.573804 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dbttest1_public".
2021-03-16 14:45:59.580264 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2021-03-16 14:45:59.580419 (ThreadPoolExecutor-1_0): On list_dbttest1_public: BEGIN
2021-03-16 14:45:59.580517 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-03-16 14:45:59.586832 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-03-16 14:45:59.587008 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2021-03-16 14:45:59.587147 (ThreadPoolExecutor-1_0): On list_dbttest1_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1_public"} */
select
      'dbttest1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbttest1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-03-16 14:45:59.590263 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.00 seconds
2021-03-16 14:45:59.590594 (ThreadPoolExecutor-1_0): On list_dbttest1_public: ROLLBACK
2021-03-16 14:45:59.591357 (ThreadPoolExecutor-1_0): On list_dbttest1_public: Close
2021-03-16 14:45:59.636057 (MainThread): Using postgres connection "master".
2021-03-16 14:45:59.636210 (MainThread): On master: BEGIN
2021-03-16 14:45:59.636342 (MainThread): Opening a new connection, currently in state init
2021-03-16 14:45:59.648204 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-03-16 14:45:59.648446 (MainThread): Using postgres connection "master".
2021-03-16 14:45:59.648578 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-03-16 14:45:59.655703 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-03-16 14:45:59.656091 (MainThread): On master: ROLLBACK
2021-03-16 14:45:59.657309 (MainThread): Using postgres connection "master".
2021-03-16 14:45:59.657457 (MainThread): On master: BEGIN
2021-03-16 14:45:59.658947 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-03-16 14:45:59.659116 (MainThread): On master: COMMIT
2021-03-16 14:45:59.659225 (MainThread): Using postgres connection "master".
2021-03-16 14:45:59.659313 (MainThread): On master: COMMIT
2021-03-16 14:45:59.660145 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-03-16 14:45:59.660296 (MainThread): On master: Close
2021-03-16 14:45:59.660597 (MainThread): 10:45:59 | Concurrency: 1 threads (target='dev')
2021-03-16 14:45:59.660753 (MainThread): 10:45:59 | 
2021-03-16 14:45:59.662023 (Thread-1): Began running node seed.jaffle_shop.raw_customers
2021-03-16 14:45:59.663234 (Thread-1): 10:45:59 | 1 of 3 START seed file public.raw_customers.......................... [RUN]
2021-03-16 14:45:59.663668 (Thread-1): Acquiring new postgres connection "seed.jaffle_shop.raw_customers".
2021-03-16 14:45:59.663903 (Thread-1): finished collecting timing info
2021-03-16 14:45:59.705126 (Thread-1): * Deprecation Warning: The quote_columns parameter was not set for seeds, so the
default value of False was chosen. The default will change to True in a future
release.

For more information, see:
https://docs.getdbt.com/v0.15/docs/seeds#section-specify-column-quoting
2021-03-16 14:45:59.705344 (Thread-1): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b6d69041-5ce9-450c-b10f-47c34560471c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9fe410>]}
2021-03-16 14:45:59.705927 (Thread-1): Using postgres connection "seed.jaffle_shop.raw_customers".
2021-03-16 14:45:59.706087 (Thread-1): On seed.jaffle_shop.raw_customers: BEGIN
2021-03-16 14:45:59.706191 (Thread-1): Opening a new connection, currently in state closed
2021-03-16 14:45:59.714494 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-03-16 14:45:59.714710 (Thread-1): Using postgres connection "seed.jaffle_shop.raw_customers".
2021-03-16 14:45:59.714815 (Thread-1): On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */

    create table "dbttest1"."public"."raw_customers" (id integer,first_name text,last_name text,email text)
  
2021-03-16 14:45:59.731776 (Thread-1): SQL status: CREATE TABLE in 0.02 seconds
2021-03-16 14:45:59.751012 (Thread-1): Using postgres connection "seed.jaffle_shop.raw_customers".
2021-03-16 14:45:59.751170 (Thread-1): On seed.jaffle_shop.raw_customers: 
            insert into "dbttest1"."public"."raw_customers" (id, first_name, last_name, email) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%...
2021-03-16 14:45:59.755623 (Thread-1): SQL status: INSERT 0 100 in 0.00 seconds
2021-03-16 14:45:59.760786 (Thread-1): Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
2021-03-16 14:45:59.772349 (Thread-1): On seed.jaffle_shop.raw_customers: COMMIT
2021-03-16 14:45:59.772550 (Thread-1): Using postgres connection "seed.jaffle_shop.raw_customers".
2021-03-16 14:45:59.772661 (Thread-1): On seed.jaffle_shop.raw_customers: COMMIT
2021-03-16 14:45:59.780234 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-03-16 14:45:59.782977 (Thread-1): finished collecting timing info
2021-03-16 14:45:59.783265 (Thread-1): On seed.jaffle_shop.raw_customers: Close
2021-03-16 14:45:59.783930 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6d69041-5ce9-450c-b10f-47c34560471c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9eec50>]}
2021-03-16 14:45:59.784191 (Thread-1): 10:45:59 | 1 of 3 OK loaded seed file public.raw_customers...................... [INSERT 100 in 0.12s]
2021-03-16 14:45:59.784340 (Thread-1): Finished running node seed.jaffle_shop.raw_customers
2021-03-16 14:45:59.784487 (Thread-1): Began running node seed.jaffle_shop.raw_orders
2021-03-16 14:45:59.785838 (Thread-1): 10:45:59 | 2 of 3 START seed file public.raw_orders............................. [RUN]
2021-03-16 14:45:59.786268 (Thread-1): Acquiring new postgres connection "seed.jaffle_shop.raw_orders".
2021-03-16 14:45:59.786475 (Thread-1): finished collecting timing info
2021-03-16 14:45:59.796966 (Thread-1): Using postgres connection "seed.jaffle_shop.raw_orders".
2021-03-16 14:45:59.797194 (Thread-1): On seed.jaffle_shop.raw_orders: BEGIN
2021-03-16 14:45:59.797436 (Thread-1): Opening a new connection, currently in state closed
2021-03-16 14:45:59.804493 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-03-16 14:45:59.804663 (Thread-1): Using postgres connection "seed.jaffle_shop.raw_orders".
2021-03-16 14:45:59.804756 (Thread-1): On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */

    create table "dbttest1"."public"."raw_orders" (id integer,user_id integer,order_date date,status text)
  
2021-03-16 14:45:59.808379 (Thread-1): SQL status: CREATE TABLE in 0.00 seconds
2021-03-16 14:45:59.812001 (Thread-1): Using postgres connection "seed.jaffle_shop.raw_orders".
2021-03-16 14:45:59.812142 (Thread-1): On seed.jaffle_shop.raw_orders: 
            insert into "dbttest1"."public"."raw_orders" (id, user_id, order_date, status) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s...
2021-03-16 14:45:59.815889 (Thread-1): SQL status: INSERT 0 99 in 0.00 seconds
2021-03-16 14:45:59.816291 (Thread-1): Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
2021-03-16 14:45:59.819375 (Thread-1): On seed.jaffle_shop.raw_orders: COMMIT
2021-03-16 14:45:59.819544 (Thread-1): Using postgres connection "seed.jaffle_shop.raw_orders".
2021-03-16 14:45:59.819689 (Thread-1): On seed.jaffle_shop.raw_orders: COMMIT
2021-03-16 14:45:59.827173 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-03-16 14:45:59.829269 (Thread-1): finished collecting timing info
2021-03-16 14:45:59.829650 (Thread-1): On seed.jaffle_shop.raw_orders: Close
2021-03-16 14:45:59.830461 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6d69041-5ce9-450c-b10f-47c34560471c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e931590>]}
2021-03-16 14:45:59.830737 (Thread-1): 10:45:59 | 2 of 3 OK loaded seed file public.raw_orders......................... [INSERT 99 in 0.04s]
2021-03-16 14:45:59.830887 (Thread-1): Finished running node seed.jaffle_shop.raw_orders
2021-03-16 14:45:59.831123 (Thread-1): Began running node seed.jaffle_shop.raw_payments
2021-03-16 14:45:59.832870 (Thread-1): 10:45:59 | 3 of 3 START seed file public.raw_payments........................... [RUN]
2021-03-16 14:45:59.833468 (Thread-1): Acquiring new postgres connection "seed.jaffle_shop.raw_payments".
2021-03-16 14:45:59.833693 (Thread-1): finished collecting timing info
2021-03-16 14:45:59.842870 (Thread-1): Using postgres connection "seed.jaffle_shop.raw_payments".
2021-03-16 14:45:59.843025 (Thread-1): On seed.jaffle_shop.raw_payments: BEGIN
2021-03-16 14:45:59.843117 (Thread-1): Opening a new connection, currently in state closed
2021-03-16 14:45:59.850922 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-03-16 14:45:59.851095 (Thread-1): Using postgres connection "seed.jaffle_shop.raw_payments".
2021-03-16 14:45:59.851190 (Thread-1): On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */

    create table "dbttest1"."public"."raw_payments" (id integer,order_id integer,payment_method text,amount integer)
  
2021-03-16 14:45:59.853978 (Thread-1): SQL status: CREATE TABLE in 0.00 seconds
2021-03-16 14:45:59.858186 (Thread-1): Using postgres connection "seed.jaffle_shop.raw_payments".
2021-03-16 14:45:59.858344 (Thread-1): On seed.jaffle_shop.raw_payments: 
            insert into "dbttest1"."public"."raw_payments" (id, order_id, payment_method, amount) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%...
2021-03-16 14:45:59.861201 (Thread-1): SQL status: INSERT 0 113 in 0.00 seconds
2021-03-16 14:45:59.861573 (Thread-1): Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
2021-03-16 14:45:59.864568 (Thread-1): On seed.jaffle_shop.raw_payments: COMMIT
2021-03-16 14:45:59.864720 (Thread-1): Using postgres connection "seed.jaffle_shop.raw_payments".
2021-03-16 14:45:59.864806 (Thread-1): On seed.jaffle_shop.raw_payments: COMMIT
2021-03-16 14:45:59.866437 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-03-16 14:45:59.868197 (Thread-1): finished collecting timing info
2021-03-16 14:45:59.868432 (Thread-1): On seed.jaffle_shop.raw_payments: Close
2021-03-16 14:45:59.869000 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6d69041-5ce9-450c-b10f-47c34560471c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea5d0d0>]}
2021-03-16 14:45:59.869245 (Thread-1): 10:45:59 | 3 of 3 OK loaded seed file public.raw_payments....................... [INSERT 113 in 0.04s]
2021-03-16 14:45:59.869389 (Thread-1): Finished running node seed.jaffle_shop.raw_payments
2021-03-16 14:45:59.873111 (MainThread): Acquiring new postgres connection "master".
2021-03-16 14:45:59.873322 (MainThread): Using postgres connection "master".
2021-03-16 14:45:59.873485 (MainThread): On master: BEGIN
2021-03-16 14:45:59.873591 (MainThread): Opening a new connection, currently in state closed
2021-03-16 14:45:59.880720 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-03-16 14:45:59.880947 (MainThread): On master: COMMIT
2021-03-16 14:45:59.881083 (MainThread): Using postgres connection "master".
2021-03-16 14:45:59.881172 (MainThread): On master: COMMIT
2021-03-16 14:45:59.882216 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-03-16 14:45:59.882403 (MainThread): On master: Close
2021-03-16 14:45:59.882770 (MainThread): 10:45:59 | 
2021-03-16 14:45:59.882917 (MainThread): 10:45:59 | Finished running 3 seeds in 0.38s.
2021-03-16 14:45:59.883052 (MainThread): Connection 'master' was properly closed.
2021-03-16 14:45:59.883167 (MainThread): Connection 'seed.jaffle_shop.raw_payments' was properly closed.
2021-03-16 14:45:59.977432 (MainThread): 
2021-03-16 14:45:59.977615 (MainThread): Completed successfully
2021-03-16 14:45:59.977735 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-03-16 14:45:59.977904 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0dc310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6a8850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea58c10>]}
2021-03-16 14:45:59.978085 (MainThread): Flushing usage events
2021-03-16 14:46:47.668545 (MainThread): Running with dbt=0.19.0
2021-03-16 14:46:47.738646 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-16 14:46:47.739848 (MainThread): Tracking: tracking
2021-03-16 14:46:47.766360 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081b1050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081c23d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081c2050>]}
2021-03-16 14:46:47.792210 (MainThread): Partial parsing not enabled
2021-03-16 14:46:47.793305 (MainThread): Parsing macros/catalog.sql
2021-03-16 14:46:47.796903 (MainThread): Parsing macros/relations.sql
2021-03-16 14:46:47.798684 (MainThread): Parsing macros/adapters.sql
2021-03-16 14:46:47.824358 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-03-16 14:46:47.827992 (MainThread): Parsing macros/core.sql
2021-03-16 14:46:47.832865 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-16 14:46:47.843713 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-16 14:46:47.845955 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-16 14:46:47.869570 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-16 14:46:47.911363 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-16 14:46:47.936363 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-16 14:46:47.938791 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-16 14:46:47.946467 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-16 14:46:47.963051 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-16 14:46:47.971400 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-16 14:46:47.979103 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-16 14:46:47.985033 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-16 14:46:47.986185 (MainThread): Parsing macros/etc/query.sql
2021-03-16 14:46:47.987473 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-16 14:46:47.989592 (MainThread): Parsing macros/etc/datetime.sql
2021-03-16 14:46:48.000103 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-16 14:46:48.002471 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-16 14:46:48.004548 (MainThread): Parsing macros/adapters/common.sql
2021-03-16 14:46:48.057246 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-16 14:46:48.059544 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-16 14:46:48.061349 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-16 14:46:48.063385 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-16 14:46:48.072965 (MainThread): Partial parsing not enabled
2021-03-16 14:46:48.139272 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2021-03-16 14:46:48.163867 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2021-03-16 14:46:48.177743 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2021-03-16 14:46:48.190352 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2021-03-16 14:46:48.204169 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2021-03-16 14:46:48.218441 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2021-03-16 14:46:48.231263 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2021-03-16 14:46:48.246296 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2021-03-16 14:46:48.791528 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f83ff68-c9a2-4f92-bc8d-dea1415f2834', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10821edd0>]}
2021-03-16 14:46:48.899702 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 3 seed files, 0 sources, 0 exposures
2021-03-16 14:46:48.903466 (MainThread): 
2021-03-16 14:46:48.904086 (MainThread): Acquiring new postgres connection "master".
2021-03-16 14:46:48.915781 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dbttest1".
2021-03-16 14:46:48.928620 (ThreadPoolExecutor-0_0): Using postgres connection "list_dbttest1".
2021-03-16 14:46:48.928791 (ThreadPoolExecutor-0_0): On list_dbttest1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1"} */

    select distinct nspname from pg_namespace
  
2021-03-16 14:46:48.928891 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-16 14:46:48.937463 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-03-16 14:46:48.940443 (ThreadPoolExecutor-0_0): On list_dbttest1: Close
2021-03-16 14:46:48.983952 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dbttest1_public".
2021-03-16 14:46:48.990683 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2021-03-16 14:46:48.990866 (ThreadPoolExecutor-1_0): On list_dbttest1_public: BEGIN
2021-03-16 14:46:48.991024 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-03-16 14:46:48.997539 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-03-16 14:46:48.997718 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2021-03-16 14:46:48.997846 (ThreadPoolExecutor-1_0): On list_dbttest1_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1_public"} */
select
      'dbttest1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbttest1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-03-16 14:46:49.000746 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.00 seconds
2021-03-16 14:46:49.003693 (ThreadPoolExecutor-1_0): On list_dbttest1_public: ROLLBACK
2021-03-16 14:46:49.004755 (ThreadPoolExecutor-1_0): On list_dbttest1_public: Close
2021-03-16 14:46:49.049277 (MainThread): Using postgres connection "master".
2021-03-16 14:46:49.049429 (MainThread): On master: BEGIN
2021-03-16 14:46:49.049526 (MainThread): Opening a new connection, currently in state init
2021-03-16 14:46:49.056352 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-03-16 14:46:49.056529 (MainThread): Using postgres connection "master".
2021-03-16 14:46:49.056629 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-03-16 14:46:49.062659 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-03-16 14:46:49.063172 (MainThread): On master: ROLLBACK
2021-03-16 14:46:49.064601 (MainThread): Using postgres connection "master".
2021-03-16 14:46:49.064786 (MainThread): On master: BEGIN
2021-03-16 14:46:49.066850 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-03-16 14:46:49.067027 (MainThread): On master: COMMIT
2021-03-16 14:46:49.067133 (MainThread): Using postgres connection "master".
2021-03-16 14:46:49.067223 (MainThread): On master: COMMIT
2021-03-16 14:46:49.068166 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-03-16 14:46:49.068327 (MainThread): On master: Close
2021-03-16 14:46:49.068631 (MainThread): 10:46:49 | Concurrency: 1 threads (target='dev')
2021-03-16 14:46:49.068776 (MainThread): 10:46:49 | 
2021-03-16 14:46:49.070294 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-03-16 14:46:49.071884 (Thread-1): 10:46:49 | 1 of 8 START view model public.stg_orders............................ [RUN]
2021-03-16 14:46:49.072375 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2021-03-16 14:46:49.072599 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-03-16 14:46:49.093381 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-03-16 14:46:49.093878 (Thread-1): finished collecting timing info
2021-03-16 14:46:49.123457 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2021-03-16 14:46:49.123625 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbttest1"."public"."stg_orders__dbt_tmp" cascade
2021-03-16 14:46:49.123724 (Thread-1): Opening a new connection, currently in state closed
2021-03-16 14:46:49.130743 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-03-16 14:46:49.133229 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2021-03-16 14:46:49.133371 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbttest1"."public"."stg_orders__dbt_backup" cascade
2021-03-16 14:46:49.134496 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-03-16 14:46:49.139678 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-03-16 14:46:49.140175 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2021-03-16 14:46:49.140280 (Thread-1): On model.jaffle_shop.stg_orders: BEGIN
2021-03-16 14:46:49.141580 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-03-16 14:46:49.141739 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2021-03-16 14:46:49.141833 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "dbttest1"."public"."stg_orders__dbt_tmp" as (
    with source as (
    select * from "dbttest1"."public"."raw_orders"

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from renamed
  );

2021-03-16 14:46:49.148727 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-03-16 14:46:49.155449 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2021-03-16 14:46:49.155599 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
alter table "dbttest1"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
2021-03-16 14:46:49.158737 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-03-16 14:46:49.165846 (Thread-1): On model.jaffle_shop.stg_orders: COMMIT
2021-03-16 14:46:49.166008 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2021-03-16 14:46:49.166104 (Thread-1): On model.jaffle_shop.stg_orders: COMMIT
2021-03-16 14:46:49.169509 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-03-16 14:46:49.173172 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2021-03-16 14:46:49.173350 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbttest1"."public"."stg_orders__dbt_backup" cascade
2021-03-16 14:46:49.174556 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-03-16 14:46:49.177754 (Thread-1): finished collecting timing info
2021-03-16 14:46:49.178025 (Thread-1): On model.jaffle_shop.stg_orders: Close
2021-03-16 14:46:49.178554 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f83ff68-c9a2-4f92-bc8d-dea1415f2834', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086f56d0>]}
2021-03-16 14:46:49.179636 (Thread-1): 10:46:49 | 1 of 8 OK created view model public.stg_orders....................... [CREATE VIEW in 0.11s]
2021-03-16 14:46:49.179797 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-03-16 14:46:49.179938 (Thread-1): Began running node model.jaffle_shop.stg_payments
2021-03-16 14:46:49.181196 (Thread-1): 10:46:49 | 2 of 8 START view model public.stg_payments.......................... [RUN]
2021-03-16 14:46:49.181615 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2021-03-16 14:46:49.181758 (Thread-1): Compiling model.jaffle_shop.stg_payments
2021-03-16 14:46:49.190149 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-03-16 14:46:49.190704 (Thread-1): finished collecting timing info
2021-03-16 14:46:49.197780 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2021-03-16 14:46:49.197927 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbttest1"."public"."stg_payments__dbt_tmp" cascade
2021-03-16 14:46:49.198021 (Thread-1): Opening a new connection, currently in state closed
2021-03-16 14:46:49.204697 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-03-16 14:46:49.207462 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2021-03-16 14:46:49.207619 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbttest1"."public"."stg_payments__dbt_backup" cascade
2021-03-16 14:46:49.208645 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-03-16 14:46:49.209722 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2021-03-16 14:46:49.210159 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2021-03-16 14:46:49.210260 (Thread-1): On model.jaffle_shop.stg_payments: BEGIN
2021-03-16 14:46:49.211220 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-03-16 14:46:49.211357 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2021-03-16 14:46:49.211451 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "dbttest1"."public"."stg_payments__dbt_tmp" as (
    with source as (
    select * from "dbttest1"."public"."raw_payments"

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        --`amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed
  );

2021-03-16 14:46:49.214909 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-03-16 14:46:49.217451 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2021-03-16 14:46:49.217589 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbttest1"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
2021-03-16 14:46:49.218701 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-03-16 14:46:49.219767 (Thread-1): On model.jaffle_shop.stg_payments: COMMIT
2021-03-16 14:46:49.219886 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2021-03-16 14:46:49.219978 (Thread-1): On model.jaffle_shop.stg_payments: COMMIT
2021-03-16 14:46:49.223335 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-03-16 14:46:49.225087 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2021-03-16 14:46:49.225214 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbttest1"."public"."stg_payments__dbt_backup" cascade
2021-03-16 14:46:49.226273 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-03-16 14:46:49.228677 (Thread-1): finished collecting timing info
2021-03-16 14:46:49.228921 (Thread-1): On model.jaffle_shop.stg_payments: Close
2021-03-16 14:46:49.229417 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f83ff68-c9a2-4f92-bc8d-dea1415f2834', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086f5390>]}
2021-03-16 14:46:49.230507 (Thread-1): 10:46:49 | 2 of 8 OK created view model public.stg_payments..................... [CREATE VIEW in 0.05s]
2021-03-16 14:46:49.230719 (Thread-1): Finished running node model.jaffle_shop.stg_payments
2021-03-16 14:46:49.230890 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-03-16 14:46:49.232646 (Thread-1): 10:46:49 | 3 of 8 START view model public.stg_customers......................... [RUN]
2021-03-16 14:46:49.233405 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2021-03-16 14:46:49.233599 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-03-16 14:46:49.243905 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-03-16 14:46:49.244421 (Thread-1): finished collecting timing info
2021-03-16 14:46:49.255143 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2021-03-16 14:46:49.255371 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbttest1"."public"."stg_customers__dbt_tmp" cascade
2021-03-16 14:46:49.255540 (Thread-1): Opening a new connection, currently in state closed
2021-03-16 14:46:49.265813 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-03-16 14:46:49.268580 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2021-03-16 14:46:49.268732 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbttest1"."public"."stg_customers__dbt_backup" cascade
2021-03-16 14:46:49.269684 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-03-16 14:46:49.270909 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-03-16 14:46:49.271432 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2021-03-16 14:46:49.271547 (Thread-1): On model.jaffle_shop.stg_customers: BEGIN
2021-03-16 14:46:49.272864 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-03-16 14:46:49.273018 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2021-03-16 14:46:49.273161 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "dbttest1"."public"."stg_customers__dbt_tmp" as (
    with source as (
    select * from "dbttest1"."public"."raw_customers"

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name,
        email

    from source

)

select * from renamed

--test customers
  );

2021-03-16 14:46:49.277377 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-03-16 14:46:49.279901 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2021-03-16 14:46:49.280030 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbttest1"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
2021-03-16 14:46:49.281310 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-03-16 14:46:49.282387 (Thread-1): On model.jaffle_shop.stg_customers: COMMIT
2021-03-16 14:46:49.282507 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2021-03-16 14:46:49.282593 (Thread-1): On model.jaffle_shop.stg_customers: COMMIT
2021-03-16 14:46:49.284701 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-03-16 14:46:49.286525 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2021-03-16 14:46:49.286638 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbttest1"."public"."stg_customers__dbt_backup" cascade
2021-03-16 14:46:49.287801 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-03-16 14:46:49.290389 (Thread-1): finished collecting timing info
2021-03-16 14:46:49.290693 (Thread-1): On model.jaffle_shop.stg_customers: Close
2021-03-16 14:46:49.291258 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f83ff68-c9a2-4f92-bc8d-dea1415f2834', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086cacd0>]}
2021-03-16 14:46:49.292387 (Thread-1): 10:46:49 | 3 of 8 OK created view model public.stg_customers.................... [CREATE VIEW in 0.06s]
2021-03-16 14:46:49.292550 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-03-16 14:46:49.292691 (Thread-1): Began running node model.jaffle_shop.customer_orders
2021-03-16 14:46:49.293908 (Thread-1): 10:46:49 | 4 of 8 START table model public.customer_orders...................... [RUN]
2021-03-16 14:46:49.294233 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2021-03-16 14:46:49.294357 (Thread-1): Compiling model.jaffle_shop.customer_orders
2021-03-16 14:46:49.301348 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customer_orders"
2021-03-16 14:46:49.301818 (Thread-1): finished collecting timing info
2021-03-16 14:46:49.325823 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-03-16 14:46:49.326018 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
drop table if exists "dbttest1"."public"."customer_orders__dbt_tmp" cascade
2021-03-16 14:46:49.326113 (Thread-1): Opening a new connection, currently in state closed
2021-03-16 14:46:49.334006 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-03-16 14:46:49.336450 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-03-16 14:46:49.336589 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
drop table if exists "dbttest1"."public"."customer_orders__dbt_backup" cascade
2021-03-16 14:46:49.337872 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-03-16 14:46:49.344525 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customer_orders"
2021-03-16 14:46:49.345055 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-03-16 14:46:49.345165 (Thread-1): On model.jaffle_shop.customer_orders: BEGIN
2021-03-16 14:46:49.346405 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-03-16 14:46:49.346548 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-03-16 14:46:49.346644 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */


  create  table "dbttest1"."public"."customer_orders__dbt_tmp"
  as (
    with orders as (

    select * from "dbttest1"."public"."stg_orders"

),

final as (

    select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by 1

)

select * from final
  );
2021-03-16 14:46:49.350748 (Thread-1): SQL status: SELECT 62 in 0.00 seconds
2021-03-16 14:46:49.353240 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-03-16 14:46:49.353387 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
alter table "dbttest1"."public"."customer_orders__dbt_tmp" rename to "customer_orders"
2021-03-16 14:46:49.354652 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-03-16 14:46:49.356016 (Thread-1): On model.jaffle_shop.customer_orders: COMMIT
2021-03-16 14:46:49.356179 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-03-16 14:46:49.356273 (Thread-1): On model.jaffle_shop.customer_orders: COMMIT
2021-03-16 14:46:49.359833 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-03-16 14:46:49.362570 (Thread-1): Using postgres connection "model.jaffle_shop.customer_orders".
2021-03-16 14:46:49.362717 (Thread-1): On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
drop table if exists "dbttest1"."public"."customer_orders__dbt_backup" cascade
2021-03-16 14:46:49.364020 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-03-16 14:46:49.366496 (Thread-1): finished collecting timing info
2021-03-16 14:46:49.366782 (Thread-1): On model.jaffle_shop.customer_orders: Close
2021-03-16 14:46:49.367478 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f83ff68-c9a2-4f92-bc8d-dea1415f2834', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108775b10>]}
2021-03-16 14:46:49.368634 (Thread-1): 10:46:49 | 4 of 8 OK created table model public.customer_orders................. [SELECT 62 in 0.07s]
2021-03-16 14:46:49.368801 (Thread-1): Finished running node model.jaffle_shop.customer_orders
2021-03-16 14:46:49.368974 (Thread-1): Began running node model.jaffle_shop.customer_payments
2021-03-16 14:46:49.370163 (Thread-1): 10:46:49 | 5 of 8 START table model public.customer_payments.................... [RUN]
2021-03-16 14:46:49.370602 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2021-03-16 14:46:49.370771 (Thread-1): Compiling model.jaffle_shop.customer_payments
2021-03-16 14:46:49.380346 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customer_payments"
2021-03-16 14:46:49.380782 (Thread-1): finished collecting timing info
2021-03-16 14:46:49.387664 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2021-03-16 14:46:49.387813 (Thread-1): On model.jaffle_shop.customer_payments: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_payments"} */
drop table if exists "dbttest1"."public"."customer_payments__dbt_tmp" cascade
2021-03-16 14:46:49.387911 (Thread-1): Opening a new connection, currently in state closed
2021-03-16 14:46:49.394762 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-03-16 14:46:49.397285 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2021-03-16 14:46:49.397416 (Thread-1): On model.jaffle_shop.customer_payments: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_payments"} */
drop table if exists "dbttest1"."public"."customer_payments__dbt_backup" cascade
2021-03-16 14:46:49.398394 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-03-16 14:46:49.399563 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customer_payments"
2021-03-16 14:46:49.400050 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2021-03-16 14:46:49.400156 (Thread-1): On model.jaffle_shop.customer_payments: BEGIN
2021-03-16 14:46:49.401594 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-03-16 14:46:49.401746 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2021-03-16 14:46:49.401836 (Thread-1): On model.jaffle_shop.customer_payments: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_payments"} */


  create  table "dbttest1"."public"."customer_payments__dbt_tmp"
  as (
    with payments as (

    select * from "dbttest1"."public"."stg_payments"

),

orders as (

    select * from "dbttest1"."public"."stg_orders"

),

final as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders using (order_id)

    group by 1

)

select * from final
  );
2021-03-16 14:46:49.405045 (Thread-1): SQL status: SELECT 62 in 0.00 seconds
2021-03-16 14:46:49.407701 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2021-03-16 14:46:49.407859 (Thread-1): On model.jaffle_shop.customer_payments: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_payments"} */
alter table "dbttest1"."public"."customer_payments__dbt_tmp" rename to "customer_payments"
2021-03-16 14:46:49.409154 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-03-16 14:46:49.410319 (Thread-1): On model.jaffle_shop.customer_payments: COMMIT
2021-03-16 14:46:49.410450 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2021-03-16 14:46:49.410542 (Thread-1): On model.jaffle_shop.customer_payments: COMMIT
2021-03-16 14:46:49.412146 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-03-16 14:46:49.413861 (Thread-1): Using postgres connection "model.jaffle_shop.customer_payments".
2021-03-16 14:46:49.413977 (Thread-1): On model.jaffle_shop.customer_payments: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_payments"} */
drop table if exists "dbttest1"."public"."customer_payments__dbt_backup" cascade
2021-03-16 14:46:49.414896 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-03-16 14:46:49.417393 (Thread-1): finished collecting timing info
2021-03-16 14:46:49.417652 (Thread-1): On model.jaffle_shop.customer_payments: Close
2021-03-16 14:46:49.418219 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f83ff68-c9a2-4f92-bc8d-dea1415f2834', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082e07d0>]}
2021-03-16 14:46:49.419285 (Thread-1): 10:46:49 | 5 of 8 OK created table model public.customer_payments............... [SELECT 62 in 0.05s]
2021-03-16 14:46:49.419440 (Thread-1): Finished running node model.jaffle_shop.customer_payments
2021-03-16 14:46:49.419580 (Thread-1): Began running node model.jaffle_shop.order_payments
2021-03-16 14:46:49.421107 (Thread-1): 10:46:49 | 6 of 8 START table model public.order_payments....................... [RUN]
2021-03-16 14:46:49.421793 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2021-03-16 14:46:49.421964 (Thread-1): Compiling model.jaffle_shop.order_payments
2021-03-16 14:46:49.431210 (Thread-1): Writing injected SQL for node "model.jaffle_shop.order_payments"
2021-03-16 14:46:49.432044 (Thread-1): finished collecting timing info
2021-03-16 14:46:49.439462 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2021-03-16 14:46:49.439628 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */
drop table if exists "dbttest1"."public"."order_payments__dbt_tmp" cascade
2021-03-16 14:46:49.439733 (Thread-1): Opening a new connection, currently in state closed
2021-03-16 14:46:49.448067 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-03-16 14:46:49.450641 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2021-03-16 14:46:49.450788 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */
drop table if exists "dbttest1"."public"."order_payments__dbt_backup" cascade
2021-03-16 14:46:49.451812 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-03-16 14:46:49.453007 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.order_payments"
2021-03-16 14:46:49.453515 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2021-03-16 14:46:49.453706 (Thread-1): On model.jaffle_shop.order_payments: BEGIN
2021-03-16 14:46:49.454963 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-03-16 14:46:49.455124 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2021-03-16 14:46:49.455215 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */


  create  table "dbttest1"."public"."order_payments__dbt_tmp"
  as (
    

with payments as (

    select * from "dbttest1"."public"."stg_payments"

),

final as (

    select
        order_id,

        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,
        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,
        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,
        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,
        sum(amount) as total_amount

    from payments

    group by 1

)

select * from final
  );
2021-03-16 14:46:49.459271 (Thread-1): SQL status: SELECT 99 in 0.00 seconds
2021-03-16 14:46:49.462833 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2021-03-16 14:46:49.462974 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */
alter table "dbttest1"."public"."order_payments__dbt_tmp" rename to "order_payments"
2021-03-16 14:46:49.464486 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-03-16 14:46:49.465609 (Thread-1): On model.jaffle_shop.order_payments: COMMIT
2021-03-16 14:46:49.465727 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2021-03-16 14:46:49.465814 (Thread-1): On model.jaffle_shop.order_payments: COMMIT
2021-03-16 14:46:49.467346 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-03-16 14:46:49.469075 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2021-03-16 14:46:49.469191 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */
drop table if exists "dbttest1"."public"."order_payments__dbt_backup" cascade
2021-03-16 14:46:49.470118 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-03-16 14:46:49.472675 (Thread-1): finished collecting timing info
2021-03-16 14:46:49.472952 (Thread-1): On model.jaffle_shop.order_payments: Close
2021-03-16 14:46:49.473581 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f83ff68-c9a2-4f92-bc8d-dea1415f2834', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087acfd0>]}
2021-03-16 14:46:49.474726 (Thread-1): 10:46:49 | 6 of 8 OK created table model public.order_payments.................. [SELECT 99 in 0.05s]
2021-03-16 14:46:49.474905 (Thread-1): Finished running node model.jaffle_shop.order_payments
2021-03-16 14:46:49.475048 (Thread-1): Began running node model.jaffle_shop.dim_customers
2021-03-16 14:46:49.476240 (Thread-1): 10:46:49 | 7 of 8 START table model public.dim_customers........................ [RUN]
2021-03-16 14:46:49.476727 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2021-03-16 14:46:49.476867 (Thread-1): Compiling model.jaffle_shop.dim_customers
2021-03-16 14:46:49.493451 (Thread-1): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-03-16 14:46:49.494900 (Thread-1): finished collecting timing info
2021-03-16 14:46:49.502201 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2021-03-16 14:46:49.502348 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "dbttest1"."public"."dim_customers__dbt_tmp" cascade
2021-03-16 14:46:49.502443 (Thread-1): Opening a new connection, currently in state closed
2021-03-16 14:46:49.511983 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-03-16 14:46:49.514682 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2021-03-16 14:46:49.514834 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "dbttest1"."public"."dim_customers__dbt_backup" cascade
2021-03-16 14:46:49.515837 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-03-16 14:46:49.517106 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-03-16 14:46:49.517610 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2021-03-16 14:46:49.517721 (Thread-1): On model.jaffle_shop.dim_customers: BEGIN
2021-03-16 14:46:49.518810 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-03-16 14:46:49.518949 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2021-03-16 14:46:49.519040 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */


  create  table "dbttest1"."public"."dim_customers__dbt_tmp"
  as (
    with customers as (

    select * from "dbttest1"."public"."stg_customers"

),

customer_orders as (

    select * from "dbttest1"."public"."customer_orders"

),

customer_payments as (

    select * from "dbttest1"."public"."customer_payments"

),

final as (

    select
        customers.customer_id,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders using (customer_id)

    left join customer_payments using (customer_id)

)

select * from final
  );
2021-03-16 14:46:49.522636 (Thread-1): SQL status: SELECT 100 in 0.00 seconds
2021-03-16 14:46:49.525387 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2021-03-16 14:46:49.525540 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
alter table "dbttest1"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
2021-03-16 14:46:49.527973 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-03-16 14:46:49.529066 (Thread-1): On model.jaffle_shop.dim_customers: COMMIT
2021-03-16 14:46:49.529199 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2021-03-16 14:46:49.529286 (Thread-1): On model.jaffle_shop.dim_customers: COMMIT
2021-03-16 14:46:49.530370 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-03-16 14:46:49.533650 (Thread-1): Using postgres connection "model.jaffle_shop.dim_customers".
2021-03-16 14:46:49.533859 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.dim_customers"} */
drop table if exists "dbttest1"."public"."dim_customers__dbt_backup" cascade
2021-03-16 14:46:49.535325 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-03-16 14:46:49.539945 (Thread-1): finished collecting timing info
2021-03-16 14:46:49.540431 (Thread-1): On model.jaffle_shop.dim_customers: Close
2021-03-16 14:46:49.541466 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f83ff68-c9a2-4f92-bc8d-dea1415f2834', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087ac290>]}
2021-03-16 14:46:49.542660 (Thread-1): 10:46:49 | 7 of 8 OK created table model public.dim_customers................... [SELECT 100 in 0.06s]
2021-03-16 14:46:49.542834 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2021-03-16 14:46:49.543027 (Thread-1): Began running node model.jaffle_shop.fct_orders
2021-03-16 14:46:49.544213 (Thread-1): 10:46:49 | 8 of 8 START table model public.fct_orders........................... [RUN]
2021-03-16 14:46:49.544681 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2021-03-16 14:46:49.544838 (Thread-1): Compiling model.jaffle_shop.fct_orders
2021-03-16 14:46:49.561138 (Thread-1): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-03-16 14:46:49.561727 (Thread-1): finished collecting timing info
2021-03-16 14:46:49.570880 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2021-03-16 14:46:49.571210 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "dbttest1"."public"."fct_orders__dbt_tmp" cascade
2021-03-16 14:46:49.571362 (Thread-1): Opening a new connection, currently in state closed
2021-03-16 14:46:49.581043 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-03-16 14:46:49.584644 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2021-03-16 14:46:49.584838 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "dbttest1"."public"."fct_orders__dbt_backup" cascade
2021-03-16 14:46:49.586012 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-03-16 14:46:49.588313 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.fct_orders"
2021-03-16 14:46:49.588983 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2021-03-16 14:46:49.589165 (Thread-1): On model.jaffle_shop.fct_orders: BEGIN
2021-03-16 14:46:49.590673 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-03-16 14:46:49.590876 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2021-03-16 14:46:49.590988 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */


  create  table "dbttest1"."public"."fct_orders__dbt_tmp"
  as (
    

with orders as (

    select * from "dbttest1"."public"."stg_orders"

),

order_payments as (

    select * from "dbttest1"."public"."order_payments"

),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.status,

        order_payments.credit_card_amount,

        order_payments.coupon_amount,

        order_payments.bank_transfer_amount,

        order_payments.gift_card_amount,

        order_payments.total_amount as amount

    from orders

    left join order_payments using (order_id)

)

select * from final
  );
2021-03-16 14:46:49.596849 (Thread-1): SQL status: SELECT 99 in 0.01 seconds
2021-03-16 14:46:49.599510 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2021-03-16 14:46:49.599631 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
alter table "dbttest1"."public"."fct_orders__dbt_tmp" rename to "fct_orders"
2021-03-16 14:46:49.601043 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-03-16 14:46:49.602140 (Thread-1): On model.jaffle_shop.fct_orders: COMMIT
2021-03-16 14:46:49.602261 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2021-03-16 14:46:49.602349 (Thread-1): On model.jaffle_shop.fct_orders: COMMIT
2021-03-16 14:46:49.604063 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-03-16 14:46:49.606069 (Thread-1): Using postgres connection "model.jaffle_shop.fct_orders".
2021-03-16 14:46:49.606270 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.fct_orders"} */
drop table if exists "dbttest1"."public"."fct_orders__dbt_backup" cascade
2021-03-16 14:46:49.607449 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-03-16 14:46:49.609934 (Thread-1): finished collecting timing info
2021-03-16 14:46:49.610193 (Thread-1): On model.jaffle_shop.fct_orders: Close
2021-03-16 14:46:49.610799 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f83ff68-c9a2-4f92-bc8d-dea1415f2834', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087b5190>]}
2021-03-16 14:46:49.611892 (Thread-1): 10:46:49 | 8 of 8 OK created table model public.fct_orders...................... [SELECT 99 in 0.07s]
2021-03-16 14:46:49.612064 (Thread-1): Finished running node model.jaffle_shop.fct_orders
2021-03-16 14:46:49.691637 (MainThread): Acquiring new postgres connection "master".
2021-03-16 14:46:49.692136 (MainThread): Using postgres connection "master".
2021-03-16 14:46:49.692366 (MainThread): On master: BEGIN
2021-03-16 14:46:49.692562 (MainThread): Opening a new connection, currently in state closed
2021-03-16 14:46:49.705885 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-03-16 14:46:49.706131 (MainThread): On master: COMMIT
2021-03-16 14:46:49.706279 (MainThread): Using postgres connection "master".
2021-03-16 14:46:49.706410 (MainThread): On master: COMMIT
2021-03-16 14:46:49.707792 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-03-16 14:46:49.708049 (MainThread): On master: Close
2021-03-16 14:46:49.708527 (MainThread): 10:46:49 | 
2021-03-16 14:46:49.708767 (MainThread): 10:46:49 | Finished running 3 view models, 5 table models in 0.80s.
2021-03-16 14:46:49.709066 (MainThread): Connection 'master' was properly closed.
2021-03-16 14:46:49.709279 (MainThread): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2021-03-16 14:46:49.850770 (MainThread): 
2021-03-16 14:46:49.850976 (MainThread): Completed successfully
2021-03-16 14:46:49.851120 (MainThread): 
Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
2021-03-16 14:46:49.851343 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10565c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104da2990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085a0ad0>]}
2021-03-16 14:46:49.851575 (MainThread): Flushing usage events
2021-03-16 14:47:27.487119 (MainThread): Running with dbt=0.19.0
2021-03-16 14:47:27.608721 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-03-16 14:47:27.610379 (MainThread): Tracking: tracking
2021-03-16 14:47:27.634547 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d08410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112948850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d38350>]}
2021-03-16 14:47:27.660248 (MainThread): Partial parsing not enabled
2021-03-16 14:47:27.661509 (MainThread): Parsing macros/catalog.sql
2021-03-16 14:47:27.665919 (MainThread): Parsing macros/relations.sql
2021-03-16 14:47:27.668138 (MainThread): Parsing macros/adapters.sql
2021-03-16 14:47:27.693072 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-03-16 14:47:27.697139 (MainThread): Parsing macros/core.sql
2021-03-16 14:47:27.702346 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-16 14:47:27.714362 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-16 14:47:27.716825 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-16 14:47:27.739086 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-16 14:47:27.778297 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-16 14:47:27.803018 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-16 14:47:27.805839 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-16 14:47:27.813871 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-16 14:47:27.833474 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-16 14:47:27.844480 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-16 14:47:27.853580 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-16 14:47:27.862961 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-16 14:47:27.864379 (MainThread): Parsing macros/etc/query.sql
2021-03-16 14:47:27.865872 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-16 14:47:27.868023 (MainThread): Parsing macros/etc/datetime.sql
2021-03-16 14:47:27.879228 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-16 14:47:27.881922 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-16 14:47:27.884214 (MainThread): Parsing macros/adapters/common.sql
2021-03-16 14:47:27.938121 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-16 14:47:27.942829 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-16 14:47:27.946553 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-16 14:47:27.949363 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-16 14:47:27.962018 (MainThread): Partial parsing not enabled
2021-03-16 14:47:28.029814 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2021-03-16 14:47:28.056282 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2021-03-16 14:47:28.070433 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2021-03-16 14:47:28.083722 (MainThread): Acquiring new postgres connection "model.jaffle_shop.dim_customers".
2021-03-16 14:47:28.099987 (MainThread): Acquiring new postgres connection "model.jaffle_shop.fct_orders".
2021-03-16 14:47:28.115911 (MainThread): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2021-03-16 14:47:28.130647 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_payments".
2021-03-16 14:47:28.145906 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customer_orders".
2021-03-16 14:47:28.681214 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '854f66de-c79c-4b17-82f5-8a61d27d8fc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130bec90>]}
2021-03-16 14:47:28.797385 (MainThread): Found 8 models, 20 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 3 seed files, 0 sources, 0 exposures
2021-03-16 14:47:28.800212 (MainThread): 
2021-03-16 14:47:28.800626 (MainThread): Acquiring new postgres connection "master".
2021-03-16 14:47:28.813570 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dbttest1".
2021-03-16 14:47:28.824842 (ThreadPoolExecutor-0_0): Using postgres connection "list_dbttest1".
2021-03-16 14:47:28.824986 (ThreadPoolExecutor-0_0): On list_dbttest1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1"} */

    select distinct nspname from pg_namespace
  
2021-03-16 14:47:28.825079 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-16 14:47:28.836819 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-03-16 14:47:28.840999 (ThreadPoolExecutor-0_0): On list_dbttest1: Close
2021-03-16 14:47:28.895592 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dbttest1_public".
2021-03-16 14:47:28.914115 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2021-03-16 14:47:28.932135 (ThreadPoolExecutor-1_0): On list_dbttest1_public: BEGIN
2021-03-16 14:47:28.932453 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-03-16 14:47:28.940834 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-03-16 14:47:28.957304 (ThreadPoolExecutor-1_0): Using postgres connection "list_dbttest1_public".
2021-03-16 14:47:28.957475 (ThreadPoolExecutor-1_0): On list_dbttest1_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1_public"} */
select
      'dbttest1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbttest1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-03-16 14:47:28.962728 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.01 seconds
2021-03-16 14:47:28.977163 (ThreadPoolExecutor-1_0): On list_dbttest1_public: ROLLBACK
2021-03-16 14:47:28.993852 (ThreadPoolExecutor-1_0): On list_dbttest1_public: Close
2021-03-16 14:47:29.056719 (MainThread): Using postgres connection "master".
2021-03-16 14:47:29.056884 (MainThread): On master: BEGIN
2021-03-16 14:47:29.056975 (MainThread): Opening a new connection, currently in state init
2021-03-16 14:47:29.064061 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-03-16 14:47:29.064231 (MainThread): Using postgres connection "master".
2021-03-16 14:47:29.064325 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-03-16 14:47:29.071277 (MainThread): SQL status: SELECT 3 in 0.01 seconds
2021-03-16 14:47:29.075933 (MainThread): On master: ROLLBACK
2021-03-16 14:47:29.076976 (MainThread): Using postgres connection "master".
2021-03-16 14:47:29.077105 (MainThread): On master: BEGIN
2021-03-16 14:47:29.078751 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-03-16 14:47:29.078914 (MainThread): On master: COMMIT
2021-03-16 14:47:29.079037 (MainThread): Using postgres connection "master".
2021-03-16 14:47:29.079140 (MainThread): On master: COMMIT
2021-03-16 14:47:29.080072 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-03-16 14:47:29.080224 (MainThread): On master: Close
2021-03-16 14:47:29.080522 (MainThread): 10:47:29 | Concurrency: 1 threads (target='dev')
2021-03-16 14:47:29.080652 (MainThread): 10:47:29 | 
2021-03-16 14:47:29.082279 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-03-16 14:47:29.083994 (Thread-1): 10:47:29 | 1 of 8 START view model public.stg_orders............................ [RUN]
2021-03-16 14:47:29.084371 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2021-03-16 14:47:29.084513 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-03-16 14:47:29.107294 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-03-16 14:47:29.107880 (Thread-1): finished collecting timing info
2021-03-16 14:47:29.138259 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2021-03-16 14:47:29.138427 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbttest1"."public"."stg_orders__dbt_tmp" cascade
2021-03-16 14:47:29.138521 (Thread-1): Opening a new connection, currently in state closed
2021-03-16 14:47:29.145806 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-03-16 14:47:29.149508 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2021-03-16 14:47:29.149702 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop view if exists "dbttest1"."public"."stg_orders__dbt_backup" cascade
2021-03-16 14:47:29.152239 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-03-16 14:47:29.158055 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-03-16 14:47:29.176665 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2021-03-16 14:47:29.176816 (Thread-1): On model.jaffle_shop.stg_orders: BEGIN
2021-03-16 14:47:29.178398 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-03-16 14:47:29.178619 (Thread-1): Using postgres connection "model.jaffle_shop.stg_orders".
2021-03-16 14:47:29.178748 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */

  create view "dbttest1"."public"."stg_orders__dbt_tmp" as (
    with source as (
    select * from "dbttest1"."public"."raw_orders"

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status,
        wow

    from source

)

select * from renamed
  );

2021-03-16 14:47:29.180614 (Thread-1): Postgres error: column "wow" does not exist
LINE 16:         wow
                 ^

2021-03-16 14:47:29.180886 (Thread-1): On model.jaffle_shop.stg_orders: ROLLBACK
2021-03-16 14:47:29.182313 (Thread-1): finished collecting timing info
2021-03-16 14:47:29.201211 (Thread-1): On model.jaffle_shop.stg_orders: Close
2021-03-16 14:47:29.201884 (Thread-1): Database Error in model stg_orders (models/staging/stg_orders.sql)
  column "wow" does not exist
  LINE 16:         wow
                   ^
  compiled SQL at target/run/jaffle_shop/models/staging/stg_orders.sql
Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedColumn: column "wow" does not exist
LINE 16:         wow
                 ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 230, in execute
    fetch=fetch
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Users/naveen/.pyenv/versions/3.7.4/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/naveen/.pyenv/versions/3.7.4/envs/dbt-cli/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model stg_orders (models/staging/stg_orders.sql)
  column "wow" does not exist
  LINE 16:         wow
                   ^
  compiled SQL at target/run/jaffle_shop/models/staging/stg_orders.sql
2021-03-16 14:47:29.211210 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '854f66de-c79c-4b17-82f5-8a61d27d8fc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11317b990>]}
2021-03-16 14:47:29.213641 (Thread-1): 10:47:29 | 1 of 8 ERROR creating view model public.stg_orders................... [ERROR in 0.13s]
2021-03-16 14:47:29.213911 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-03-16 14:47:29.214099 (Thread-1): Began running node model.jaffle_shop.stg_payments
2021-03-16 14:47:29.215626 (Thread-1): 10:47:29 | 2 of 8 START view model public.stg_payments.......................... [RUN]
2021-03-16 14:47:29.216540 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2021-03-16 14:47:29.216720 (Thread-1): Compiling model.jaffle_shop.stg_payments
2021-03-16 14:47:29.226053 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-03-16 14:47:29.226496 (Thread-1): finished collecting timing info
2021-03-16 14:47:29.235300 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2021-03-16 14:47:29.235513 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbttest1"."public"."stg_payments__dbt_tmp" cascade
2021-03-16 14:47:29.235616 (Thread-1): Opening a new connection, currently in state closed
2021-03-16 14:47:29.242510 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-03-16 14:47:29.245106 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2021-03-16 14:47:29.245315 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbttest1"."public"."stg_payments__dbt_backup" cascade
2021-03-16 14:47:29.254069 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-03-16 14:47:29.255320 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2021-03-16 14:47:29.255808 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2021-03-16 14:47:29.255922 (Thread-1): On model.jaffle_shop.stg_payments: BEGIN
2021-03-16 14:47:29.257393 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-03-16 14:47:29.257556 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2021-03-16 14:47:29.257648 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */

  create view "dbttest1"."public"."stg_payments__dbt_tmp" as (
    with source as (
    select * from "dbttest1"."public"."raw_payments"

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        --`amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed
  );

2021-03-16 14:47:29.263815 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-03-16 14:47:29.272822 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2021-03-16 14:47:29.272976 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbttest1"."public"."stg_payments" rename to "stg_payments__dbt_backup"
2021-03-16 14:47:29.274694 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-03-16 14:47:29.277184 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2021-03-16 14:47:29.277441 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
alter table "dbttest1"."public"."stg_payments__dbt_tmp" rename to "stg_payments"
2021-03-16 14:47:29.278899 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-03-16 14:47:29.286351 (Thread-1): On model.jaffle_shop.stg_payments: COMMIT
2021-03-16 14:47:29.286507 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2021-03-16 14:47:29.286611 (Thread-1): On model.jaffle_shop.stg_payments: COMMIT
2021-03-16 14:47:29.290315 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-03-16 14:47:29.294392 (Thread-1): Using postgres connection "model.jaffle_shop.stg_payments".
2021-03-16 14:47:29.294665 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
drop view if exists "dbttest1"."public"."stg_payments__dbt_backup" cascade
2021-03-16 14:47:29.303232 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-03-16 14:47:29.306093 (Thread-1): finished collecting timing info
2021-03-16 14:47:29.306384 (Thread-1): On model.jaffle_shop.stg_payments: Close
2021-03-16 14:47:29.307029 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '854f66de-c79c-4b17-82f5-8a61d27d8fc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132d9310>]}
2021-03-16 14:47:29.308134 (Thread-1): 10:47:29 | 2 of 8 OK created view model public.stg_payments..................... [CREATE VIEW in 0.09s]
2021-03-16 14:47:29.308305 (Thread-1): Finished running node model.jaffle_shop.stg_payments
2021-03-16 14:47:29.308443 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-03-16 14:47:29.309551 (Thread-1): 10:47:29 | 3 of 8 START view model public.stg_customers......................... [RUN]
2021-03-16 14:47:29.310110 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2021-03-16 14:47:29.310280 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-03-16 14:47:29.319146 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-03-16 14:47:29.319578 (Thread-1): finished collecting timing info
2021-03-16 14:47:29.326506 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2021-03-16 14:47:29.326650 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbttest1"."public"."stg_customers__dbt_tmp" cascade
2021-03-16 14:47:29.326742 (Thread-1): Opening a new connection, currently in state closed
2021-03-16 14:47:29.334503 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-03-16 14:47:29.338031 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2021-03-16 14:47:29.338253 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbttest1"."public"."stg_customers__dbt_backup" cascade
2021-03-16 14:47:29.339727 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-03-16 14:47:29.341019 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-03-16 14:47:29.341510 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2021-03-16 14:47:29.341618 (Thread-1): On model.jaffle_shop.stg_customers: BEGIN
2021-03-16 14:47:29.343436 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-03-16 14:47:29.343606 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2021-03-16 14:47:29.343700 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */

  create view "dbttest1"."public"."stg_customers__dbt_tmp" as (
    with source as (
    select * from "dbttest1"."public"."raw_customers"

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name,
        email

    from source

)

select * from renamed

--test customers
  );

2021-03-16 14:47:29.347545 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-03-16 14:47:29.352016 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2021-03-16 14:47:29.352162 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbttest1"."public"."stg_customers" rename to "stg_customers__dbt_backup"
2021-03-16 14:47:29.353943 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-03-16 14:47:29.357689 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2021-03-16 14:47:29.357834 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
alter table "dbttest1"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
2021-03-16 14:47:29.359207 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-03-16 14:47:29.360550 (Thread-1): On model.jaffle_shop.stg_customers: COMMIT
2021-03-16 14:47:29.360760 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2021-03-16 14:47:29.360922 (Thread-1): On model.jaffle_shop.stg_customers: COMMIT
2021-03-16 14:47:29.362948 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-03-16 14:47:29.366935 (Thread-1): Using postgres connection "model.jaffle_shop.stg_customers".
2021-03-16 14:47:29.367138 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop view if exists "dbttest1"."public"."stg_customers__dbt_backup" cascade
2021-03-16 14:47:29.368802 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-03-16 14:47:29.372757 (Thread-1): finished collecting timing info
2021-03-16 14:47:29.373331 (Thread-1): On model.jaffle_shop.stg_customers: Close
2021-03-16 14:47:29.374617 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '854f66de-c79c-4b17-82f5-8a61d27d8fc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11327c190>]}
2021-03-16 14:47:29.376417 (Thread-1): 10:47:29 | 3 of 8 OK created view model public.stg_customers.................... [CREATE VIEW in 0.06s]
2021-03-16 14:47:29.376609 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-03-16 14:47:29.376779 (Thread-1): Began running node model.jaffle_shop.customer_orders
2021-03-16 14:47:29.377055 (Thread-1): 10:47:29 | 4 of 8 SKIP relation public.customer_orders.......................... [SKIP]
2021-03-16 14:47:29.377322 (Thread-1): Finished running node model.jaffle_shop.customer_orders
2021-03-16 14:47:29.377525 (Thread-1): Began running node model.jaffle_shop.customer_payments
2021-03-16 14:47:29.377851 (Thread-1): 10:47:29 | 5 of 8 SKIP relation public.customer_payments........................ [SKIP]
2021-03-16 14:47:29.378007 (Thread-1): Finished running node model.jaffle_shop.customer_payments
2021-03-16 14:47:29.378138 (Thread-1): Began running node model.jaffle_shop.order_payments
2021-03-16 14:47:29.380320 (Thread-1): 10:47:29 | 6 of 8 START table model public.order_payments....................... [RUN]
2021-03-16 14:47:29.380880 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.order_payments".
2021-03-16 14:47:29.381099 (Thread-1): Compiling model.jaffle_shop.order_payments
2021-03-16 14:47:29.390595 (Thread-1): Writing injected SQL for node "model.jaffle_shop.order_payments"
2021-03-16 14:47:29.391043 (Thread-1): finished collecting timing info
2021-03-16 14:47:29.416944 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2021-03-16 14:47:29.417110 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */
drop table if exists "dbttest1"."public"."order_payments__dbt_tmp" cascade
2021-03-16 14:47:29.417203 (Thread-1): Opening a new connection, currently in state closed
2021-03-16 14:47:29.425675 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-03-16 14:47:29.428861 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2021-03-16 14:47:29.429088 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */
drop table if exists "dbttest1"."public"."order_payments__dbt_backup" cascade
2021-03-16 14:47:29.430385 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-03-16 14:47:29.439271 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.order_payments"
2021-03-16 14:47:29.440114 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2021-03-16 14:47:29.440364 (Thread-1): On model.jaffle_shop.order_payments: BEGIN
2021-03-16 14:47:29.441769 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-03-16 14:47:29.441930 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2021-03-16 14:47:29.442018 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */


  create  table "dbttest1"."public"."order_payments__dbt_tmp"
  as (
    

with payments as (

    select * from "dbttest1"."public"."stg_payments"

),

final as (

    select
        order_id,

        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,
        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,
        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,
        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,
        sum(amount) as total_amount

    from payments

    group by 1

)

select * from final
  );
2021-03-16 14:47:29.446364 (Thread-1): SQL status: SELECT 99 in 0.00 seconds
2021-03-16 14:47:29.450171 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2021-03-16 14:47:29.450308 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */
alter table "dbttest1"."public"."order_payments" rename to "order_payments__dbt_backup"
2021-03-16 14:47:29.452253 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-03-16 14:47:29.455652 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2021-03-16 14:47:29.455800 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */
alter table "dbttest1"."public"."order_payments__dbt_tmp" rename to "order_payments"
2021-03-16 14:47:29.457239 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-03-16 14:47:29.458303 (Thread-1): On model.jaffle_shop.order_payments: COMMIT
2021-03-16 14:47:29.458422 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2021-03-16 14:47:29.458505 (Thread-1): On model.jaffle_shop.order_payments: COMMIT
2021-03-16 14:47:29.461339 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-03-16 14:47:29.463411 (Thread-1): Using postgres connection "model.jaffle_shop.order_payments".
2021-03-16 14:47:29.463583 (Thread-1): On model.jaffle_shop.order_payments: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.order_payments"} */
drop table if exists "dbttest1"."public"."order_payments__dbt_backup" cascade
2021-03-16 14:47:29.467987 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-03-16 14:47:29.471337 (Thread-1): finished collecting timing info
2021-03-16 14:47:29.471621 (Thread-1): On model.jaffle_shop.order_payments: Close
2021-03-16 14:47:29.472467 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '854f66de-c79c-4b17-82f5-8a61d27d8fc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133718d0>]}
2021-03-16 14:47:29.474004 (Thread-1): 10:47:29 | 6 of 8 OK created table model public.order_payments.................. [SELECT 99 in 0.09s]
2021-03-16 14:47:29.474249 (Thread-1): Finished running node model.jaffle_shop.order_payments
2021-03-16 14:47:29.474452 (Thread-1): Began running node model.jaffle_shop.dim_customers
2021-03-16 14:47:29.474680 (Thread-1): 10:47:29 | 7 of 8 SKIP relation public.dim_customers............................ [SKIP]
2021-03-16 14:47:29.474884 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2021-03-16 14:47:29.476387 (Thread-1): Began running node model.jaffle_shop.fct_orders
2021-03-16 14:47:29.476691 (Thread-1): 10:47:29 | 8 of 8 SKIP relation public.fct_orders............................... [SKIP]
2021-03-16 14:47:29.476941 (Thread-1): Finished running node model.jaffle_shop.fct_orders
2021-03-16 14:47:29.500300 (MainThread): Acquiring new postgres connection "master".
2021-03-16 14:47:29.500531 (MainThread): Using postgres connection "master".
2021-03-16 14:47:29.500628 (MainThread): On master: BEGIN
2021-03-16 14:47:29.500760 (MainThread): Opening a new connection, currently in state closed
2021-03-16 14:47:29.508422 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-03-16 14:47:29.508611 (MainThread): On master: COMMIT
2021-03-16 14:47:29.508705 (MainThread): Using postgres connection "master".
2021-03-16 14:47:29.508787 (MainThread): On master: COMMIT
2021-03-16 14:47:29.509576 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-03-16 14:47:29.509705 (MainThread): On master: Close
2021-03-16 14:47:29.510060 (MainThread): 10:47:29 | 
2021-03-16 14:47:29.510200 (MainThread): 10:47:29 | Finished running 3 view models, 5 table models in 0.71s.
2021-03-16 14:47:29.510306 (MainThread): Connection 'master' was properly closed.
2021-03-16 14:47:29.510390 (MainThread): Connection 'model.jaffle_shop.order_payments' was properly closed.
2021-03-16 14:47:29.616118 (MainThread): 
2021-03-16 14:47:29.616298 (MainThread): Completed with 1 error and 0 warnings:
2021-03-16 14:47:29.616407 (MainThread): 
2021-03-16 14:47:29.616513 (MainThread): Database Error in model stg_orders (models/staging/stg_orders.sql)
2021-03-16 14:47:29.616609 (MainThread):   column "wow" does not exist
2021-03-16 14:47:29.616707 (MainThread):   LINE 16:         wow
2021-03-16 14:47:29.616792 (MainThread):                    ^
2021-03-16 14:47:29.616875 (MainThread):   compiled SQL at target/run/jaffle_shop/models/staging/stg_orders.sql
2021-03-16 14:47:29.616977 (MainThread): 
Done. PASS=3 WARN=0 ERROR=1 SKIP=4 TOTAL=8
2021-03-16 14:47:29.617138 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132eb950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132eb750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113345910>]}
2021-03-16 14:47:29.617322 (MainThread): Flushing usage events
2021-03-31 20:28:17.364637 (MainThread): Running with dbt=0.19.0
2021-03-31 20:28:17.471461 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2021-03-31 20:28:17.479178 (MainThread): Tracking: tracking
2021-03-31 20:28:17.502117 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb11110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb21750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb21410>]}
2021-03-31 20:28:17.547060 (MainThread): Partial parsing not enabled
2021-03-31 20:28:17.549706 (MainThread): Parsing macros/catalog.sql
2021-03-31 20:28:17.558867 (MainThread): Parsing macros/relations.sql
2021-03-31 20:28:17.563070 (MainThread): Parsing macros/adapters.sql
2021-03-31 20:28:17.616335 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-03-31 20:28:17.624746 (MainThread): Parsing macros/core.sql
2021-03-31 20:28:17.639805 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 20:28:17.669137 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 20:28:17.675337 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 20:28:17.720154 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 20:28:17.805325 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 20:28:17.854247 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 20:28:17.859535 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 20:28:17.869823 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 20:28:17.892205 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 20:28:17.902987 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 20:28:17.917424 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 20:28:17.925311 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 20:28:17.926999 (MainThread): Parsing macros/etc/query.sql
2021-03-31 20:28:17.929123 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 20:28:17.932391 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 20:28:17.949078 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 20:28:17.954070 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 20:28:17.960113 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 20:28:18.036653 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 20:28:18.040133 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 20:28:18.043190 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 20:28:18.045670 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 20:28:18.058059 (MainThread): Partial parsing not enabled
2021-03-31 20:28:18.136355 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customers".
2021-03-31 20:28:18.163046 (MainThread): Acquiring new postgres connection "model.jaffle_shop.orders".
2021-03-31 20:28:18.180305 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2021-03-31 20:28:18.195588 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2021-03-31 20:28:18.209877 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2021-03-31 20:28:18.747047 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9937c547-d4bc-4642-835f-421bcf109dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cce9cd0>]}
2021-03-31 20:28:18.891049 (MainThread): Found 5 models, 20 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 3 seed files, 0 sources, 0 exposures
2021-03-31 20:28:18.894305 (MainThread): 
2021-03-31 20:28:18.894747 (MainThread): Acquiring new postgres connection "master".
2021-03-31 20:28:18.941937 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dbttest1_public".
2021-03-31 20:28:18.955230 (ThreadPoolExecutor-0_0): Using postgres connection "list_dbttest1_public".
2021-03-31 20:28:18.955422 (ThreadPoolExecutor-0_0): On list_dbttest1_public: BEGIN
2021-03-31 20:28:18.955524 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-31 20:28:18.961335 (ThreadPoolExecutor-0_0): Got an error when attempting to open a postgres connection: 'FATAL:  database "dbttest1" does not exist
'
2021-03-31 20:28:18.961524 (ThreadPoolExecutor-0_0): Error running SQL: BEGIN
2021-03-31 20:28:18.961621 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-03-31 20:28:18.961756 (ThreadPoolExecutor-0_0): Error running SQL: macro list_relations_without_caching
2021-03-31 20:28:18.961842 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-03-31 20:28:18.961952 (ThreadPoolExecutor-0_0): On list_dbttest1_public: No close available on handle
2021-03-31 20:28:18.962530 (MainThread): Connection 'master' was properly closed.
2021-03-31 20:28:18.962648 (MainThread): Connection 'list_dbttest1_public' was properly closed.
2021-03-31 20:28:18.962762 (MainThread): ERROR: Database Error
  FATAL:  database "dbttest1" does not exist
  
2021-03-31 20:28:18.962948 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce79c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd26750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd6dd10>]}
2021-03-31 20:28:18.963213 (MainThread): Flushing usage events
2021-03-31 20:28:47.004868 (MainThread): Running with dbt=0.19.0
2021-03-31 20:28:47.083923 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2021-03-31 20:28:47.085176 (MainThread): Tracking: tracking
2021-03-31 20:28:47.105462 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6e3190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6c4290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6f3410>]}
2021-03-31 20:28:47.130502 (MainThread): Partial parsing not enabled
2021-03-31 20:28:47.131813 (MainThread): Parsing macros/catalog.sql
2021-03-31 20:28:47.136044 (MainThread): Parsing macros/relations.sql
2021-03-31 20:28:47.138068 (MainThread): Parsing macros/adapters.sql
2021-03-31 20:28:47.162204 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-03-31 20:28:47.166294 (MainThread): Parsing macros/core.sql
2021-03-31 20:28:47.171658 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 20:28:47.184550 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 20:28:47.186794 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 20:28:47.208131 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 20:28:47.246521 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 20:28:47.273467 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 20:28:47.275950 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 20:28:47.283529 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 20:28:47.300192 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 20:28:47.309008 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 20:28:47.317080 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 20:28:47.323535 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 20:28:47.324961 (MainThread): Parsing macros/etc/query.sql
2021-03-31 20:28:47.326405 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 20:28:47.328529 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 20:28:47.339284 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 20:28:47.342266 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 20:28:47.344849 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 20:28:47.404866 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 20:28:47.407756 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 20:28:47.409843 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 20:28:47.412195 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 20:28:47.422372 (MainThread): Partial parsing not enabled
2021-03-31 20:28:47.495425 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customers".
2021-03-31 20:28:47.523894 (MainThread): Acquiring new postgres connection "model.jaffle_shop.orders".
2021-03-31 20:28:47.539769 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2021-03-31 20:28:47.553688 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2021-03-31 20:28:47.567593 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2021-03-31 20:28:48.095940 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e89df84b-5c74-4d4c-b6c6-d82d8d7f92ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d857c10>]}
2021-03-31 20:28:48.198135 (MainThread): Found 5 models, 20 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 3 seed files, 0 sources, 0 exposures
2021-03-31 20:28:48.201278 (MainThread): 
2021-03-31 20:28:48.201697 (MainThread): Acquiring new postgres connection "master".
2021-03-31 20:28:48.239391 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dbttest1_public".
2021-03-31 20:28:48.250721 (ThreadPoolExecutor-0_0): Using postgres connection "list_dbttest1_public".
2021-03-31 20:28:48.250876 (ThreadPoolExecutor-0_0): On list_dbttest1_public: BEGIN
2021-03-31 20:28:48.250974 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-03-31 20:28:48.266108 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.02 seconds
2021-03-31 20:28:48.266301 (ThreadPoolExecutor-0_0): Using postgres connection "list_dbttest1_public".
2021-03-31 20:28:48.266399 (ThreadPoolExecutor-0_0): On list_dbttest1_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_dbttest1_public"} */
select
      'dbttest1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbttest1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-03-31 20:28:48.270256 (ThreadPoolExecutor-0_0): SQL status: SELECT 0 in 0.00 seconds
2021-03-31 20:28:48.270625 (ThreadPoolExecutor-0_0): On list_dbttest1_public: ROLLBACK
2021-03-31 20:28:48.271558 (ThreadPoolExecutor-0_0): On list_dbttest1_public: Close
2021-03-31 20:28:48.311649 (MainThread): Using postgres connection "master".
2021-03-31 20:28:48.311811 (MainThread): On master: BEGIN
2021-03-31 20:28:48.311909 (MainThread): Opening a new connection, currently in state init
2021-03-31 20:28:48.320280 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-03-31 20:28:48.320452 (MainThread): Using postgres connection "master".
2021-03-31 20:28:48.320547 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-03-31 20:28:48.328478 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-03-31 20:28:48.328810 (MainThread): On master: ROLLBACK
2021-03-31 20:28:48.329582 (MainThread): On master: Close
2021-03-31 20:28:48.329980 (MainThread): 16:28:48 | Concurrency: 1 threads (target='dev')
2021-03-31 20:28:48.330322 (MainThread): 16:28:48 | 
2021-03-31 20:28:48.332123 (Thread-1): Began running node seed.jaffle_shop.raw_orders
2021-03-31 20:28:48.332575 (Thread-1): Acquiring new postgres connection "seed.jaffle_shop.raw_orders".
2021-03-31 20:28:48.332743 (Thread-1): Compiling seed.jaffle_shop.raw_orders
2021-03-31 20:28:48.349689 (Thread-1): Writing injected SQL for node "seed.jaffle_shop.raw_orders"
2021-03-31 20:28:48.349865 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.350149 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.350554 (Thread-1): Finished running node seed.jaffle_shop.raw_orders
2021-03-31 20:28:48.350690 (Thread-1): Began running node seed.jaffle_shop.raw_payments
2021-03-31 20:28:48.351067 (Thread-1): Acquiring new postgres connection "seed.jaffle_shop.raw_payments".
2021-03-31 20:28:48.351309 (Thread-1): Compiling seed.jaffle_shop.raw_payments
2021-03-31 20:28:48.357998 (Thread-1): Writing injected SQL for node "seed.jaffle_shop.raw_payments"
2021-03-31 20:28:48.358211 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.358494 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.358979 (Thread-1): Finished running node seed.jaffle_shop.raw_payments
2021-03-31 20:28:48.359115 (Thread-1): Began running node seed.jaffle_shop.raw_customers
2021-03-31 20:28:48.359484 (Thread-1): Acquiring new postgres connection "seed.jaffle_shop.raw_customers".
2021-03-31 20:28:48.359615 (Thread-1): Compiling seed.jaffle_shop.raw_customers
2021-03-31 20:28:48.364969 (Thread-1): Writing injected SQL for node "seed.jaffle_shop.raw_customers"
2021-03-31 20:28:48.365143 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.365389 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.365780 (Thread-1): Finished running node seed.jaffle_shop.raw_customers
2021-03-31 20:28:48.365917 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-03-31 20:28:48.366274 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2021-03-31 20:28:48.366407 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-03-31 20:28:48.389707 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-03-31 20:28:48.391725 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.392123 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.392654 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-03-31 20:28:48.392887 (Thread-1): Began running node model.jaffle_shop.stg_payments
2021-03-31 20:28:48.393369 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2021-03-31 20:28:48.393779 (Thread-1): Compiling model.jaffle_shop.stg_payments
2021-03-31 20:28:48.403210 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-03-31 20:28:48.403731 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.404012 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.404455 (Thread-1): Finished running node model.jaffle_shop.stg_payments
2021-03-31 20:28:48.404626 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-03-31 20:28:48.405092 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2021-03-31 20:28:48.405397 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-03-31 20:28:48.413652 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-03-31 20:28:48.414123 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.414386 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.414782 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-03-31 20:28:48.414915 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2021-03-31 20:28:48.415408 (Thread-1): Acquiring new postgres connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned".
2021-03-31 20:28:48.415531 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2021-03-31 20:28:48.434671 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned"
2021-03-31 20:28:48.435310 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.435579 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.435985 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2021-03-31 20:28:48.436230 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_order_id
2021-03-31 20:28:48.436589 (Thread-1): Acquiring new postgres connection "test.jaffle_shop.not_null_stg_orders_order_id".
2021-03-31 20:28:48.436719 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_order_id
2021-03-31 20:28:48.444789 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id"
2021-03-31 20:28:48.445339 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.445619 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.446004 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_order_id
2021-03-31 20:28:48.446155 (Thread-1): Began running node test.jaffle_shop.unique_stg_orders_order_id
2021-03-31 20:28:48.446400 (Thread-1): Acquiring new postgres connection "test.jaffle_shop.unique_stg_orders_order_id".
2021-03-31 20:28:48.446516 (Thread-1): Compiling test.jaffle_shop.unique_stg_orders_order_id
2021-03-31 20:28:48.454445 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id"
2021-03-31 20:28:48.454938 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.455231 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.455777 (Thread-1): Finished running node test.jaffle_shop.unique_stg_orders_order_id
2021-03-31 20:28:48.455923 (Thread-1): Began running node model.jaffle_shop.orders
2021-03-31 20:28:48.456267 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.orders".
2021-03-31 20:28:48.456402 (Thread-1): Compiling model.jaffle_shop.orders
2021-03-31 20:28:48.469703 (Thread-1): Writing injected SQL for node "model.jaffle_shop.orders"
2021-03-31 20:28:48.470167 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.470460 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.470861 (Thread-1): Finished running node model.jaffle_shop.orders
2021-03-31 20:28:48.471000 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card
2021-03-31 20:28:48.471245 (Thread-1): Acquiring new postgres connection "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card".
2021-03-31 20:28:48.471358 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card
2021-03-31 20:28:48.482072 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card"
2021-03-31 20:28:48.482778 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.483042 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.483422 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card
2021-03-31 20:28:48.483556 (Thread-1): Began running node test.jaffle_shop.not_null_stg_payments_payment_id
2021-03-31 20:28:48.483795 (Thread-1): Acquiring new postgres connection "test.jaffle_shop.not_null_stg_payments_payment_id".
2021-03-31 20:28:48.483905 (Thread-1): Compiling test.jaffle_shop.not_null_stg_payments_payment_id
2021-03-31 20:28:48.492093 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_payments_payment_id"
2021-03-31 20:28:48.492662 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.493055 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.493464 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_payments_payment_id
2021-03-31 20:28:48.493604 (Thread-1): Began running node test.jaffle_shop.unique_stg_payments_payment_id
2021-03-31 20:28:48.493968 (Thread-1): Acquiring new postgres connection "test.jaffle_shop.unique_stg_payments_payment_id".
2021-03-31 20:28:48.494098 (Thread-1): Compiling test.jaffle_shop.unique_stg_payments_payment_id
2021-03-31 20:28:48.501874 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_payments_payment_id"
2021-03-31 20:28:48.502290 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.502571 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.502981 (Thread-1): Finished running node test.jaffle_shop.unique_stg_payments_payment_id
2021-03-31 20:28:48.503123 (Thread-1): Began running node model.jaffle_shop.customers
2021-03-31 20:28:48.503501 (Thread-1): Acquiring new postgres connection "model.jaffle_shop.customers".
2021-03-31 20:28:48.503673 (Thread-1): Compiling model.jaffle_shop.customers
2021-03-31 20:28:48.515950 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-03-31 20:28:48.516381 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.516641 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.517044 (Thread-1): Finished running node model.jaffle_shop.customers
2021-03-31 20:28:48.517182 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id
2021-03-31 20:28:48.517695 (Thread-1): Acquiring new postgres connection "test.jaffle_shop.not_null_stg_customers_customer_id".
2021-03-31 20:28:48.517820 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id
2021-03-31 20:28:48.525834 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id"
2021-03-31 20:28:48.526332 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.526678 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.527091 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id
2021-03-31 20:28:48.527240 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id
2021-03-31 20:28:48.527574 (Thread-1): Acquiring new postgres connection "test.jaffle_shop.unique_stg_customers_customer_id".
2021-03-31 20:28:48.527687 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id
2021-03-31 20:28:48.535386 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id"
2021-03-31 20:28:48.535809 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.536101 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.536561 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id
2021-03-31 20:28:48.536697 (Thread-1): Began running node test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned
2021-03-31 20:28:48.537050 (Thread-1): Acquiring new postgres connection "test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned".
2021-03-31 20:28:48.537175 (Thread-1): Compiling test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned
2021-03-31 20:28:48.547138 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned"
2021-03-31 20:28:48.547744 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.548018 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.548408 (Thread-1): Finished running node test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned
2021-03-31 20:28:48.548543 (Thread-1): Began running node test.jaffle_shop.not_null_orders_amount
2021-03-31 20:28:48.548788 (Thread-1): Acquiring new postgres connection "test.jaffle_shop.not_null_orders_amount".
2021-03-31 20:28:48.548901 (Thread-1): Compiling test.jaffle_shop.not_null_orders_amount
2021-03-31 20:28:48.557330 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_orders_amount"
2021-03-31 20:28:48.557767 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.558171 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.558624 (Thread-1): Finished running node test.jaffle_shop.not_null_orders_amount
2021-03-31 20:28:48.558796 (Thread-1): Began running node test.jaffle_shop.not_null_orders_bank_transfer_amount
2021-03-31 20:28:48.559185 (Thread-1): Acquiring new postgres connection "test.jaffle_shop.not_null_orders_bank_transfer_amount".
2021-03-31 20:28:48.559376 (Thread-1): Compiling test.jaffle_shop.not_null_orders_bank_transfer_amount
2021-03-31 20:28:48.568443 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_orders_bank_transfer_amount"
2021-03-31 20:28:48.568901 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.569204 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.569612 (Thread-1): Finished running node test.jaffle_shop.not_null_orders_bank_transfer_amount
2021-03-31 20:28:48.569750 (Thread-1): Began running node test.jaffle_shop.not_null_orders_coupon_amount
2021-03-31 20:28:48.569997 (Thread-1): Acquiring new postgres connection "test.jaffle_shop.not_null_orders_coupon_amount".
2021-03-31 20:28:48.570238 (Thread-1): Compiling test.jaffle_shop.not_null_orders_coupon_amount
2021-03-31 20:28:48.578910 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_orders_coupon_amount"
2021-03-31 20:28:48.579349 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.579688 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.580105 (Thread-1): Finished running node test.jaffle_shop.not_null_orders_coupon_amount
2021-03-31 20:28:48.580285 (Thread-1): Began running node test.jaffle_shop.not_null_orders_credit_card_amount
2021-03-31 20:28:48.580565 (Thread-1): Acquiring new postgres connection "test.jaffle_shop.not_null_orders_credit_card_amount".
2021-03-31 20:28:48.580681 (Thread-1): Compiling test.jaffle_shop.not_null_orders_credit_card_amount
2021-03-31 20:28:48.588667 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_orders_credit_card_amount"
2021-03-31 20:28:48.589120 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.589396 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.589802 (Thread-1): Finished running node test.jaffle_shop.not_null_orders_credit_card_amount
2021-03-31 20:28:48.589940 (Thread-1): Began running node test.jaffle_shop.not_null_orders_customer_id
2021-03-31 20:28:48.590316 (Thread-1): Acquiring new postgres connection "test.jaffle_shop.not_null_orders_customer_id".
2021-03-31 20:28:48.590461 (Thread-1): Compiling test.jaffle_shop.not_null_orders_customer_id
2021-03-31 20:28:48.598316 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_orders_customer_id"
2021-03-31 20:28:48.598783 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.599040 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.599528 (Thread-1): Finished running node test.jaffle_shop.not_null_orders_customer_id
2021-03-31 20:28:48.599676 (Thread-1): Began running node test.jaffle_shop.not_null_orders_gift_card_amount
2021-03-31 20:28:48.599927 (Thread-1): Acquiring new postgres connection "test.jaffle_shop.not_null_orders_gift_card_amount".
2021-03-31 20:28:48.600119 (Thread-1): Compiling test.jaffle_shop.not_null_orders_gift_card_amount
2021-03-31 20:28:48.612854 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_orders_gift_card_amount"
2021-03-31 20:28:48.613340 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.613619 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.614062 (Thread-1): Finished running node test.jaffle_shop.not_null_orders_gift_card_amount
2021-03-31 20:28:48.614226 (Thread-1): Began running node test.jaffle_shop.not_null_orders_order_id
2021-03-31 20:28:48.614588 (Thread-1): Acquiring new postgres connection "test.jaffle_shop.not_null_orders_order_id".
2021-03-31 20:28:48.614723 (Thread-1): Compiling test.jaffle_shop.not_null_orders_order_id
2021-03-31 20:28:48.622590 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_orders_order_id"
2021-03-31 20:28:48.623083 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.623412 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.623957 (Thread-1): Finished running node test.jaffle_shop.not_null_orders_order_id
2021-03-31 20:28:48.624121 (Thread-1): Began running node test.jaffle_shop.unique_orders_order_id
2021-03-31 20:28:48.624477 (Thread-1): Acquiring new postgres connection "test.jaffle_shop.unique_orders_order_id".
2021-03-31 20:28:48.624619 (Thread-1): Compiling test.jaffle_shop.unique_orders_order_id
2021-03-31 20:28:48.632289 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_orders_order_id"
2021-03-31 20:28:48.632725 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.632978 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.633352 (Thread-1): Finished running node test.jaffle_shop.unique_orders_order_id
2021-03-31 20:28:48.633487 (Thread-1): Began running node test.jaffle_shop.not_null_customers_customer_id
2021-03-31 20:28:48.633731 (Thread-1): Acquiring new postgres connection "test.jaffle_shop.not_null_customers_customer_id".
2021-03-31 20:28:48.633843 (Thread-1): Compiling test.jaffle_shop.not_null_customers_customer_id
2021-03-31 20:28:48.642125 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id"
2021-03-31 20:28:48.642595 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.642865 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.643328 (Thread-1): Finished running node test.jaffle_shop.not_null_customers_customer_id
2021-03-31 20:28:48.643528 (Thread-1): Began running node test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_
2021-03-31 20:28:48.643802 (Thread-1): Acquiring new postgres connection "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_".
2021-03-31 20:28:48.643918 (Thread-1): Compiling test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_
2021-03-31 20:28:48.654196 (Thread-1): Writing injected SQL for node "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_"
2021-03-31 20:28:48.654993 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.655482 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.656181 (Thread-1): Finished running node test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_
2021-03-31 20:28:48.656460 (Thread-1): Began running node test.jaffle_shop.unique_customers_customer_id
2021-03-31 20:28:48.657019 (Thread-1): Acquiring new postgres connection "test.jaffle_shop.unique_customers_customer_id".
2021-03-31 20:28:48.657192 (Thread-1): Compiling test.jaffle_shop.unique_customers_customer_id
2021-03-31 20:28:48.666852 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id"
2021-03-31 20:28:48.667301 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.667575 (Thread-1): finished collecting timing info
2021-03-31 20:28:48.667971 (Thread-1): Finished running node test.jaffle_shop.unique_customers_customer_id
2021-03-31 20:28:48.755160 (MainThread): Connection 'master' was properly closed.
2021-03-31 20:28:48.755676 (MainThread): Connection 'test.jaffle_shop.unique_customers_customer_id' was properly closed.
2021-03-31 20:28:48.885417 (MainThread): 16:28:48 | Done.
2021-03-31 20:28:48.892115 (MainThread): Acquiring new postgres connection "generate_catalog".
2021-03-31 20:28:48.892312 (MainThread): 16:28:48 | Building catalog
2021-03-31 20:28:48.997229 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "dbttest1.information_schema".
2021-03-31 20:28:49.006326 (ThreadPoolExecutor-1_0): Using postgres connection "dbttest1.information_schema".
2021-03-31 20:28:49.006507 (ThreadPoolExecutor-1_0): On dbttest1.information_schema: BEGIN
2021-03-31 20:28:49.006618 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-03-31 20:28:49.015197 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-03-31 20:28:49.015371 (ThreadPoolExecutor-1_0): Using postgres connection "dbttest1.information_schema".
2021-03-31 20:28:49.015466 (ThreadPoolExecutor-1_0): On dbttest1.information_schema: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "dbttest1.information_schema"} */

    
    

    select
        'dbttest1' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence = 'p' -- [p]ermanent table. Other values are [u]nlogged table, [t]emporary table
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
2021-03-31 20:28:49.021693 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.01 seconds
2021-03-31 20:28:49.023091 (ThreadPoolExecutor-1_0): On dbttest1.information_schema: ROLLBACK
2021-03-31 20:28:49.024262 (ThreadPoolExecutor-1_0): On dbttest1.information_schema: Close
2021-03-31 20:28:49.129445 (MainThread): 16:28:49 | Catalog written to /Users/naveen/git/jaffle_shop/target/catalog.json
2021-03-31 20:28:49.129759 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8df810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce186d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da69450>]}
2021-03-31 20:28:49.130118 (MainThread): Flushing usage events
2021-03-31 20:28:49.263623 (MainThread): Connection 'generate_catalog' was properly closed.
2021-03-31 20:28:49.263851 (MainThread): Connection 'dbttest1.information_schema' was properly closed.
2021-03-31 20:29:23.084766 (MainThread): Running with dbt=0.19.0
2021-03-31 20:29:23.169115 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.freshness.FreshnessTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', output=None, partial_parse=None, profile=None, profiles_dir='/Users/naveen/.dbt', project_dir=None, record_timing_info=None, rpc_method='snapshot-freshness', selected=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='snapshot-freshness', write_json=True)
2021-03-31 20:29:23.170554 (MainThread): Tracking: tracking
2021-03-31 20:29:23.192134 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3b0310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3c1750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3c1590>]}
2021-03-31 20:29:23.217911 (MainThread): Partial parsing not enabled
2021-03-31 20:29:23.219560 (MainThread): Parsing macros/catalog.sql
2021-03-31 20:29:23.223900 (MainThread): Parsing macros/relations.sql
2021-03-31 20:29:23.226069 (MainThread): Parsing macros/adapters.sql
2021-03-31 20:29:23.250215 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-03-31 20:29:23.254745 (MainThread): Parsing macros/core.sql
2021-03-31 20:29:23.260471 (MainThread): Parsing macros/materializations/helpers.sql
2021-03-31 20:29:23.272825 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-03-31 20:29:23.275776 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-03-31 20:29:23.298007 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-03-31 20:29:23.338174 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-03-31 20:29:23.364983 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-03-31 20:29:23.367836 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-03-31 20:29:23.376586 (MainThread): Parsing macros/materializations/common/merge.sql
2021-03-31 20:29:23.395134 (MainThread): Parsing macros/materializations/table/table.sql
2021-03-31 20:29:23.404655 (MainThread): Parsing macros/materializations/view/view.sql
2021-03-31 20:29:23.414397 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-03-31 20:29:23.426312 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-03-31 20:29:23.427728 (MainThread): Parsing macros/etc/query.sql
2021-03-31 20:29:23.429190 (MainThread): Parsing macros/etc/is_incremental.sql
2021-03-31 20:29:23.431339 (MainThread): Parsing macros/etc/datetime.sql
2021-03-31 20:29:23.442736 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-03-31 20:29:23.445317 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-03-31 20:29:23.447576 (MainThread): Parsing macros/adapters/common.sql
2021-03-31 20:29:23.501012 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-03-31 20:29:23.503790 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-03-31 20:29:23.505940 (MainThread): Parsing macros/schema_tests/unique.sql
2021-03-31 20:29:23.508434 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-03-31 20:29:23.518744 (MainThread): Partial parsing not enabled
2021-03-31 20:29:23.588028 (MainThread): Acquiring new postgres connection "model.jaffle_shop.customers".
2021-03-31 20:29:23.614549 (MainThread): Acquiring new postgres connection "model.jaffle_shop.orders".
2021-03-31 20:29:23.630239 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_customers".
2021-03-31 20:29:23.644408 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_payments".
2021-03-31 20:29:23.658959 (MainThread): Acquiring new postgres connection "model.jaffle_shop.stg_orders".
2021-03-31 20:29:24.230507 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52a48579-bf42-42e6-b006-a96243ffb6a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a572e50>]}
2021-03-31 20:29:24.364181 (MainThread): Found 5 models, 20 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 3 seed files, 0 sources, 0 exposures
2021-03-31 20:29:24.364800 (MainThread): The selector 'source:*' does not match any nodes and will be ignored
2021-03-31 20:29:24.367616 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2021-03-31 20:29:24.368404 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a764e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a764990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a764f10>]}
2021-03-31 20:29:24.368775 (MainThread): Flushing usage events
2021-03-31 20:29:24.511877 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
